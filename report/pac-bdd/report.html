<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">report.html</title>
      <style type="text/css">body {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 12px;
  /* do not increase min-width as some may use split screens */
  min-width: 800px;
  color: #999;
}

h1 {
  font-size: 24px;
  color: black;
}

h2 {
  font-size: 16px;
  color: black;
}

p {
  color: black;
}

a {
  color: #999;
}

table {
  border-collapse: collapse;
}

/******************************
 * SUMMARY INFORMATION
 ******************************/
#environment td {
  padding: 5px;
  border: 1px solid #e6e6e6;
  vertical-align: top;
}
#environment tr:nth-child(odd) {
  background-color: #f6f6f6;
}
#environment ul {
  margin: 0;
  padding: 0 20px;
}

/******************************
 * TEST RESULT COLORS
 ******************************/
span.passed,
.passed .col-result {
  color: green;
}

span.skipped,
span.xfailed,
span.rerun,
.skipped .col-result,
.xfailed .col-result,
.rerun .col-result {
  color: orange;
}

span.error,
span.failed,
span.xpassed,
.error .col-result,
.failed .col-result,
.xpassed .col-result {
  color: red;
}

.col-links__extra {
  margin-right: 3px;
}

/******************************
 * RESULTS TABLE
 *
 * 1. Table Layout
 * 2. Extra
 * 3. Sorting items
 *
 ******************************/
/*------------------
 * 1. Table Layout
 *------------------*/
#results-table {
  border: 1px solid #e6e6e6;
  color: #999;
  font-size: 12px;
  width: 100%;
}
#results-table th,
#results-table td {
  padding: 5px;
  border: 1px solid #e6e6e6;
  text-align: left;
}
#results-table th {
  font-weight: bold;
}

/*------------------
 * 2. Extra
 *------------------*/
.logwrapper {
  max-height: 230px;
  overflow-y: scroll;
  background-color: #e6e6e6;
}
.logwrapper.expanded {
  max-height: none;
}
.logwrapper.expanded .logexpander:after {
  content: "collapse [-]";
}
.logwrapper .logexpander {
  z-index: 1;
  position: sticky;
  top: 10px;
  width: max-content;
  border: 1px solid;
  border-radius: 3px;
  padding: 5px 7px;
  margin: 10px 0 10px calc(100% - 80px);
  cursor: pointer;
  background-color: #e6e6e6;
}
.logwrapper .logexpander:after {
  content: "expand [+]";
}
.logwrapper .logexpander:hover {
  color: #000;
  border-color: #000;
}
.logwrapper .log {
  min-height: 40px;
  position: relative;
  top: -50px;
  height: calc(100% + 50px);
  border: 1px solid #e6e6e6;
  color: black;
  display: block;
  font-family: "Courier New", Courier, monospace;
  padding: 5px;
  padding-right: 80px;
  white-space: pre-wrap;
}

div.media {
  border: 1px solid #e6e6e6;
  float: right;
  height: 240px;
  margin: 0 5px;
  overflow: hidden;
  width: 320px;
}

.media-container {
  display: grid;
  grid-template-columns: 25px auto 25px;
  align-items: center;
  flex: 1 1;
  overflow: hidden;
  height: 200px;
}

.media-container--fullscreen {
  grid-template-columns: 0px auto 0px;
}

.media-container__nav--right,
.media-container__nav--left {
  text-align: center;
  cursor: pointer;
}

.media-container__viewport {
  cursor: pointer;
  text-align: center;
  height: inherit;
}
.media-container__viewport img,
.media-container__viewport video {
  object-fit: cover;
  width: 100%;
  max-height: 100%;
}

.media__name,
.media__counter {
  display: flex;
  flex-direction: row;
  justify-content: space-around;
  flex: 0 0 25px;
  align-items: center;
}

.collapsible td:not(.col-links) {
  cursor: pointer;
}
.collapsible td:not(.col-links):hover::after {
  color: #bbb;
  font-style: italic;
  cursor: pointer;
}

.col-result {
  width: 130px;
}
.col-result:hover::after {
  content: " (hide details)";
}

.col-result.collapsed:hover::after {
  content: " (show details)";
}

#environment-header h2:hover::after {
  content: " (hide details)";
  color: #bbb;
  font-style: italic;
  cursor: pointer;
  font-size: 12px;
}

#environment-header.collapsed h2:hover::after {
  content: " (show details)";
  color: #bbb;
  font-style: italic;
  cursor: pointer;
  font-size: 12px;
}

/*------------------
 * 3. Sorting items
 *------------------*/
.sortable {
  cursor: pointer;
}
.sortable.desc:after {
  content: " ";
  position: relative;
  left: 5px;
  bottom: -12.5px;
  border: 10px solid #4caf50;
  border-bottom: 0;
  border-left-color: transparent;
  border-right-color: transparent;
}
.sortable.asc:after {
  content: " ";
  position: relative;
  left: 5px;
  bottom: 12.5px;
  border: 10px solid #4caf50;
  border-top: 0;
  border-left-color: transparent;
  border-right-color: transparent;
}

.hidden, .summary__reload__button.hidden {
  display: none;
}

.summary__data {
  flex: 0 0 550px;
}
.summary__reload {
  flex: 1 1;
  display: flex;
  justify-content: center;
}
.summary__reload__button {
  flex: 0 0 300px;
  display: flex;
  color: white;
  font-weight: bold;
  background-color: #4caf50;
  text-align: center;
  justify-content: center;
  align-items: center;
  border-radius: 3px;
  cursor: pointer;
}
.summary__reload__button:hover {
  background-color: #46a049;
}
.summary__spacer {
  flex: 0 0 550px;
}

.controls {
  display: flex;
  justify-content: space-between;
}

.filters,
.collapse {
  display: flex;
  align-items: center;
}
.filters button,
.collapse button {
  color: #999;
  border: none;
  background: none;
  cursor: pointer;
  text-decoration: underline;
}
.filters button:hover,
.collapse button:hover {
  color: #ccc;
}

.filter__label {
  margin-right: 10px;
}

      </style>
    
  </head>
  <body>
    <h1 id="title">report.html</h1>
    <p>Report generated on 15-Jan-2026 at 12:35:21 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">48 tests took 00:00:25.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" />
            <span class="failed">37 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">11 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" disabled/>
            <span class="skipped">0 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled/>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled/>
            <span class="rerun">0 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.13.2&#34;, &#34;Platform&#34;: &#34;Linux-6.8.0-90-generic-x86_64-with-glibc2.39&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;8.4.2&#34;, &#34;pluggy&#34;: &#34;1.6.0&#34;}, &#34;Plugins&#34;: {&#34;html&#34;: &#34;4.1.1&#34;, &#34;bdd&#34;: &#34;8.1.0&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;, &#34;asyncio&#34;: &#34;1.3.0&#34;, &#34;md-report&#34;: &#34;0.7.0&#34;, &#34;anyio&#34;: &#34;4.12.0&#34;}}, &#34;tests&#34;: {&#34;test_fixture.py::test_dummy_fixture&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_fixture.py::test_dummy_fixture&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_fixture.py::test_dummy_fixture&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;test_fixture.py::test_dummy_async_fixture&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_fixture.py::test_dummy_async_fixture&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_fixture.py::test_dummy_async_fixture&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\n&#34;}], &#34;test_openapi.py::test_swagger_flow_service&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_openapi.py::test_swagger_flow_service&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_openapi.py::test_swagger_flow_service&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;def test_swagger_flow_service():\n        url = &amp;#x27;???&amp;#x27;\n&amp;gt;       _test_swagger(\n            url,\n            &amp;quot;docs/norme/XP_Z12-013_SWAGGER_Annexes_A_et_B_V1.2/ANNEXE A - PR XP Z12-013 - AFNOR-Flow_Service-1.1.0-swagger.json&amp;quot;,\n        )\n\ntest_openapi.py:24: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nurl = &amp;#x27;???&amp;#x27;, swagger = &amp;#x27;docs/norme/XP_Z12-013_SWAGGER_Annexes_A_et_B_V1.2/ANNEXE A - PR XP Z12-013 - AFNOR-Flow_Service-1.1.0-swagger.json&amp;#x27;\n\n    def _test_swagger(url: str, swagger: str):\n        &amp;quot;&amp;quot;&amp;quot;\n            V\u00e9rifier si une API respecte une definition Swagger/OpenAPI\n    \n        Cette API doit respecter le versioning indiqu\u00e9 dans l\u2019URL de la route API du Swagger. Dans un objectif de\n        simplification le versioning des routes n\u2019est pas affich\u00e9 dans le pr\u00e9sent document;\n        Dans cette API publi\u00e9e par le Fournisseur API ce dernier peut :\n        \u2022Avoir une URL sp\u00e9cifique en amont du versioning\n        \u2022Ajouter des propri\u00e9t\u00e9s aux objets dans les requ\u00eates.\n        \u2022Ajouter des param\u00e8tres aux routes dans les requ\u00eates.\n        \u2022Ajouter des propri\u00e9t\u00e9s aux objets dans les r\u00e9ponses.\n        \u2022Ajouter des codes erreurs dans les r\u00e9ponses.\n        &amp;quot;&amp;quot;&amp;quot;\n&amp;gt;       raise NotImplementedError(&amp;quot;swagger compliance non test\u00e9&amp;quot;)\nE       NotImplementedError: swagger compliance non test\u00e9\n\ntest_openapi.py:18: NotImplementedError\n&#34;}], &#34;test_openapi.py::test_swagger_directory_service&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_openapi.py::test_swagger_directory_service&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_openapi.py::test_swagger_directory_service&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;def test_swagger_directory_service():\n        url = &amp;quot;???&amp;quot;\n&amp;gt;       _test_swagger(\n            url,\n            &amp;quot;docs/norme/XP_Z12-013_SWAGGER_Annexes_A_et_B_V1.2/ANNEXE B - PR XP Z12-013 - AFNOR-Directory_Service-1.1.0-swagger.json&amp;quot;,\n        )\n\ntest_openapi.py:32: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nurl = &amp;#x27;???&amp;#x27;, swagger = &amp;#x27;docs/norme/XP_Z12-013_SWAGGER_Annexes_A_et_B_V1.2/ANNEXE B - PR XP Z12-013 - AFNOR-Directory_Service-1.1.0-swagger.json&amp;#x27;\n\n    def _test_swagger(url: str, swagger: str):\n        &amp;quot;&amp;quot;&amp;quot;\n            V\u00e9rifier si une API respecte une definition Swagger/OpenAPI\n    \n        Cette API doit respecter le versioning indiqu\u00e9 dans l\u2019URL de la route API du Swagger. Dans un objectif de\n        simplification le versioning des routes n\u2019est pas affich\u00e9 dans le pr\u00e9sent document;\n        Dans cette API publi\u00e9e par le Fournisseur API ce dernier peut :\n        \u2022Avoir une URL sp\u00e9cifique en amont du versioning\n        \u2022Ajouter des propri\u00e9t\u00e9s aux objets dans les requ\u00eates.\n        \u2022Ajouter des param\u00e8tres aux routes dans les requ\u00eates.\n        \u2022Ajouter des propri\u00e9t\u00e9s aux objets dans les r\u00e9ponses.\n        \u2022Ajouter des codes erreurs dans les r\u00e9ponses.\n        &amp;quot;&amp;quot;&amp;quot;\n&amp;gt;       raise NotImplementedError(&amp;quot;swagger compliance non test\u00e9&amp;quot;)\nE       NotImplementedError: swagger compliance non test\u00e9\n\ntest_openapi.py:18: NotImplementedError\n&#34;}], &#34;test_pac0.py::test_pac0_import_services&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_pac0.py::test_pac0_import_services&#34;, &#34;duration&#34;: &#34;224 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_pac0.py::test_pac0_import_services&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;224 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;+ Exception Group Traceback (most recent call last):\n  |   File &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac-bdd/test_pac0.py&amp;quot;, line 21, in test_pac0_import_services\n  |     async with asyncio.TaskGroup() as tg:\n  |                ~~~~~~~~~~~~~~~~~^^\n  |   File &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/taskgroups.py&amp;quot;, line 71, in __aexit__\n  |     return await self._aexit(et, exc)\n  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  |   File &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/taskgroups.py&amp;quot;, line 173, in _aexit\n  |     raise BaseExceptionGroup(\n  |     ...&amp;lt;2 lines&amp;gt;...\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac-bdd/test_pac0.py&amp;quot;, line 22, in test_pac0_import_services\n    |     task1 = tg.create_task(api_gateway_main.app.run())\n    |                            ^^^^^^^^^^^^^^^^^^^^^^^^\n    | AttributeError: &amp;#x27;FastAPI&amp;#x27; object has no attribute &amp;#x27;run&amp;#x27;\n    +------------------------------------\n\n------------------------------ Captured log setup ------------------------------\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\n\n----------------------------- Captured stdout call -----------------------------\nConnecting to NATS nats://localhost:4222 ...\nConnecting to NATS nats://localhost:4222 ...\nConnecting to NATS nats://localhost:4222 ...\n&#34;}], &#34;test_scenario.py::test_simpliste_avec_commentaire&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_simpliste_avec_commentaire&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_simpliste_avec_commentaire&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais quelque chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais quelque chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais autre chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais autre chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais autre chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais autre chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais autre chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais autre chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_then_j&amp;#x27;ai fait 4 choses&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_then_j&amp;#x27;ai fait {nb} choses&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_simpliste&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_simpliste&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_simpliste&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function _ at 0x7587b989c2c0&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_simpliste&amp;gt;&amp;gt;, kwargs = {&amp;#x27;nb&amp;#x27;: &amp;#x27;4&amp;#x27;}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nnb = &amp;#x27;4&amp;#x27;\n\n    @then(parsers.parse(&amp;quot;&amp;quot;&amp;quot;j&amp;#x27;ai fait {nb} choses&amp;quot;&amp;quot;&amp;quot;))\n    def _(nb):\n        # si le nombre donn\u00e9e `nb` ne corresponds pas au contexte, on \u00e9choue\n&amp;gt;       assert ctx[&amp;#x27;nb&amp;#x27;] == int(nb)\n               ^^^^^^^^^^^^^^^^^^^^\nE       AssertionError\n\nsrc/pac_bdd/demo.py:31: AssertionError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais quelque chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais quelque chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais autre chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais autre chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais autre chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais autre chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais autre chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais autre chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je fais autre chose&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je fais autre chose&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_then_j&amp;#x27;ai fait 4 choses&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_then_j&amp;#x27;ai fait {nb} choses&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_trackingid_fourni&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_trackingid_fourni&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_trackingid_fourni&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: When &amp;quot;je joins le fichier /data/FA-3647.pdf&amp;quot;. Line 13 in scenario &amp;quot;trackingId fourni&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/01-api-gateway/trackingId.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8925/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:8585 ...\n2026-01-15 12:34:56,142 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:34:56,142 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8585 ...\n2026-01-15 12:34:56,153 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:34:56,153 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8585 ...\n2026-01-15 12:34:56,162 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:34:56,162 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8585 ...\n2026-01-15 12:34:56,170 INFO     - q | routage-IN  |            - `Process` waiting for messages\n2026-01-15 12:34:56,170 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8585 ...\n2026-01-15 12:34:56,178 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:34:56,179 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:34:56,179 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:56,180 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:56,180 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:56,181 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:56,181 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:34:56,181 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:56,182 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:56,182 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:34:56,182 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:34:56,183 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:56,183 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:56,183 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:34:56,183 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8585 ...\n2026-01-15 12:34:56,190 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\n2026-01-15 12:34:56,191 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8585 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8925\n    server   Documentation at http://0.0.0.0:8925/docs\n \n             Logs:\n \n2026-01-15 12:34:56,325 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:34:56,327 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:34:56,327 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:34:56,328 INFO     - *                | f939b198-7 - Received\n2026-01-15 12:34:56,331 INFO     - *                | f939b198-7 - Processed\n_check_http_health http://localhost:8925/healthcheck\n      INFO   127.0.0.1:46464 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n      INFO   127.0.0.1:46476 - &amp;quot;POST /flows HTTP/1.1&amp;quot; 200\n\n----------------------------- Captured stderr call -----------------------------\n[19680] 2026/01/15 12:34:55.745862 [INF] Starting nats-server\n[19680] 2026/01/15 12:34:55.745929 [INF]   Version:  2.12.3\n[19680] 2026/01/15 12:34:55.745932 [INF]   Git:      [450a519]\n[19680] 2026/01/15 12:34:55.745935 [INF]   Name:     ND2WZL6DQ5A2UUYWZBLJSOKU6ORTGYIMC222YLRFCJHELLSDVXV3J4XU\n[19680] 2026/01/15 12:34:55.745945 [INF]   ID:       ND2WZL6DQ5A2UUYWZBLJSOKU6ORTGYIMC222YLRFCJHELLSDVXV3J4XU\n[19680] 2026/01/15 12:34:55.746851 [INF] Listening for client connections on 0.0.0.0:8585\n[19680] 2026/01/15 12:34:55.747144 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\n2026-01-15 12:34:56,138 INFO     - FastStream app starting...\n2026-01-15 12:34:56,142 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:56,150 INFO     - FastStream app starting...\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:34:56,153 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:56,158 INFO     - FastStream app starting...\n2026-01-15 12:34:56,162 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:56,167 INFO     - FastStream app starting...\n2026-01-15 12:34:56,170 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:56,175 INFO     - FastStream app starting...\n2026-01-15 12:34:56,183 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:56,188 INFO     - FastStream app starting...\n2026-01-15 12:34:56,191 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [19695]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8925 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API POST /flows&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 9223 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:9223\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 8585 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:8585\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 8925 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 9024 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:9024\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 9059 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:9059\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 8628 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:8628\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 9082 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:9082\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 9244 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:9244\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 8489 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:8489\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 9105 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:9105\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8925 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8925 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8c8e270&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:34:56 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8925/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:8925\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8925 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8c8fb60&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:34:56 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;17&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8925/flows &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [19695]\n2026-01-15 12:34:57,142 INFO     - FastStream app shutting down...\n2026-01-15 12:34:57,143 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:34:57,252 INFO     - FastStream app shutting down...\n2026-01-15 12:34:57,253 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:34:57,461 INFO     - FastStream app shutting down...\n2026-01-15 12:34:57,462 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:34:57,670 INFO     - FastStream app shutting down...\n2026-01-15 12:34:57,671 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:34:57,790 INFO     - FastStream app shutting down...\n2026-01-15 12:34:57,791 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:34:57,980 INFO     - FastStream app shutting down...\n2026-01-15 12:34:57,982 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_trackingid_absent&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_trackingid_absent&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_trackingid_absent&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: When &amp;quot;je joins le fichier /data/FA-3647.pdf&amp;quot;. Line 23 in scenario &amp;quot;trackingId absent&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/01-api-gateway/trackingId.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8870/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:8645 ...\n2026-01-15 12:34:58,693 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:34:58,693 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8645 ...\n2026-01-15 12:34:58,719 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:34:58,719 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8645 ...\n2026-01-15 12:34:58,721 INFO     - q | routage-IN  |            - `Process` waiting for messages\n2026-01-15 12:34:58,722 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8645 ...\n2026-01-15 12:34:58,737 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\n2026-01-15 12:34:58,737 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8645 ...\n2026-01-15 12:34:58,741 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:34:58,741 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8645 ...\n2026-01-15 12:34:58,746 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:34:58,746 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:34:58,747 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:58,747 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:58,748 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:58,748 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:58,748 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:34:58,749 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:58,749 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:58,750 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:34:58,750 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:34:58,750 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:58,751 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:34:58,751 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:34:58,752 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8645 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8870\n    server   Documentation at http://0.0.0.0:8870/docs\n \n             Logs:\n \n2026-01-15 12:34:58,931 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:34:58,933 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:34:58,934 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:34:58,935 INFO     - *                | 2efea85b-b - Received\n2026-01-15 12:34:58,938 INFO     - *                | 2efea85b-b - Processed\n_check_http_health http://localhost:8870/healthcheck\n      INFO   127.0.0.1:56280 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n      INFO   127.0.0.1:56290 - &amp;quot;POST /flows HTTP/1.1&amp;quot; 200\n\n----------------------------- Captured stderr call -----------------------------\n[19770] 2026/01/15 12:34:58.137392 [INF] Starting nats-server\n[19770] 2026/01/15 12:34:58.137517 [INF]   Version:  2.12.3\n[19770] 2026/01/15 12:34:58.137524 [INF]   Git:      [450a519]\n[19770] 2026/01/15 12:34:58.137530 [INF]   Name:     NAGLL6DC25NJT2PYYKLHH3FNR7YJKHTP2IXL6BPV6MUH75Z5F5G5USQ5\n[19770] 2026/01/15 12:34:58.137535 [INF]   ID:       NAGLL6DC25NJT2PYYKLHH3FNR7YJKHTP2IXL6BPV6MUH75Z5F5G5USQ5\n[19770] 2026/01/15 12:34:58.138586 [INF] Listening for client connections on 0.0.0.0:8645\n[19770] 2026/01/15 12:34:58.139155 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:34:58,689 INFO     - FastStream app starting...\n2026-01-15 12:34:58,694 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:58,715 INFO     - FastStream app starting...\n2026-01-15 12:34:58,718 INFO     - FastStream app starting...\n2026-01-15 12:34:58,719 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:58,722 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:58,733 INFO     - FastStream app starting...\n2026-01-15 12:34:58,737 INFO     - FastStream app starting...\n2026-01-15 12:34:58,737 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:58,741 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:34:58,742 INFO     - FastStream app starting...\n2026-01-15 12:34:58,752 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [19789]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8870 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API POST /flows&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 8392 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:8392\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 8645 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:8645\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 8870 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 8341 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:8341\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 9048 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:9048\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 9042 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:9042\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 8346 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:8346\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 8380 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:8380\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 8561 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:8561\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 9276 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:9276\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8870 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8870 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8ccec10&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:34:58 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8870/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:8870\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8870 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8cfc190&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:34:58 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;17&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8870/flows &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [19789]\n2026-01-15 12:34:59,490 INFO     - FastStream app shutting down...\n2026-01-15 12:34:59,491 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:34:59,639 INFO     - FastStream app shutting down...\n2026-01-15 12:34:59,640 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:34:59,819 INFO     - FastStream app shutting down...\n2026-01-15 12:34:59,820 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:00,021 INFO     - FastStream app shutting down...\n2026-01-15 12:35:00,021 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:00,238 INFO     - FastStream app shutting down...\n2026-01-15 12:35:00,239 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:00,447 INFO     - FastStream app shutting down...\n2026-01-15 12:35:00,449 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_trackingid_doublon&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_trackingid_doublon&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_trackingid_doublon&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: When &amp;quot;je joins le fichier /data/FA-3647.pdf&amp;quot;. Line 32 in scenario &amp;quot;trackingId doublon&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/01-api-gateway/trackingId.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8512/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:8752 ...\n2026-01-15 12:35:01,044 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:01,044 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8752 ...\n2026-01-15 12:35:01,059 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:01,060 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8752 ...\n2026-01-15 12:35:01,064 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:35:01,065 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8752 ...\n2026-01-15 12:35:01,070 INFO     - q | routage-IN  |            - `Process` waiting for messages\n2026-01-15 12:35:01,071 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8752 ...\n2026-01-15 12:35:01,075 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\n2026-01-15 12:35:01,075 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8752 ...\n2026-01-15 12:35:01,105 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:35:01,105 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:35:01,106 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:01,106 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:01,106 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:01,107 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:01,107 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:35:01,107 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:01,108 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:01,108 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:35:01,108 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:35:01,109 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:01,109 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:01,109 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:35:01,110 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8752 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8512\n    server   Documentation at http://0.0.0.0:8512/docs\n \n             Logs:\n \n2026-01-15 12:35:01,246 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:01,248 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:35:01,248 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:35:01,249 INFO     - *                | 84328c44-7 - Received\n2026-01-15 12:35:01,252 INFO     - *                | 84328c44-7 - Processed\n_check_http_health http://localhost:8512/healthcheck\n      INFO   127.0.0.1:33610 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n      INFO   127.0.0.1:33624 - &amp;quot;POST /flows HTTP/1.1&amp;quot; 200\n\n----------------------------- Captured stderr call -----------------------------\n[19857] 2026/01/15 12:35:00.589123 [INF] Starting nats-server\n[19857] 2026/01/15 12:35:00.589247 [INF]   Version:  2.12.3\n[19857] 2026/01/15 12:35:00.589254 [INF]   Git:      [450a519]\n[19857] 2026/01/15 12:35:00.589260 [INF]   Name:     NBDASWGBAMANWR4WH3ZYXS5O6A3LVXQCWDAJ766RPTNLBETYEJRWL2AC\n[19857] 2026/01/15 12:35:00.589265 [INF]   ID:       NBDASWGBAMANWR4WH3ZYXS5O6A3LVXQCWDAJ766RPTNLBETYEJRWL2AC\n[19857] 2026/01/15 12:35:00.590210 [INF] Listening for client connections on 0.0.0.0:8752\n[19857] 2026/01/15 12:35:00.590698 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:35:01,040 INFO     - FastStream app starting...\n2026-01-15 12:35:01,045 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:01,056 INFO     - FastStream app starting...\n2026-01-15 12:35:01,060 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:01,061 INFO     - FastStream app starting...\n2026-01-15 12:35:01,065 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:01,067 INFO     - FastStream app starting...\n2026-01-15 12:35:01,071 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:01,072 INFO     - FastStream app starting...\n2026-01-15 12:35:01,075 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:01,102 INFO     - FastStream app starting...\n2026-01-15 12:35:01,110 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [19884]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8512 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API POST /flows&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 8981 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:8981\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 8752 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:8752\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 8512 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 8599 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:8599\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 8960 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:8960\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 8525 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:8525\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 8653 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:8653\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 9045 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:9045\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 8699 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:8699\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 8466 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:8466\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8512 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8512 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8cced50&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:01 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8512/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:8512\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8512 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8cce710&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:01 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;17&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8512/flows &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [19884]\n2026-01-15 12:35:02,042 INFO     - FastStream app shutting down...\n2026-01-15 12:35:02,043 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:02,165 INFO     - FastStream app shutting down...\n2026-01-15 12:35:02,166 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:02,362 INFO     - FastStream app shutting down...\n2026-01-15 12:35:02,363 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:02,470 INFO     - FastStream app shutting down...\n2026-01-15 12:35:02,471 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:02,677 INFO     - FastStream app shutting down...\n2026-01-15 12:35:02,678 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:02,807 INFO     - FastStream app shutting down...\n2026-01-15 12:35:02,808 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_api_gateway&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_api_gateway&#34;, &#34;duration&#34;: &#34;00:00:01&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marragearr\u00eat_service_api_gateway&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:01&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8900/healthcheck\ncccccc All connection attempts failed\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8882 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8900\n    server   Documentation at http://0.0.0.0:8900/docs\n \n             Logs:\n \n2026-01-15 12:35:03,709 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:03,711 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:35:03,711 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:35:03,712 INFO     - *                | 026d5e3b-d - Received\n2026-01-15 12:35:03,716 INFO     - *                | 026d5e3b-d - Processed\n_check_http_health http://localhost:8900/healthcheck\n      INFO   127.0.0.1:46218 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n\n----------------------------- Captured stderr call -----------------------------\n[19942] 2026/01/15 12:35:02.920274 [INF] Starting nats-server\n[19942] 2026/01/15 12:35:02.920341 [INF]   Version:  2.12.3\n[19942] 2026/01/15 12:35:02.920346 [INF]   Git:      [450a519]\n[19942] 2026/01/15 12:35:02.920350 [INF]   Name:     NCEPNHFUXB7LQT2FUAFN5V744H65LF732YB5NCJQXTER67SKTOHW2QJI\n[19942] 2026/01/15 12:35:02.920354 [INF]   ID:       NCEPNHFUXB7LQT2FUAFN5V744H65LF732YB5NCJQXTER67SKTOHW2QJI\n[19942] 2026/01/15 12:35:02.920991 [INF] Listening for client connections on 0.0.0.0:8882\n[19942] 2026/01/15 12:35:02.921408 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n      INFO   Started server process [19956]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8900 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je lance le service &amp;quot;02-esb-central&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je lance le service &amp;quot;02-esb-central&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service None on port 8882 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready None ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  None started on localhost:8882\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;01-api-gateway&amp;quot; n\\&amp;#x27;est pas pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;01-api-gateway&amp;quot; n\\&amp;#x27;est pas pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je lance le service &amp;quot;01-api-gateway&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je lance le service &amp;quot;01-api-gateway&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 8900 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8900 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8900 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8cc9a70&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:03 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8900/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:8900\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;01-api-gateway&amp;quot; est pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;01-api-gateway&amp;quot; est pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [19956]\n[19942] 2026/01/15 12:35:04.159719 [INF] Trapped &amp;quot;terminated&amp;quot; signal\n[19942] 2026/01/15 12:35:04.159922 [INF] Initiating Shutdown...\n[19942] 2026/01/15 12:35:04.160024 [INF] Server Exiting..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...&#34;}], &#34;test_scenario.py::test_contr\u00f4le_sha256&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_contr\u00f4le_sha256&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_contr\u00f4le_sha256&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: When &amp;quot;je joins le fichier /data/FA-3647.pdf&amp;quot;. Line 9 in scenario &amp;quot;Contr\u00f4le sha256&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/01-api-gateway/sha256.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8726/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:8410 ...\n2026-01-15 12:35:04,804 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:04,805 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8410 ...\n2026-01-15 12:35:04,832 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:04,833 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8410 ...\n2026-01-15 12:35:04,845 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:35:04,846 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8410 ...\n2026-01-15 12:35:04,852 INFO     - q | routage-IN  |            - `Process` waiting for messages\nConnecting to NATS nats://localhost:8410 ...\n2026-01-15 12:35:04,852 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\n2026-01-15 12:35:04,853 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:04,853 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8410 ...\n2026-01-15 12:35:04,872 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:35:04,873 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:35:04,873 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:04,874 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:04,874 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:04,874 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:04,875 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:35:04,875 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:04,875 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:04,876 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:35:04,876 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:35:04,877 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:04,877 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:04,877 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:35:04,878 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8410 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8726\n    server   Documentation at http://0.0.0.0:8726/docs\n \n             Logs:\n \n2026-01-15 12:35:05,049 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:05,051 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:35:05,051 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:35:05,052 INFO     - *                | 1e2b2c86-f - Received\n2026-01-15 12:35:05,055 INFO     - *                | 1e2b2c86-f - Processed\n_check_http_health http://localhost:8726/healthcheck\n      INFO   127.0.0.1:54204 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n      INFO   127.0.0.1:54210 - &amp;quot;POST /flows HTTP/1.1&amp;quot; 200\n\n----------------------------- Captured stderr call -----------------------------\n[19966] 2026/01/15 12:35:04.174929 [INF] Starting nats-server\n[19966] 2026/01/15 12:35:04.175025 [INF]   Version:  2.12.3\n[19966] 2026/01/15 12:35:04.175032 [INF]   Git:      [450a519]\n[19966] 2026/01/15 12:35:04.175037 [INF]   Name:     ND2DDPVGUJLL4IJFZ3T3BQ3ECPQKD6A6LGUQMONKMWFFTD4YLNCWS4X3\n[19966] 2026/01/15 12:35:04.175057 [INF]   ID:       ND2DDPVGUJLL4IJFZ3T3BQ3ECPQKD6A6LGUQMONKMWFFTD4YLNCWS4X3\n[19966] 2026/01/15 12:35:04.175927 [INF] Listening for client connections on 0.0.0.0:8410\n[19966] 2026/01/15 12:35:04.176366 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:35:04,799 INFO     - FastStream app starting...\n2026-01-15 12:35:04,805 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:04,828 INFO     - FastStream app starting...\n2026-01-15 12:35:04,833 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:04,841 INFO     - FastStream app starting...\n2026-01-15 12:35:04,846 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:04,849 INFO     - FastStream app starting...\n2026-01-15 12:35:04,849 INFO     - FastStream app starting...\n2026-01-15 12:35:04,853 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:04,853 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:04,868 INFO     - FastStream app starting...\n2026-01-15 12:35:04,878 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [19987]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8726 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API POST /flows&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 8730 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:8730\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 8410 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:8410\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 8726 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 8999 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:8999\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 9179 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:9179\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 8511 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:8511\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 8738 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:8738\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 8938 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:8938\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 8421 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:8421\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 8983 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:8983\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8726 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8726 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8cc82b0&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:05 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8726/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:8726\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8726 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8e54d60&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:05 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;17&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8726/flows &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [19987]\n2026-01-15 12:35:05,529 INFO     - FastStream app shutting down...\n2026-01-15 12:35:05,530 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:05,744 INFO     - FastStream app shutting down...\n2026-01-15 12:35:05,746 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:05,902 INFO     - FastStream app shutting down...\n2026-01-15 12:35:05,903 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:06,052 INFO     - FastStream app shutting down...\n2026-01-15 12:35:06,053 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:06,253 INFO     - FastStream app shutting down...\n2026-01-15 12:35:06,254 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:06,472 INFO     - FastStream app shutting down...\n2026-01-15 12:35:06,474 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_healthcheck&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_healthcheck&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_healthcheck&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:9035/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:8927 ...\n2026-01-15 12:35:07,210 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:07,211 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8927 ...\n2026-01-15 12:35:07,222 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:35:07,223 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8927 ...\n2026-01-15 12:35:07,224 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:07,225 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8927 ...\n2026-01-15 12:35:07,250 INFO     - q | routage-IN  |            - `Process` waiting for messages\n2026-01-15 12:35:07,251 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8927 ...\n2026-01-15 12:35:07,266 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\n2026-01-15 12:35:07,266 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8927 ...\n2026-01-15 12:35:07,286 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:35:07,286 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:35:07,287 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:07,287 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:07,288 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:07,288 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:07,288 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:35:07,289 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:07,289 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:07,289 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:35:07,290 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:35:07,290 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:07,291 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:07,291 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:35:07,291 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8927 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:9035\n    server   Documentation at http://0.0.0.0:9035/docs\n \n             Logs:\n \n2026-01-15 12:35:07,511 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:07,513 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:35:07,513 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:35:07,515 INFO     - *                | 3b1882f4-4 - Received\n2026-01-15 12:35:07,518 INFO     - *                | 3b1882f4-4 - Processed\n_check_http_health http://localhost:9035/healthcheck\n      INFO   127.0.0.1:54682 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n      INFO   127.0.0.1:54684 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n\n----------------------------- Captured stderr call -----------------------------\n[20063] 2026/01/15 12:35:06.614675 [INF] Starting nats-server\n[20063] 2026/01/15 12:35:06.614779 [INF]   Version:  2.12.3\n[20063] 2026/01/15 12:35:06.614784 [INF]   Git:      [450a519]\n[20063] 2026/01/15 12:35:06.614788 [INF]   Name:     NAORCVX2FJDGXHBDQ7DVIIFVYI3XCLHXYX62K3DPPOOWYBWRLNZZN225\n[20063] 2026/01/15 12:35:06.614798 [INF]   ID:       NAORCVX2FJDGXHBDQ7DVIIFVYI3XCLHXYX62K3DPPOOWYBWRLNZZN225\n[20063] 2026/01/15 12:35:06.615415 [INF] Listening for client connections on 0.0.0.0:8927\n[20063] 2026/01/15 12:35:06.615833 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:35:07,205 INFO     - FastStream app starting...\n2026-01-15 12:35:07,211 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:07,217 INFO     - FastStream app starting...\n2026-01-15 12:35:07,219 INFO     - FastStream app starting...\n2026-01-15 12:35:07,223 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:07,225 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:07,245 INFO     - FastStream app starting...\n2026-01-15 12:35:07,251 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:07,262 INFO     - FastStream app starting...\n2026-01-15 12:35:07,266 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:07,282 INFO     - FastStream app starting...\n2026-01-15 12:35:07,291 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [20086]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:9035 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_une pa communautaire&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_une pa communautaire&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 8549 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:8549\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 8927 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:8927\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 9035 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 8737 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:8737\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 8859 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:8859\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 9265 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:9265\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 8952 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:8952\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 8407 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:8407\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 8632 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:8632\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 8453 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:8453\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=9035 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=9035 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8ce2d50&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:07 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:9035/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:9035\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API GET /healthcheck&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=9035 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8e568b0&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:07 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: GET http://localhost:9035/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_then_j&amp;#x27;obtiens le code de retour 200&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_then_j&amp;#x27;obtiens le code de retour {code}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [20086]\n2026-01-15 12:35:07,908 INFO     - FastStream app shutting down...\n2026-01-15 12:35:07,909 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:08,118 INFO     - FastStream app shutting down...\n2026-01-15 12:35:08,119 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:08,322 INFO     - FastStream app shutting down...\n2026-01-15 12:35:08,323 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:08,548 INFO     - FastStream app shutting down...\n2026-01-15 12:35:08,550 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:08,768 INFO     - FastStream app shutting down...\n2026-01-15 12:35:08,769 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:08,987 INFO     - FastStream app shutting down...\n2026-01-15 12:35:08,989 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_healthcheck_deep&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_healthcheck_deep&#34;, &#34;duration&#34;: &#34;00:00:04&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_healthcheck_deep&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:04&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8365/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:8930 ...\n2026-01-15 12:35:09,694 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:09,694 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8930 ...\n2026-01-15 12:35:09,708 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:35:09,708 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8930 ...\n2026-01-15 12:35:09,711 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:09,712 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8930 ...\n2026-01-15 12:35:09,737 INFO     - q | routage-IN  |            - `Process` waiting for messages\nConnecting to NATS nats://localhost:8930 ...\n2026-01-15 12:35:09,738 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\n2026-01-15 12:35:09,738 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:09,739 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8930 ...\n2026-01-15 12:35:09,746 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:35:09,746 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:35:09,747 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:09,747 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:09,748 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:09,748 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:09,749 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:35:09,749 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:09,750 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:09,750 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:35:09,751 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:35:09,751 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:09,751 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:09,752 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:35:09,752 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8930 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8365\n    server   Documentation at http://0.0.0.0:8365/docs\n \n             Logs:\n \n2026-01-15 12:35:09,933 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:09,935 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:35:09,936 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:35:09,937 INFO     - *                | 91b48a0a-4 - Received\n2026-01-15 12:35:09,941 INFO     - *                | 91b48a0a-4 - Processed\n_check_http_health http://localhost:8365/healthcheck\n      INFO   127.0.0.1:47478 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n2026-01-15 12:35:10,257 INFO     - healthcheck      | b08634b0-b - Received\n2026-01-15 12:35:10,257 INFO     -   | healthcheck          | b08634b0-b - Received\n2026-01-15 12:35:10,257 INFO     -   | healthcheck              | b08634b0-b - Received\n2026-01-15 12:35:10,257 INFO     -   | healthcheck           | b08634b0-b - Received\n2026-01-15 12:35:10,257 INFO     -   | healthcheck | b08634b0-b - Received\n2026-01-15 12:35:10,257 INFO     -   | healthcheck         | b08634b0-b - Received\n2026-01-15 12:35:10,257 INFO     -   | healthcheck             | b08634b0-b - Received\n2026-01-15 12:35:10,257 INFO     - healthcheck      | b08634b0-b - Processed\n2026-01-15 12:35:10,257 INFO     -   | healthcheck          | b08634b0-b - Processed\n2026-01-15 12:35:10,257 INFO     -   | healthcheck              | b08634b0-b - Processed\n2026-01-15 12:35:10,257 INFO     -   | healthcheck           | b08634b0-b - Processed\n2026-01-15 12:35:10,257 INFO     -   | healthcheck | b08634b0-b - Processed\n2026-01-15 12:35:10,257 INFO     - *                | b08634b0-b - Received\n2026-01-15 12:35:10,257 INFO     -   | healthcheck         | b08634b0-b - Processed\n2026-01-15 12:35:10,257 INFO     -   | healthcheck             | b08634b0-b - Processed\n2026-01-15 12:35:10,258 INFO     - healthcheck_resp | 56ebb78b-4 - Received\n2026-01-15 12:35:10,258 INFO     - healthcheck_resp | 56ebb78b-4 - Processed\n2026-01-15 12:35:10,258 INFO     - healthcheck_resp | 1a9e6731-6 - Received\n2026-01-15 12:35:10,258 INFO     - healthcheck_resp | 1a9e6731-6 - Processed\n2026-01-15 12:35:10,259 INFO     - *                | b08634b0-b - Processed\n2026-01-15 12:35:10,259 INFO     - *                | 56ebb78b-4 - Received\n2026-01-15 12:35:10,259 INFO     - healthcheck_resp | 79eea046-5 - Received\n2026-01-15 12:35:10,259 INFO     - healthcheck_resp | 79eea046-5 - Processed\n2026-01-15 12:35:10,259 INFO     - healthcheck_resp | 345258d1-8 - Received\n2026-01-15 12:35:10,259 INFO     - healthcheck_resp | 345258d1-8 - Processed\n2026-01-15 12:35:10,259 INFO     - healthcheck_resp | dcc59ec1-7 - Received\n2026-01-15 12:35:10,259 INFO     - healthcheck_resp | dcc59ec1-7 - Processed\n2026-01-15 12:35:10,260 INFO     - healthcheck_resp | 3209ad01-e - Received\n2026-01-15 12:35:10,260 INFO     - healthcheck_resp | 3209ad01-e - Processed\n2026-01-15 12:35:10,260 INFO     - healthcheck_resp | c54da5a4-a - Received\n2026-01-15 12:35:10,260 INFO     - healthcheck_resp | c54da5a4-a - Processed\n2026-01-15 12:35:10,260 INFO     - *                | 56ebb78b-4 - Processed\n2026-01-15 12:35:10,260 INFO     - *                | 1a9e6731-6 - Received\n2026-01-15 12:35:10,261 INFO     - *                | 1a9e6731-6 - Processed\n2026-01-15 12:35:10,261 INFO     - *                | 79eea046-5 - Received\n2026-01-15 12:35:10,261 INFO     - *                | 79eea046-5 - Processed\n2026-01-15 12:35:10,261 INFO     - *                | 345258d1-8 - Received\n2026-01-15 12:35:10,261 INFO     - *                | 345258d1-8 - Processed\n2026-01-15 12:35:10,262 INFO     - *                | dcc59ec1-7 - Received\n2026-01-15 12:35:10,262 INFO     - *                | dcc59ec1-7 - Processed\n2026-01-15 12:35:10,262 INFO     - *                | 3209ad01-e - Received\n2026-01-15 12:35:10,262 INFO     - *                | 3209ad01-e - Processed\n2026-01-15 12:35:10,262 INFO     - *                | c54da5a4-a - Received\n2026-01-15 12:35:10,262 INFO     - *                | c54da5a4-a - Processed\n      INFO   127.0.0.1:47480 - &amp;quot;GET /healthcheck/deep HTTP/1.1&amp;quot; 200\n\n----------------------------- Captured stderr call -----------------------------\n[20172] 2026/01/15 12:35:09.113235 [INF] Starting nats-server\n[20172] 2026/01/15 12:35:09.113338 [INF]   Version:  2.12.3\n[20172] 2026/01/15 12:35:09.113343 [INF]   Git:      [450a519]\n[20172] 2026/01/15 12:35:09.113347 [INF]   Name:     NA6NCFLPYQSOHT35OKZGBEBF5T5CGAMFKHFHHCXCQJYLT5Q6TLOWGZO3\n[20172] 2026/01/15 12:35:09.113357 [INF]   ID:       NA6NCFLPYQSOHT35OKZGBEBF5T5CGAMFKHFHHCXCQJYLT5Q6TLOWGZO3\n[20172] 2026/01/15 12:35:09.114008 [INF] Listening for client connections on 0.0.0.0:8930\n[20172] 2026/01/15 12:35:09.114458 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\n2026-01-15 12:35:09,690 INFO     - FastStream app starting...\n2026-01-15 12:35:09,694 INFO     - FastStream app started successfully! To exit, press CTRL+C\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:35:09,703 INFO     - FastStream app starting...\n2026-01-15 12:35:09,708 INFO     - FastStream app starting...\n2026-01-15 12:35:09,708 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:09,712 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:09,733 INFO     - FastStream app starting...\n2026-01-15 12:35:09,734 INFO     - FastStream app starting...\n2026-01-15 12:35:09,738 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:09,739 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:09,742 INFO     - FastStream app starting...\n2026-01-15 12:35:09,752 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [20187]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8365 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_une pa communautaire&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_une pa communautaire&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 8833 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:8833\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 8930 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:8930\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 8365 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 8749 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:8749\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 8328 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:8328\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 9231 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:9231\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 8740 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:8740\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 9204 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:9204\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 9039 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:9039\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 8729 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:8729\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8365 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8365 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8c0fce0&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:09 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8365/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:8365\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API GET /healthcheck/deep&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8365 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8ce2450&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:09 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;84&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: GET http://localhost:8365/healthcheck/deep &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_then_j&amp;#x27;obtiens le code de retour 200&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_then_j&amp;#x27;obtiens le code de retour {code}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_la r\u00e9ponse a une cl\u00e9 &amp;quot;healthcheck_resp&amp;quot; avec 7 \u00e9l\u00e9ments&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_la r\u00e9ponse a une cl\u00e9 &amp;quot;{key}&amp;quot; avec {nb} \u00e9l\u00e9ments&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [20187]\n2026-01-15 12:35:12,498 INFO     - FastStream app shutting down...\n2026-01-15 12:35:12,499 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:12,608 INFO     - FastStream app shutting down...\n2026-01-15 12:35:12,609 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:12,715 INFO     - FastStream app shutting down...\n2026-01-15 12:35:12,716 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:12,839 INFO     - FastStream app shutting down...\n2026-01-15 12:35:12,839 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:12,942 INFO     - FastStream app shutting down...\n2026-01-15 12:35:12,943 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:13,149 INFO     - FastStream app shutting down...\n2026-01-15 12:35:13,150 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_controle_formats&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_controle_formats&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marragearr\u00eat_service_controle_formats&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: When &amp;quot;le service &amp;quot;03-controle-formats&amp;quot; n&amp;#x27;est pas pr\u00eat&amp;quot;. Line 6 in scenario &amp;quot;d\u00e9marrage/arr\u00eat service controle formats&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/03-controle-formats/service.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_controle_format_facturx&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_controle_format_facturx&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_controle_format_facturx&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function control_invoice at 0x7587b970c7c0&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_controle_format_facturx&amp;gt;&amp;gt;, kwargs = {}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\n    @when(\n        parsers.parse(&amp;quot;je d\u00e9pose pour contr\u00f4le la facture @{invoice}&amp;quot;),\n    )\n    def control_invoice():\n&amp;gt;       raise NotImplementedError()\nE       NotImplementedError\n\nsrc/pac_bdd/tobeimplemented.py:30: NotImplementedError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je d\u00e9pose pour contr\u00f4le la facture @FA213746_20251211_124749.pdf&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je d\u00e9pose pour contr\u00f4le la facture @{invoice}&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_dun_serveur_nats&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_dun_serveur_nats&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_dun_serveur_nats&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un serveur NATS disponible&amp;quot;. Line 19 in scenario &amp;quot;D\u00e9marrage d&amp;#x27;un serveur NATS&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/service_lifecycle.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_connexion_dun_broker_au_serveur_nats&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_connexion_dun_broker_au_serveur_nats&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_connexion_dun_broker_au_serveur_nats&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un serveur NATS disponible&amp;quot;. Line 23 in scenario &amp;quot;Connexion d&amp;#x27;un broker au serveur NATS&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/service_lifecycle.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_de_plusieurs_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_de_plusieurs_pa&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_de_plusieurs_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;2 PA d\u00e9marr\u00e9es&amp;quot;. Line 32 in scenario &amp;quot;D\u00e9marrage de plusieurs PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/service_lifecycle.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_dun_service_nats_local&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_dun_service_nats_local&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_dun_service_nats_local&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service NATS local&amp;quot;. Line 21 in scenario &amp;quot;D\u00e9marrage d&amp;#x27;un service NATS local&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_connexion_\u00e0_un_service_nats_distant&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_connexion_\u00e0_un_service_nats_distant&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_connexion_\u00e0_un_service_nats_distant&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service NATS local comme r\u00e9f\u00e9rence&amp;quot;. Line 27 in scenario &amp;quot;Connexion \u00e0 un service NATS distant&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_dun_service_peppol_mock&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_dun_service_peppol_mock&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_dun_service_peppol_mock&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service Peppol en mode mock&amp;quot;. Line 33 in scenario &amp;quot;D\u00e9marrage d&amp;#x27;un service Peppol mock&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_configuration_des_r\u00e9ponses_peppol_mock&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_configuration_des_r\u00e9ponses_peppol_mock&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_configuration_des_r\u00e9ponses_peppol_mock&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service Peppol en mode mock&amp;quot;. Line 38 in scenario &amp;quot;Configuration des r\u00e9ponses Peppol mock&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_recherche_peppol_dune_entreprise_non_enregistr\u00e9e&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_recherche_peppol_dune_entreprise_non_enregistr\u00e9e&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_recherche_peppol_dune_entreprise_non_enregistr\u00e9e&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service Peppol en mode mock&amp;quot;. Line 45 in scenario &amp;quot;Recherche Peppol d&amp;#x27;une entreprise non enregistr\u00e9e&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_dun_service_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_dun_service_pa&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_dun_service_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service PA&amp;quot;. Line 51 in scenario &amp;quot;D\u00e9marrage d&amp;#x27;un service PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_1_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_1_pa&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_1_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 1 PA&amp;quot;. Line 61 in scenario &amp;quot;Cr\u00e9ation d&amp;#x27;un monde avec 1 PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_2_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_2_pa&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_2_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 68 in scenario &amp;quot;Cr\u00e9ation d&amp;#x27;un monde avec 2 PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_4_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_4_pa&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_4_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 4 PA&amp;quot;. Line 74 in scenario &amp;quot;Cr\u00e9ation d&amp;#x27;un monde avec 4 PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_les_pa_partagent_le_m\u00eame_service_nats&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_les_pa_partagent_le_m\u00eame_service_nats&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_les_pa_partagent_le_m\u00eame_service_nats&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 82 in scenario &amp;quot;Les PA partagent le m\u00eame service NATS&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_les_pa_ont_des_ports_api_distincts&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_les_pa_ont_des_ports_api_distincts&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_les_pa_ont_des_ports_api_distincts&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 3 PA&amp;quot;. Line 87 in scenario &amp;quot;Les PA ont des ports API distincts&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_toutes_les_pa_r\u00e9pondent_au_healthcheck&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_toutes_les_pa_r\u00e9pondent_au_healthcheck&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_toutes_les_pa_r\u00e9pondent_au_healthcheck&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 95 in scenario &amp;quot;Toutes les PA r\u00e9pondent au healthcheck&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_information_du_monde&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_information_du_monde&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_information_du_monde&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 104 in scenario &amp;quot;Information du monde&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_arr\u00eat_propre_du_monde&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_arr\u00eat_propre_du_monde&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_arr\u00eat_propre_du_monde&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA d\u00e9marr\u00e9&amp;quot;. Line 115 in scenario &amp;quot;Arr\u00eat propre du monde&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_monde_avec_nats_externe&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_monde_avec_nats_externe&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_monde_avec_nats_externe&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service NATS local comme r\u00e9f\u00e9rence&amp;quot;. Line 126 in scenario &amp;quot;Monde avec NATS externe&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_monde_avec_peppol_personnalis\u00e9&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_monde_avec_peppol_personnalis\u00e9&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_monde_avec_peppol_personnalis\u00e9&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service Peppol en mode mock comme r\u00e9f\u00e9rence&amp;quot;. Line 132 in scenario &amp;quot;Monde avec Peppol personnalis\u00e9&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9p\u00f4t_de_facture_entre_2_pa_via_peppol&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9p\u00f4t_de_facture_entre_2_pa_via_peppol&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9p\u00f4t_de_facture_entre_2_pa_via_peppol&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 141 in scenario &amp;quot;D\u00e9p\u00f4t de facture entre 2 PA via Peppol&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_esb_central&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_esb_central&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marragearr\u00eat_service_esb_central&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_le service &amp;quot;02-esb-central&amp;quot; n\\&amp;#x27;est pas pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_le service &amp;quot;02-esb-central&amp;quot; n\\&amp;#x27;est pas pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je lance le service &amp;quot;02-esb-central&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je lance le service &amp;quot;02-esb-central&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service None on port 8504 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready None ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  None started on localhost:8504\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...&#34;}], &#34;test_scenario.py::test_healthcheck_message&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_healthcheck_message&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_healthcheck_message&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function _ at 0x7587b989cae0&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_healthcheck_message&amp;gt;&amp;gt;\nkwargs = {&amp;#x27;canal&amp;#x27;: &amp;#x27;healthcheck_resp&amp;#x27;, &amp;#x27;msg&amp;#x27;: &amp;#x27;toto&amp;#x27;, &amp;#x27;world1&amp;#x27;: WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceCon...tream.FastStreamServiceContext object at 0x7587b8cb9390&amp;gt;, client_async=&amp;lt;httpx.AsyncClient object at 0x7587b8c72150&amp;gt;)])}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nworld1 = WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceContext object at 0x7587b8efb680&amp;gt;, pas=[PacServiceContext(...stream.FastStreamServiceContext object at 0x7587b8cb9390&amp;gt;, client_async=&amp;lt;httpx.AsyncClient object at 0x7587b8c72150&amp;gt;)])\nmsg = &amp;#x27;toto&amp;#x27;, canal = &amp;#x27;healthcheck_resp&amp;#x27;\n\n    @then(parsers.parse(&amp;quot;&amp;quot;&amp;quot;j&amp;#x27;obtiens le message &amp;#x27;{msg}&amp;#x27; sur le canal &amp;#x27;{canal}&amp;#x27;&amp;quot;&amp;quot;&amp;quot;))\n    def _(\n        world1: WorldContext,\n        msg: str,\n        canal: str,\n    ):\n        traces = []\n        with world1.pa1.api_gateway.get_client() as client:\n            response = client.get(&amp;quot;/trace&amp;quot;)\n            assert response.status_code == 200\n            traces = response.json()\n    \n        for trace in traces:\n            print(trace)\n            if trace[&amp;quot;subject&amp;quot;] == canal and trace[&amp;quot;body&amp;quot;] == msg:\n                return\n        else:\n&amp;gt;           raise Exception(&amp;quot;message not found !&amp;quot;)\nE           Exception: message not found !\n\nsrc/pac_bdd/esb.py:78: Exception\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8993/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:9255 ...\n2026-01-15 12:35:13,915 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:13,916 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:9255 ...\n2026-01-15 12:35:13,922 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:35:13,923 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:9255 ...\n2026-01-15 12:35:13,934 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:13,935 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:9255 ...\n2026-01-15 12:35:13,956 INFO     - q | routage-IN  |            - `Process` waiting for messages\n2026-01-15 12:35:13,957 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:9255 ...\n2026-01-15 12:35:13,963 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\n2026-01-15 12:35:13,963 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:9255 ...\n2026-01-15 12:35:13,967 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:35:13,967 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:35:13,968 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:13,968 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:13,969 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:13,969 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:13,969 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:35:13,970 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:13,970 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:13,970 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:35:13,971 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:35:13,971 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:13,971 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:13,972 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:35:13,972 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:9255 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8993\n    server   Documentation at http://0.0.0.0:8993/docs\n \n             Logs:\n \n2026-01-15 12:35:14,157 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:14,159 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:35:14,159 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:35:14,160 INFO     - *                | cc8d571b-3 - Received\n2026-01-15 12:35:14,163 INFO     - *                | cc8d571b-3 - Processed\n_check_http_health http://localhost:8993/healthcheck\n      INFO   127.0.0.1:52998 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n      INFO   127.0.0.1:53002 - &amp;quot;POST /publish HTTP/1.1&amp;quot; 200\n2026-01-15 12:35:14,477 INFO     - *                | 41b6288a-c - Received\n2026-01-15 12:35:14,478 INFO     - *                | 41b6288a-c - Processed\n      INFO   127.0.0.1:53014 - &amp;quot;GET /trace HTTP/1.1&amp;quot; 200\n{&amp;#x27;body&amp;#x27;: &amp;#x27;Startup!!!&amp;#x27;, &amp;#x27;content_type&amp;#x27;: &amp;#x27;text/plain&amp;#x27;, &amp;#x27;message_id&amp;#x27;: &amp;#x27;cc8d571b-3205-4213-8d81-a7ed1736df00&amp;#x27;, &amp;#x27;correlation_id&amp;#x27;: &amp;#x27;cc8d571b-3205-4213-8d81-a7ed1736df00&amp;#x27;, &amp;#x27;path&amp;#x27;: {}, &amp;#x27;committed&amp;#x27;: None, &amp;#x27;subject&amp;#x27;: &amp;#x27;test&amp;#x27;, &amp;#x27;reply&amp;#x27;: &amp;#x27;&amp;#x27;}\n{&amp;#x27;body&amp;#x27;: &amp;#x27;publishing ...&amp;#x27;, &amp;#x27;content_type&amp;#x27;: &amp;#x27;text/plain&amp;#x27;, &amp;#x27;message_id&amp;#x27;: &amp;#x27;41b6288a-c685-4940-bf41-c75f8dbe4308&amp;#x27;, &amp;#x27;correlation_id&amp;#x27;: &amp;#x27;41b6288a-c685-4940-bf41-c75f8dbe4308&amp;#x27;, &amp;#x27;path&amp;#x27;: {}, &amp;#x27;committed&amp;#x27;: None, &amp;#x27;subject&amp;#x27;: &amp;#x27;xxx&amp;#x27;, &amp;#x27;reply&amp;#x27;: &amp;#x27;&amp;#x27;}\n\n----------------------------- Captured stderr call -----------------------------\n[20262] 2026/01/15 12:35:13.360897 [INF] Starting nats-server\n[20262] 2026/01/15 12:35:13.360994 [INF]   Version:  2.12.3\n[20262] 2026/01/15 12:35:13.361000 [INF]   Git:      [450a519]\n[20262] 2026/01/15 12:35:13.361005 [INF]   Name:     NAE4FJXSLQQCMRNBVBNDVL43OUKWKPD544HLQ4UJN7BM7JPGW2TMLAUB\n[20262] 2026/01/15 12:35:13.361017 [INF]   ID:       NAE4FJXSLQQCMRNBVBNDVL43OUKWKPD544HLQ4UJN7BM7JPGW2TMLAUB\n[20262] 2026/01/15 12:35:13.362004 [INF] Listening for client connections on 0.0.0.0:9255\n[20262] 2026/01/15 12:35:13.362513 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\n2026-01-15 12:35:13,911 INFO     - FastStream app starting...\n2026-01-15 12:35:13,916 INFO     - FastStream app started successfully! To exit, press CTRL+C\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:35:13,918 INFO     - FastStream app starting...\n2026-01-15 12:35:13,923 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:13,930 INFO     - FastStream app starting...\n2026-01-15 12:35:13,935 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:13,953 INFO     - FastStream app starting...\n2026-01-15 12:35:13,957 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:13,959 INFO     - FastStream app starting...\n2026-01-15 12:35:13,963 INFO     - FastStream app starting...\n2026-01-15 12:35:13,963 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:13,972 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [20287]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8993 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_je publie le message &amp;#x27;hello&amp;#x27; sur le canal &amp;#x27;healthcheck&amp;#x27;&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_je publie le message &amp;#x27;{msg}&amp;#x27; sur le canal &amp;#x27;{canal}&amp;#x27;&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 8731 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:8731\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 9255 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:9255\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 8993 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 8484 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:8484\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 8323 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:8323\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 8418 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:8418\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 8374 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:8374\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 9194 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:9194\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 8860 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:8860\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 8674 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:8674\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8993 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8993 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8c0ead0&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:14 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8993/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:8993\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8993 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8f82580&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:14 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;4&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8993/publish &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_then_j&amp;#x27;obtiens le message &amp;#x27;toto&amp;#x27; sur le canal &amp;#x27;healthcheck_resp&amp;#x27;&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_then_j&amp;#x27;obtiens le message &amp;#x27;{msg}&amp;#x27; sur le canal &amp;#x27;{canal}&amp;#x27;&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8993 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8cc2ad0&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:14 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;430&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: GET http://localhost:8993/trace &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [20287]\n2026-01-15 12:35:14,714 INFO     - FastStream app shutting down...\n2026-01-15 12:35:14,715 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:14,920 INFO     - FastStream app shutting down...\n2026-01-15 12:35:14,922 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:15,133 INFO     - FastStream app shutting down...\n2026-01-15 12:35:15,134 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:15,254 INFO     - FastStream app shutting down...\n2026-01-15 12:35:15,255 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:15,462 INFO     - FastStream app shutting down...\n2026-01-15 12:35:15,463 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:15,667 INFO     - FastStream app shutting down...\n2026-01-15 12:35:15,669 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_canal_pingpong&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_canal_pingpong&#34;, &#34;duration&#34;: &#34;00:00:03&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_canal_pingpong&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:03&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function _ at 0x7587b989c540&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_canal_pingpong&amp;gt;&amp;gt;\nkwargs = {&amp;#x27;canal&amp;#x27;: &amp;#x27;pong&amp;#x27;, &amp;#x27;world1&amp;#x27;: WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceContext object at 0x7587b8f822...tream.FastStreamServiceContext object at 0x7587b8cbb700&amp;gt;, client_async=&amp;lt;httpx.AsyncClient object at 0x7587b8c72390&amp;gt;)])}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nworld1 = WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceContext object at 0x7587b8f82250&amp;gt;, pas=[PacServiceContext(...stream.FastStreamServiceContext object at 0x7587b8cbb700&amp;gt;, client_async=&amp;lt;httpx.AsyncClient object at 0x7587b8c72390&amp;gt;)])\ncanal = &amp;#x27;pong&amp;#x27;\n\n    @when(\n        parsers.parse(&amp;quot;j&amp;#x27;\u00e9coute le canal &amp;#x27;{canal}&amp;#x27;&amp;quot;),\n    )\n    def _(\n        world1: WorldContext,\n        canal: str,\n    ):\n        global handle_GLOBAL\n    \n        print(f&amp;quot;esb_sub {canal=}...&amp;quot;)\n        #raise NotImplementedError()\n&amp;gt;       broker = world1.pa.broker\n                 ^^^^^^^^^^^^^^^^\nE       AttributeError: &amp;#x27;PacServiceContext&amp;#x27; object has no attribute &amp;#x27;broker&amp;#x27;\n\nsrc/pac_bdd/esb.py:25: AttributeError\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8904/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:8467 ...\n2026-01-15 12:35:16,370 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:35:16,371 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8467 ...\n2026-01-15 12:35:16,373 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:16,373 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8467 ...\n2026-01-15 12:35:16,378 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:16,379 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8467 ...\n2026-01-15 12:35:16,397 INFO     - q | routage-IN  |            - `Process` waiting for messages\n2026-01-15 12:35:16,398 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8467 ...\n2026-01-15 12:35:16,409 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\n2026-01-15 12:35:16,409 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8467 ...\n2026-01-15 12:35:16,416 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:35:16,416 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:35:16,417 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:16,417 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:16,418 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:16,418 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:16,419 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:35:16,419 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:16,419 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:16,420 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:35:16,420 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:35:16,421 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:16,421 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:16,422 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:35:16,422 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8467 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8904\n    server   Documentation at http://0.0.0.0:8904/docs\n \n             Logs:\n \n2026-01-15 12:35:16,609 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:16,610 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:35:16,611 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:35:16,612 INFO     - *                | 9917a456-e - Received\n2026-01-15 12:35:16,615 INFO     - *                | 9917a456-e - Processed\n_check_http_health http://localhost:8904/healthcheck\n      INFO   127.0.0.1:49306 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\nesb_sub canal=&amp;#x27;pong&amp;#x27;...\n\n----------------------------- Captured stderr call -----------------------------\n[20346] 2026/01/15 12:35:15.805107 [INF] Starting nats-server\n[20346] 2026/01/15 12:35:15.805205 [INF]   Version:  2.12.3\n[20346] 2026/01/15 12:35:15.805211 [INF]   Git:      [450a519]\n[20346] 2026/01/15 12:35:15.805215 [INF]   Name:     NAUT7ZDADIRDBPEHSIYSIASRU2ODM3LSLMYHWZ55WFPC4TKDR3PGDYEF\n[20346] 2026/01/15 12:35:15.805226 [INF]   ID:       NAUT7ZDADIRDBPEHSIYSIASRU2ODM3LSLMYHWZ55WFPC4TKDR3PGDYEF\n[20346] 2026/01/15 12:35:15.805875 [INF] Listening for client connections on 0.0.0.0:8467\n[20346] 2026/01/15 12:35:15.806285 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:35:16,366 INFO     - FastStream app starting...\n2026-01-15 12:35:16,368 INFO     - FastStream app starting...\n2026-01-15 12:35:16,371 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:16,374 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:16,374 INFO     - FastStream app starting...\n2026-01-15 12:35:16,379 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:16,394 INFO     - FastStream app starting...\n2026-01-15 12:35:16,398 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:16,405 INFO     - FastStream app starting...\n2026-01-15 12:35:16,409 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:16,412 INFO     - FastStream app starting...\n2026-01-15 12:35:16,422 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [20371]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8904 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;\u00e9coute le canal &amp;#x27;pong&amp;#x27;&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;\u00e9coute le canal &amp;#x27;{canal}&amp;#x27;&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 9187 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:9187\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 8467 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:8467\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 8904 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 9215 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:9215\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 8413 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:8413\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 8677 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:8677\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 8968 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:8968\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 9258 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:9258\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 8509 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:8509\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 8559 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:8559\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8904 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8904 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8f6e450&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:16 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8904/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:8904\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [20371]\n2026-01-15 12:35:17,169 INFO     - FastStream app shutting down...\n2026-01-15 12:35:17,170 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:17,368 INFO     - FastStream app shutting down...\n2026-01-15 12:35:17,369 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:17,577 INFO     - FastStream app shutting down...\n2026-01-15 12:35:17,578 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:17,797 INFO     - FastStream app shutting down...\n2026-01-15 12:35:17,798 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:18,009 INFO     - FastStream app shutting down...\n2026-01-15 12:35:18,010 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:18,215 INFO     - FastStream app shutting down...\n2026-01-15 12:35:18,216 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_pa&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;la PA #pa1&amp;quot;. Line 7 in scenario &amp;quot;2 PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/07-routage/pa_multiple.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_peppol_req&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_peppol_req&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_peppol_req&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n[[&amp;#x27;id&amp;#x27;, &amp;#x27;smp&amp;#x27;], [&amp;#x27;e1&amp;#x27;, &amp;#x27;https://smp.pa-distante.fr&amp;#x27;], [&amp;#x27;e2&amp;#x27;, &amp;#x27;https://smp.autre-pa.fr&amp;#x27;]]\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL simul\u00e9 avec:&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL simul\u00e9 avec:&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 9253 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:9253\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_md5&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_md5&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_md5&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function _ at 0x7587b98ee160&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_md5&amp;gt;&amp;gt;\nkwargs = {&amp;#x27;peppol_context&amp;#x27;: PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=&amp;#x27;b881aaeff8eeaed7190491ccdeaa42fc&amp;#x27;), &amp;#x27;result&amp;#x27;: &amp;#x27;6c2675d749449f2c8af1216fd866bb54&amp;#x27;}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=&amp;#x27;b881aaeff8eeaed7190491ccdeaa42fc&amp;#x27;), result = &amp;#x27;6c2675d749449f2c8af1216fd866bb54&amp;#x27;\n\n    @then(parsers.parse(&amp;#x27;&amp;#x27;&amp;#x27;j&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27;&amp;#x27;&amp;#x27;))\n    def _(\n        peppol_context: PeppolContext,\n        result: str,\n    ):\n        &amp;quot;&amp;quot;&amp;quot;\u00e9tape g\u00e9n\u00e9rique pour tester tout r\u00e9sultat&amp;quot;&amp;quot;&amp;quot;\n        if peppol_context.result != result:\n            print(f&amp;quot;result: {peppol_context.result}&amp;quot;)\n            print(f&amp;quot;expecting: {result}&amp;quot;)\n&amp;gt;       assert peppol_context.result == result\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE       AssertionError\n\nsrc/pac_bdd/peppol.py:129: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nresult: b881aaeff8eeaed7190491ccdeaa42fc\nexpecting: 6c2675d749449f2c8af1216fd866bb54\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;empreinte md5 de &amp;quot;bonjour!&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte md5 de &amp;quot;{msg}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;, &amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;6c2675d749449f2c8af1216fd866bb54&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_identification_france&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_identification_france&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_identification_france&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nxxxx 0002 0002\nxxxx 0009 0009\nxxxx 9957 9957\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_l\\&amp;#x27;identification par SIRET porte le code &amp;quot;0002&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_l\\&amp;#x27;identification par {facon} porte le code &amp;quot;{code}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_l\\&amp;#x27;identification par SIREN porte le code &amp;quot;0009&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_l\\&amp;#x27;identification par {facon} porte le code &amp;quot;{code}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_l\\&amp;#x27;identification par TVA_FR porte le code &amp;quot;9957&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_l\\&amp;#x27;identification par {facon} porte le code &amp;quot;{code}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_empreinte_participant&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_empreinte_participant&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_empreinte_participant&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;empreinte SIREN &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;3ddb2999105b666703fc700e14885016&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;empreinte SIRET &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;6dbdf4f29451b37456ca48b550bdbaee&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;empreinte TVA_FR &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;d0d6bafc0317e3e8baa9504a9a022f9c&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_h\u00f4te_sml&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_h\u00f4te_sml&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_h\u00f4te_sml&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_la racine SML &amp;quot;ma.racine.local&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_la racine SML &amp;quot;{zone}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour SIREN &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-3ddb2999105b666703fc700e14885016.iso6523-actorid-upis.ma.racine.local&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour SIRET &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-6dbdf4f29451b37456ca48b550bdbaee.iso6523-actorid-upis.ma.racine.local&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour TVA_FR &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-d0d6bafc0317e3e8baa9504a9a022f9c.iso6523-actorid-upis.ma.racine.local&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_la racine SML &amp;quot;acc.edelivery.tech.ec.europa.eu&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_la racine SML &amp;quot;{zone}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour SIREN &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-3ddb2999105b666703fc700e14885016.iso6523-actorid-upis.acc.edelivery.tech.ec.europa.eu&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour SIRET &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-6dbdf4f29451b37456ca48b550bdbaee.iso6523-actorid-upis.acc.edelivery.tech.ec.europa.eu&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour TVA_FR &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-d0d6bafc0317e3e8baa9504a9a022f9c.iso6523-actorid-upis.acc.edelivery.tech.ec.europa.eu&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_rejet_dolibarr&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_rejet_dolibarr&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_rejet_dolibarr&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function compliance_rule_set at 0x7587b970cd60&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_rejet_dolibarr&amp;gt;&amp;gt;, kwargs = {}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\n    @when(&amp;quot;je d\u00e9finis un contr\u00f4le de conformit\u00e9 m\u00e9tier fournisseur&amp;quot;)\n    def compliance_rule_set():\n&amp;gt;       raise NotImplementedError()\nE       NotImplementedError\n\nsrc/pac_bdd/tobeimplemented.py:45: NotImplementedError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je d\u00e9finis un contr\u00f4le de conformit\u00e9 m\u00e9tier fournisseur&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je d\u00e9finis un contr\u00f4le de conformit\u00e9 m\u00e9tier fournisseur&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_cycle_basique&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_cycle_basique&#34;, &#34;duration&#34;: &#34;00:00:03&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_cycle_basique&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:03&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function _ at 0x7587b989cae0&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_cycle_basique&amp;gt;&amp;gt;\nkwargs = {&amp;#x27;canal&amp;#x27;: &amp;#x27;controle-formats-IN&amp;#x27;, &amp;#x27;msg&amp;#x27;: &amp;#x27;hello&amp;#x27;, &amp;#x27;world1&amp;#x27;: WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServic...tream.FastStreamServiceContext object at 0x7587b8e3a2e0&amp;gt;, client_async=&amp;lt;httpx.AsyncClient object at 0x7587b8c71cd0&amp;gt;)])}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nworld1 = WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceContext object at 0x7587b8ca6750&amp;gt;, pas=[PacServiceContext(...stream.FastStreamServiceContext object at 0x7587b8e3a2e0&amp;gt;, client_async=&amp;lt;httpx.AsyncClient object at 0x7587b8c71cd0&amp;gt;)])\nmsg = &amp;#x27;hello&amp;#x27;, canal = &amp;#x27;controle-formats-IN&amp;#x27;\n\n    @then(parsers.parse(&amp;quot;&amp;quot;&amp;quot;j&amp;#x27;obtiens le message &amp;#x27;{msg}&amp;#x27; sur le canal &amp;#x27;{canal}&amp;#x27;&amp;quot;&amp;quot;&amp;quot;))\n    def _(\n        world1: WorldContext,\n        msg: str,\n        canal: str,\n    ):\n        traces = []\n        with world1.pa1.api_gateway.get_client() as client:\n            response = client.get(&amp;quot;/trace&amp;quot;)\n            assert response.status_code == 200\n            traces = response.json()\n    \n        for trace in traces:\n            print(trace)\n            if trace[&amp;quot;subject&amp;quot;] == canal and trace[&amp;quot;body&amp;quot;] == msg:\n                return\n        else:\n&amp;gt;           raise Exception(&amp;quot;message not found !&amp;quot;)\nE           Exception: message not found !\n\nsrc/pac_bdd/esb.py:78: Exception\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:9172/healthcheck\ncccccc All connection attempts failed\nConnecting to NATS nats://localhost:8541 ...\n2026-01-15 12:35:19,001 INFO     - q | controle-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:19,001 INFO     -   | healthcheck         |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8541 ...\n2026-01-15 12:35:19,005 INFO     - q | validation-metier-IN |            - `Process` waiting for messages\n2026-01-15 12:35:19,005 INFO     -   | healthcheck          |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8541 ...\n2026-01-15 12:35:19,019 INFO     - q | conversion-formats-IN |            - `Process` waiting for messages\n2026-01-15 12:35:19,020 INFO     -   | healthcheck           |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8541 ...\n2026-01-15 12:35:19,030 INFO     - q | routage-IN  |            - `Process` waiting for messages\n2026-01-15 12:35:19,031 INFO     -   | healthcheck |            - `HealthcheckSub` waiting for messages\nConnecting to NATS nats://localhost:8541 ...\n2026-01-15 12:35:19,045 INFO     - q | transmission-fiscale-IN |            - `Process` waiting for messages\nConnecting to NATS nats://localhost:8541 ...\n2026-01-15 12:35:19,045 INFO     - q | routage-OUT              |            - `Process07To08` waiting for messages\n2026-01-15 12:35:19,046 INFO     -   | healthcheck             |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:19,046 INFO     - q | api-gateway-OUT          |            - `Process01To03` waiting for messages\n2026-01-15 12:35:19,046 INFO     - q | routage-ERR              |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:19,047 INFO     - q | annuaire-local-ERR       |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:19,047 INFO     - q | validation-metier-ERR    |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:19,048 INFO     - q | esb-central-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:19,048 INFO     - q | annuaire-local-OUT       |            - `Process06To07` waiting for messages\n2026-01-15 12:35:19,048 INFO     - q | transmission-fiscale-ERR |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:19,049 INFO     - q | conversion-formats-ERR   |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:19,049 INFO     - q | conversion-formats-OUT   |            - `Process05To06` waiting for messages\n2026-01-15 12:35:19,049 INFO     - q | validation-metier-OUT    |            - `Process04To05` waiting for messages\n2026-01-15 12:35:19,050 INFO     - q | api-gateway-ERR          |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:19,050 INFO     - q | controle-formats-ERR     |            - `ProcessErr` waiting for messages\n2026-01-15 12:35:19,051 INFO     - q | controle-formats-OUT     |            - `Process03To04` waiting for messages\n2026-01-15 12:35:19,051 INFO     -   | healthcheck              |            - `HealthcheckSub` waiting for messages\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8541 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:9172\n    server   Documentation at http://0.0.0.0:9172/docs\n \n             Logs:\n \n2026-01-15 12:35:19,223 INFO     - healthcheck      |            - `HealthcheckSub` waiting for messages\n2026-01-15 12:35:19,225 INFO     - *                |            - `AllSub` waiting for messages\n2026-01-15 12:35:19,225 INFO     - healthcheck_resp |            - `HealthcheckRespSub` waiting for messages\n2026-01-15 12:35:19,226 INFO     - *                | d24315d6-9 - Received\n2026-01-15 12:35:19,229 INFO     - *                | d24315d6-9 - Processed\n_check_http_health http://localhost:9172/healthcheck\n      INFO   127.0.0.1:41696 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n      INFO   127.0.0.1:52650 - &amp;quot;POST /publish HTTP/1.1&amp;quot; 200\n2026-01-15 12:35:19,616 INFO     - *                | ec023ef4-a - Received\n2026-01-15 12:35:19,617 INFO     - *                | ec023ef4-a - Processed\n      INFO   127.0.0.1:52664 - &amp;quot;GET /trace HTTP/1.1&amp;quot; 200\n{&amp;#x27;body&amp;#x27;: &amp;#x27;Startup!!!&amp;#x27;, &amp;#x27;content_type&amp;#x27;: &amp;#x27;text/plain&amp;#x27;, &amp;#x27;message_id&amp;#x27;: &amp;#x27;d24315d6-9175-468d-a1e2-23be2c53e360&amp;#x27;, &amp;#x27;correlation_id&amp;#x27;: &amp;#x27;d24315d6-9175-468d-a1e2-23be2c53e360&amp;#x27;, &amp;#x27;path&amp;#x27;: {}, &amp;#x27;committed&amp;#x27;: None, &amp;#x27;subject&amp;#x27;: &amp;#x27;test&amp;#x27;, &amp;#x27;reply&amp;#x27;: &amp;#x27;&amp;#x27;}\n{&amp;#x27;body&amp;#x27;: &amp;#x27;publishing ...&amp;#x27;, &amp;#x27;content_type&amp;#x27;: &amp;#x27;text/plain&amp;#x27;, &amp;#x27;message_id&amp;#x27;: &amp;#x27;ec023ef4-a171-4a6b-9700-222bd15962aa&amp;#x27;, &amp;#x27;correlation_id&amp;#x27;: &amp;#x27;ec023ef4-a171-4a6b-9700-222bd15962aa&amp;#x27;, &amp;#x27;path&amp;#x27;: {}, &amp;#x27;committed&amp;#x27;: None, &amp;#x27;subject&amp;#x27;: &amp;#x27;xxx&amp;#x27;, &amp;#x27;reply&amp;#x27;: &amp;#x27;&amp;#x27;}\n\n----------------------------- Captured stderr call -----------------------------\n[20435] 2026/01/15 12:35:18.459238 [INF] Starting nats-server\n[20435] 2026/01/15 12:35:18.459337 [INF]   Version:  2.12.3\n[20435] 2026/01/15 12:35:18.459344 [INF]   Git:      [450a519]\n[20435] 2026/01/15 12:35:18.459348 [INF]   Name:     NAH5JJPMWEDZSUATXNTFVU62KBIEWNPRZWQC7JPWA23OOT6F2UGTAIS5\n[20435] 2026/01/15 12:35:18.459353 [INF]   ID:       NAH5JJPMWEDZSUATXNTFVU62KBIEWNPRZWQC7JPWA23OOT6F2UGTAIS5\n[20435] 2026/01/15 12:35:18.460035 [INF] Listening for client connections on 0.0.0.0:8541\n[20435] 2026/01/15 12:35:18.460444 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[Errno 2] No such file or directory: &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/annuaire_local/main.py&amp;#x27;\nUsage: faststream run [OPTIONS] APP\nTry &amp;#x27;faststream run --help&amp;#x27; for help.\n\u256d\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Invalid value: Please, input module like [python_file:docs_object] or        \u2502\n\u2502 [module:attribute]                                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n2026-01-15 12:35:18,997 INFO     - FastStream app starting...\n2026-01-15 12:35:19,001 INFO     - FastStream app starting...\n2026-01-15 12:35:19,002 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:19,006 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:19,016 INFO     - FastStream app starting...\n2026-01-15 12:35:19,020 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:19,027 INFO     - FastStream app starting...\n2026-01-15 12:35:19,031 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:19,042 INFO     - FastStream app starting...\n2026-01-15 12:35:19,042 INFO     - FastStream app starting...\n2026-01-15 12:35:19,046 INFO     - FastStream app started successfully! To exit, press CTRL+C\n2026-01-15 12:35:19,051 INFO     - FastStream app started successfully! To exit, press CTRL+C\n      INFO   Started server process [20456]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:9172 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_je publie le message &amp;#x27;hello&amp;#x27; sur le canal &amp;#x27;api-gateway-OUT&amp;#x27;&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_je publie le message &amp;#x27;{msg}&amp;#x27; sur le canal &amp;#x27;{canal}&amp;#x27;&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:136 Starting service peppol on port 9240 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  peppol started on localhost:9240\nINFO     pac0.shared.test.world:world.py:83 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service esb_central on port 8541 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  esb_central started on localhost:8541\nINFO     pac0.shared.test.service.base:base.py:136 Starting service api_gateway on port 9172 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:136 Starting service controle_formats on port 8416 : uv run faststream run src/pac0/service/controle_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  controle_formats started on localhost:8416\nINFO     pac0.shared.test.service.base:base.py:136 Starting service validation_metier on port 8955 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready validation_metier ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  validation_metier started on localhost:8955\nINFO     pac0.shared.test.service.base:base.py:136 Starting service conversion_formats on port 8776 : uv run faststream run src/pac0/service/conversion_formats/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready conversion_formats ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  conversion_formats started on localhost:8776\nINFO     pac0.shared.test.service.base:base.py:136 Starting service annuaire_local on port 8506 : uv run faststream run src/pac0/service/annuaire_local/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready annuaire_local ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  annuaire_local started on localhost:8506\nINFO     pac0.shared.test.service.base:base.py:136 Starting service routage on port 9167 : uv run faststream run src/pac0/service/routage/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready routage ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  routage started on localhost:9167\nINFO     pac0.shared.test.service.base:base.py:136 Starting service transmission_fiscale on port 8867 : uv run faststream run src/pac0/service/transmission_fiscale/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready transmission_fiscale ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  transmission_fiscale started on localhost:8867\nINFO     pac0.shared.test.service.base:base.py:136 Starting service gestion_cycle_vie on port 8766 : uv run faststream run src/pac0/service/gestion_cycle_vie/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready gestion_cycle_vie ...\nINFO     pac0.shared.test.service.base:base.py:163 Service  gestion_cycle_vie started on localhost:8766\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=9172 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:192 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=9172 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7587b8ca6a50&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:19 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:9172/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:163 Service  api_gateway started on localhost:9172\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=9172 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8ca6d50&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:19 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;4&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:9172/publish &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;POST&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_then_j&amp;#x27;obtiens le message &amp;#x27;hello&amp;#x27; sur le canal &amp;#x27;controle-formats-IN&amp;#x27;&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_then_j&amp;#x27;obtiens le message &amp;#x27;{msg}&amp;#x27; sur le canal &amp;#x27;{canal}&amp;#x27;&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=9172 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:47 connect_tcp.complete return_value=&amp;lt;httpcore._backends.sync.SyncStream object at 0x7587b8e02950&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Thu, 15 Jan 2026 11:35:19 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;430&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1025 HTTP Request: GET http://localhost:9172/trace &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:47 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:47 response_closed.started\nDEBUG    httpcore.http11:_trace.py:47 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:47 close.started\nDEBUG    httpcore.connection:_trace.py:47 close.complete\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [20456]\n2026-01-15 12:35:19,900 INFO     - FastStream app shutting down...\n2026-01-15 12:35:19,901 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:20,105 INFO     - FastStream app shutting down...\n2026-01-15 12:35:20,106 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:20,319 INFO     - FastStream app shutting down...\n2026-01-15 12:35:20,320 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:20,531 INFO     - FastStream app shutting down...\n2026-01-15 12:35:20,532 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:20,746 INFO     - FastStream app shutting down...\n2026-01-15 12:35:20,747 INFO     - FastStream app shut down gracefully.\n2026-01-15 12:35:20,947 INFO     - FastStream app shutting down...\n2026-01-15 12:35:20,949 INFO     - FastStream app shut down gracefully.\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:175 Stopping service...\nINFO     pac0.shared.test.world:world.py:91 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_facture_rejet\u00e9e&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_facture_rejet\u00e9e&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_facture_rejet\u00e9e&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function submit_invoice_simple at 0x7587b970c400&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_facture_rejet\u00e9e&amp;gt;&amp;gt;, kwargs = {}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\n    @when(&amp;quot;je d\u00e9pose une facture&amp;quot;)\n    def submit_invoice_simple():\n        # POST /\n&amp;gt;       raise NotImplementedError()\nE       NotImplementedError\n\nsrc/pac_bdd/tobeimplemented.py:17: NotImplementedError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je d\u00e9pose une facture&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je d\u00e9pose une facture&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;report.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>