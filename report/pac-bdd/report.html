<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">report.html</title>
      <style type="text/css">body {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 12px;
  /* do not increase min-width as some may use split screens */
  min-width: 800px;
  color: #999;
}

h1 {
  font-size: 24px;
  color: black;
}

h2 {
  font-size: 16px;
  color: black;
}

p {
  color: black;
}

a {
  color: #999;
}

table {
  border-collapse: collapse;
}

/******************************
 * SUMMARY INFORMATION
 ******************************/
#environment td {
  padding: 5px;
  border: 1px solid #e6e6e6;
  vertical-align: top;
}
#environment tr:nth-child(odd) {
  background-color: #f6f6f6;
}
#environment ul {
  margin: 0;
  padding: 0 20px;
}

/******************************
 * TEST RESULT COLORS
 ******************************/
span.passed,
.passed .col-result {
  color: green;
}

span.skipped,
span.xfailed,
span.rerun,
.skipped .col-result,
.xfailed .col-result,
.rerun .col-result {
  color: orange;
}

span.error,
span.failed,
span.xpassed,
.error .col-result,
.failed .col-result,
.xpassed .col-result {
  color: red;
}

.col-links__extra {
  margin-right: 3px;
}

/******************************
 * RESULTS TABLE
 *
 * 1. Table Layout
 * 2. Extra
 * 3. Sorting items
 *
 ******************************/
/*------------------
 * 1. Table Layout
 *------------------*/
#results-table {
  border: 1px solid #e6e6e6;
  color: #999;
  font-size: 12px;
  width: 100%;
}
#results-table th,
#results-table td {
  padding: 5px;
  border: 1px solid #e6e6e6;
  text-align: left;
}
#results-table th {
  font-weight: bold;
}

/*------------------
 * 2. Extra
 *------------------*/
.logwrapper {
  max-height: 230px;
  overflow-y: scroll;
  background-color: #e6e6e6;
}
.logwrapper.expanded {
  max-height: none;
}
.logwrapper.expanded .logexpander:after {
  content: "collapse [-]";
}
.logwrapper .logexpander {
  z-index: 1;
  position: sticky;
  top: 10px;
  width: max-content;
  border: 1px solid;
  border-radius: 3px;
  padding: 5px 7px;
  margin: 10px 0 10px calc(100% - 80px);
  cursor: pointer;
  background-color: #e6e6e6;
}
.logwrapper .logexpander:after {
  content: "expand [+]";
}
.logwrapper .logexpander:hover {
  color: #000;
  border-color: #000;
}
.logwrapper .log {
  min-height: 40px;
  position: relative;
  top: -50px;
  height: calc(100% + 50px);
  border: 1px solid #e6e6e6;
  color: black;
  display: block;
  font-family: "Courier New", Courier, monospace;
  padding: 5px;
  padding-right: 80px;
  white-space: pre-wrap;
}

div.media {
  border: 1px solid #e6e6e6;
  float: right;
  height: 240px;
  margin: 0 5px;
  overflow: hidden;
  width: 320px;
}

.media-container {
  display: grid;
  grid-template-columns: 25px auto 25px;
  align-items: center;
  flex: 1 1;
  overflow: hidden;
  height: 200px;
}

.media-container--fullscreen {
  grid-template-columns: 0px auto 0px;
}

.media-container__nav--right,
.media-container__nav--left {
  text-align: center;
  cursor: pointer;
}

.media-container__viewport {
  cursor: pointer;
  text-align: center;
  height: inherit;
}
.media-container__viewport img,
.media-container__viewport video {
  object-fit: cover;
  width: 100%;
  max-height: 100%;
}

.media__name,
.media__counter {
  display: flex;
  flex-direction: row;
  justify-content: space-around;
  flex: 0 0 25px;
  align-items: center;
}

.collapsible td:not(.col-links) {
  cursor: pointer;
}
.collapsible td:not(.col-links):hover::after {
  color: #bbb;
  font-style: italic;
  cursor: pointer;
}

.col-result {
  width: 130px;
}
.col-result:hover::after {
  content: " (hide details)";
}

.col-result.collapsed:hover::after {
  content: " (show details)";
}

#environment-header h2:hover::after {
  content: " (hide details)";
  color: #bbb;
  font-style: italic;
  cursor: pointer;
  font-size: 12px;
}

#environment-header.collapsed h2:hover::after {
  content: " (show details)";
  color: #bbb;
  font-style: italic;
  cursor: pointer;
  font-size: 12px;
}

/*------------------
 * 3. Sorting items
 *------------------*/
.sortable {
  cursor: pointer;
}
.sortable.desc:after {
  content: " ";
  position: relative;
  left: 5px;
  bottom: -12.5px;
  border: 10px solid #4caf50;
  border-bottom: 0;
  border-left-color: transparent;
  border-right-color: transparent;
}
.sortable.asc:after {
  content: " ";
  position: relative;
  left: 5px;
  bottom: 12.5px;
  border: 10px solid #4caf50;
  border-top: 0;
  border-left-color: transparent;
  border-right-color: transparent;
}

.hidden, .summary__reload__button.hidden {
  display: none;
}

.summary__data {
  flex: 0 0 550px;
}
.summary__reload {
  flex: 1 1;
  display: flex;
  justify-content: center;
}
.summary__reload__button {
  flex: 0 0 300px;
  display: flex;
  color: white;
  font-weight: bold;
  background-color: #4caf50;
  text-align: center;
  justify-content: center;
  align-items: center;
  border-radius: 3px;
  cursor: pointer;
}
.summary__reload__button:hover {
  background-color: #46a049;
}
.summary__spacer {
  flex: 0 0 550px;
}

.controls {
  display: flex;
  justify-content: space-between;
}

.filters,
.collapse {
  display: flex;
  align-items: center;
}
.filters button,
.collapse button {
  color: #999;
  border: none;
  background: none;
  cursor: pointer;
  text-decoration: underline;
}
.filters button:hover,
.collapse button:hover {
  color: #ccc;
}

.filter__label {
  margin-right: 10px;
}

      </style>
    
  </head>
  <body>
    <h1 id="title">report.html</h1>
    <p>Report generated on 13-Jan-2026 at 17:57:13 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">64 tests took 00:04:03.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" />
            <span class="failed">56 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">8 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" disabled/>
            <span class="skipped">0 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled/>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled/>
            <span class="rerun">0 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.13.2&#34;, &#34;Platform&#34;: &#34;Linux-6.8.0-90-generic-x86_64-with-glibc2.39&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;8.4.2&#34;, &#34;pluggy&#34;: &#34;1.6.0&#34;}, &#34;Plugins&#34;: {&#34;html&#34;: &#34;4.1.1&#34;, &#34;bdd&#34;: &#34;8.1.0&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;, &#34;asyncio&#34;: &#34;1.3.0&#34;, &#34;md-report&#34;: &#34;0.7.0&#34;, &#34;anyio&#34;: &#34;4.12.0&#34;}}, &#34;tests&#34;: {&#34;test_fixture.py::test_dummy_fixture&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_fixture.py::test_dummy_fixture&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_fixture.py::test_dummy_fixture&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;test_fixture.py::test_dummy_async_fixture&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_fixture.py::test_dummy_async_fixture&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_fixture.py::test_dummy_async_fixture&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\n&#34;}], &#34;test_openapi.py::test_swagger_flow_service&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_openapi.py::test_swagger_flow_service&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_openapi.py::test_swagger_flow_service&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;def test_swagger_flow_service():\n        url = &amp;#x27;???&amp;#x27;\n&amp;gt;       _test_swagger(\n            url,\n            &amp;quot;docs/norme/XP_Z12-013_SWAGGER_Annexes_A_et_B_V1.2/ANNEXE A - PR XP Z12-013 - AFNOR-Flow_Service-1.1.0-swagger.json&amp;quot;,\n        )\n\ntest_openapi.py:24: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nurl = &amp;#x27;???&amp;#x27;, swagger = &amp;#x27;docs/norme/XP_Z12-013_SWAGGER_Annexes_A_et_B_V1.2/ANNEXE A - PR XP Z12-013 - AFNOR-Flow_Service-1.1.0-swagger.json&amp;#x27;\n\n    def _test_swagger(url: str, swagger: str):\n        &amp;quot;&amp;quot;&amp;quot;\n            V\u00e9rifier si une API respecte une definition Swagger/OpenAPI\n    \n        Cette API doit respecter le versioning indiqu\u00e9 dans l\u2019URL de la route API du Swagger. Dans un objectif de\n        simplification le versioning des routes n\u2019est pas affich\u00e9 dans le pr\u00e9sent document;\n        Dans cette API publi\u00e9e par le Fournisseur API ce dernier peut :\n        \u2022Avoir une URL sp\u00e9cifique en amont du versioning\n        \u2022Ajouter des propri\u00e9t\u00e9s aux objets dans les requ\u00eates.\n        \u2022Ajouter des param\u00e8tres aux routes dans les requ\u00eates.\n        \u2022Ajouter des propri\u00e9t\u00e9s aux objets dans les r\u00e9ponses.\n        \u2022Ajouter des codes erreurs dans les r\u00e9ponses.\n        &amp;quot;&amp;quot;&amp;quot;\n&amp;gt;       raise NotImplementedError(&amp;quot;swagger compliance non test\u00e9&amp;quot;)\nE       NotImplementedError: swagger compliance non test\u00e9\n\ntest_openapi.py:18: NotImplementedError\n&#34;}], &#34;test_openapi.py::test_swagger_directory_service&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_openapi.py::test_swagger_directory_service&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_openapi.py::test_swagger_directory_service&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;def test_swagger_directory_service():\n        url = &amp;quot;???&amp;quot;\n&amp;gt;       _test_swagger(\n            url,\n            &amp;quot;docs/norme/XP_Z12-013_SWAGGER_Annexes_A_et_B_V1.2/ANNEXE B - PR XP Z12-013 - AFNOR-Directory_Service-1.1.0-swagger.json&amp;quot;,\n        )\n\ntest_openapi.py:32: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nurl = &amp;#x27;???&amp;#x27;, swagger = &amp;#x27;docs/norme/XP_Z12-013_SWAGGER_Annexes_A_et_B_V1.2/ANNEXE B - PR XP Z12-013 - AFNOR-Directory_Service-1.1.0-swagger.json&amp;#x27;\n\n    def _test_swagger(url: str, swagger: str):\n        &amp;quot;&amp;quot;&amp;quot;\n            V\u00e9rifier si une API respecte une definition Swagger/OpenAPI\n    \n        Cette API doit respecter le versioning indiqu\u00e9 dans l\u2019URL de la route API du Swagger. Dans un objectif de\n        simplification le versioning des routes n\u2019est pas affich\u00e9 dans le pr\u00e9sent document;\n        Dans cette API publi\u00e9e par le Fournisseur API ce dernier peut :\n        \u2022Avoir une URL sp\u00e9cifique en amont du versioning\n        \u2022Ajouter des propri\u00e9t\u00e9s aux objets dans les requ\u00eates.\n        \u2022Ajouter des param\u00e8tres aux routes dans les requ\u00eates.\n        \u2022Ajouter des propri\u00e9t\u00e9s aux objets dans les r\u00e9ponses.\n        \u2022Ajouter des codes erreurs dans les r\u00e9ponses.\n        &amp;quot;&amp;quot;&amp;quot;\n&amp;gt;       raise NotImplementedError(&amp;quot;swagger compliance non test\u00e9&amp;quot;)\nE       NotImplementedError: swagger compliance non test\u00e9\n\ntest_openapi.py:18: NotImplementedError\n&#34;}], &#34;test_pac0.py::test_pac0_import_services&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_pac0.py::test_pac0_import_services&#34;, &#34;duration&#34;: &#34;16 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_pac0.py::test_pac0_import_services&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;16 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;+ Exception Group Traceback (most recent call last):\n  |   File &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac-bdd/test_pac0.py&amp;quot;, line 21, in test_pac0_import_services\n  |     async with asyncio.TaskGroup() as tg:\n  |                ~~~~~~~~~~~~~~~~~^^\n  |   File &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/taskgroups.py&amp;quot;, line 71, in __aexit__\n  |     return await self._aexit(et, exc)\n  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  |   File &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/taskgroups.py&amp;quot;, line 173, in _aexit\n  |     raise BaseExceptionGroup(\n  |     ...&amp;lt;2 lines&amp;gt;...\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac-bdd/test_pac0.py&amp;quot;, line 22, in test_pac0_import_services\n    |     task1 = tg.create_task(api_gateway_main.app.run())\n    |                            ^^^^^^^^^^^^^^^^^^^^^^^^\n    | AttributeError: &amp;#x27;FastAPI&amp;#x27; object has no attribute &amp;#x27;run&amp;#x27;\n    +------------------------------------\n\n------------------------------ Captured log setup ------------------------------\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\n\n----------------------------- Captured stdout call -----------------------------\nConnecting to NATS nats://localhost:4222 ...\n&#34;}], &#34;test_scenario.py::test_trackingid_fourni&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_trackingid_fourni&#34;, &#34;duration&#34;: &#34;00:00:40&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_trackingid_fourni&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:40&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_trackingid_fourni&amp;gt;&amp;gt;, argname = &amp;#x27;world1&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:743: in pytest_fixture_setup\n    hook_result = yield\n                  ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:313: in _asyncgen_fixture_wrapper\n    result = runner.run(setup(), context=context)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:118: in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/base_events.py:725: in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:309: in setup\n    res = await gen_obj.__anext__()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n../pac0/src/pac0/shared/test/world.py:338: in world1\n    await world.pa_new()\n../pac0/src/pac0/shared/test/world.py:71: in pa_new\n    await asyncio.gather(*tasks)\n../pac0/src/pac0/shared/test/service/pac.py:58: in __aenter__\n    await asyncio.gather(*[s.__aenter__() for s in self._services()])\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = &amp;lt;pac0.shared.test.service.fastapi.FastApiServiceContext object at 0x7d037abd78c0&amp;gt;\n\n    async def __aenter__(self) -&amp;gt; Self:\n        &amp;quot;&amp;quot;&amp;quot;Start the service subprocess.&amp;quot;&amp;quot;&amp;quot;\n        if self.config.port == 0:\n            self.config.port = find_available_port(start_port=8000)\n        logger.info(\n            f&amp;quot;Starting service {self.config.name} on port {self.config.port} : {&amp;#x27; &amp;#x27;.join(self.config.command)}&amp;quot;\n        )\n        env = os.environ.copy()\n        env[&amp;quot;PORT&amp;quot;] = str(self.config.port)\n        if self.config.env_var_extra:\n            env.update(self.config.env_var_extra)\n        command = [c.format(**env) for c in self.config.command]\n    \n        self._process = subprocess.Popen(\n            command,\n            # stdout=subprocess.PIPE,  # self.config.stdout,\n            # stderr=subprocess.PIPE,  # self.config.stderr,\n            text=True,\n            env=env,\n            cwd=PACKAGE_BASE_FOLDER,\n        )\n    \n        # Wait for service to be ready\n        self.is_ready = await self.wait_for_ready(self.config.startup_timeout)\n        if not self.is_ready:\n            await self._terminate()\n&amp;gt;           raise TimeoutError(\n                f&amp;quot;Service {self.config.name} failed to start within {self.config.startup_timeout}s&amp;quot;\n            )\nE           TimeoutError: Service api_gateway failed to start within 30.0s\n\n../pac0/src/pac0/shared/test/service/base.py:157: TimeoutError\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:4222 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8139\n    server   Documentation at http://0.0.0.0:8139/docs\n \n             Logs:\n \n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8139/healthcheck\ncccccc All connection attempts failed\n\n----------------------------- Captured stderr call -----------------------------\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[80641] 2026/01/13 17:53:07.819734 [INF] Starting nats-server\n[80641] 2026/01/13 17:53:07.819788 [INF]   Version:  2.12.3\n[80641] 2026/01/13 17:53:07.819791 [INF]   Git:      [450a519]\n[80641] 2026/01/13 17:53:07.819793 [INF]   Name:     NAAKI2CXLN3O4BHUFLUJAIMVJN7F4RMPB42JUZLNVPIAIKFHV4VFZ2GV\n[80641] 2026/01/13 17:53:07.819800 [INF]   ID:       NAAKI2CXLN3O4BHUFLUJAIMVJN7F4RMPB42JUZLNVPIAIKFHV4VFZ2GV\n[80641] 2026/01/13 17:53:07.820265 [INF] Listening for client connections on 0.0.0.0:8125\n[80641] 2026/01/13 17:53:07.820530 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n2026-01-13 17:53:08,083 INFO     - FastStream app starting...\n      INFO   Started server process [80640]\n      INFO   Waiting for application startup.\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API POST /flows&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8120 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8120\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service api_gateway on port 8139 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service esb_central on port 8125 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  esb_central started on localhost:8125\nINFO     pac0.shared.test.service.base:base.py:135 Starting service controle_formats on port 8001 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  controle_formats started on localhost:8001\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8139 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nWARNING  pac0.shared.test.service.base:base.py:179 Service didn&amp;#x27;t terminate gracefully, killing...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_trackingid_absent&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_trackingid_absent&#34;, &#34;duration&#34;: &#34;00:00:40&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_trackingid_absent&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:40&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_trackingid_absent&amp;gt;&amp;gt;, argname = &amp;#x27;world1&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:743: in pytest_fixture_setup\n    hook_result = yield\n                  ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:313: in _asyncgen_fixture_wrapper\n    result = runner.run(setup(), context=context)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:118: in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/base_events.py:725: in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:309: in setup\n    res = await gen_obj.__anext__()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n../pac0/src/pac0/shared/test/world.py:338: in world1\n    await world.pa_new()\n../pac0/src/pac0/shared/test/world.py:71: in pa_new\n    await asyncio.gather(*tasks)\n../pac0/src/pac0/shared/test/service/pac.py:58: in __aenter__\n    await asyncio.gather(*[s.__aenter__() for s in self._services()])\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = &amp;lt;pac0.shared.test.service.fastapi.FastApiServiceContext object at 0x7d037ab27d90&amp;gt;\n\n    async def __aenter__(self) -&amp;gt; Self:\n        &amp;quot;&amp;quot;&amp;quot;Start the service subprocess.&amp;quot;&amp;quot;&amp;quot;\n        if self.config.port == 0:\n            self.config.port = find_available_port(start_port=8000)\n        logger.info(\n            f&amp;quot;Starting service {self.config.name} on port {self.config.port} : {&amp;#x27; &amp;#x27;.join(self.config.command)}&amp;quot;\n        )\n        env = os.environ.copy()\n        env[&amp;quot;PORT&amp;quot;] = str(self.config.port)\n        if self.config.env_var_extra:\n            env.update(self.config.env_var_extra)\n        command = [c.format(**env) for c in self.config.command]\n    \n        self._process = subprocess.Popen(\n            command,\n            # stdout=subprocess.PIPE,  # self.config.stdout,\n            # stderr=subprocess.PIPE,  # self.config.stderr,\n            text=True,\n            env=env,\n            cwd=PACKAGE_BASE_FOLDER,\n        )\n    \n        # Wait for service to be ready\n        self.is_ready = await self.wait_for_ready(self.config.startup_timeout)\n        if not self.is_ready:\n            await self._terminate()\n&amp;gt;           raise TimeoutError(\n                f&amp;quot;Service {self.config.name} failed to start within {self.config.startup_timeout}s&amp;quot;\n            )\nE           TimeoutError: Service api_gateway failed to start within 30.0s\n\n../pac0/src/pac0/shared/test/service/base.py:157: TimeoutError\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:4222 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8024\n    server   Documentation at http://0.0.0.0:8024/docs\n \n             Logs:\n \n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8024/healthcheck\ncccccc All connection attempts failed\n\n----------------------------- Captured stderr call -----------------------------\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[80694] 2026/01/13 17:53:48.344688 [INF] Starting nats-server\n[80694] 2026/01/13 17:53:48.344752 [INF]   Version:  2.12.3\n[80694] 2026/01/13 17:53:48.344758 [INF]   Git:      [450a519]\n[80694] 2026/01/13 17:53:48.344762 [INF]   Name:     NB5RTAEMBG46A2ZNUJ5TVSPD4FWQY5Z2DNLP2KAVGECRRDCDYFGJEXRG\n[80694] 2026/01/13 17:53:48.344766 [INF]   ID:       NB5RTAEMBG46A2ZNUJ5TVSPD4FWQY5Z2DNLP2KAVGECRRDCDYFGJEXRG\n[80694] 2026/01/13 17:53:48.345383 [INF] Listening for client connections on 0.0.0.0:8117\n[80694] 2026/01/13 17:53:48.345890 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n2026-01-13 17:53:48,774 INFO     - FastStream app starting...\n      INFO   Started server process [80708]\n      INFO   Waiting for application startup.\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API POST /flows&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8058 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8058\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service api_gateway on port 8024 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service esb_central on port 8117 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  esb_central started on localhost:8117\nINFO     pac0.shared.test.service.base:base.py:135 Starting service controle_formats on port 8089 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  controle_formats started on localhost:8089\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8024 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nWARNING  pac0.shared.test.service.base:base.py:179 Service didn&amp;#x27;t terminate gracefully, killing...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_trackingid_doublon&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_trackingid_doublon&#34;, &#34;duration&#34;: &#34;00:00:40&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_trackingid_doublon&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:40&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_trackingid_doublon&amp;gt;&amp;gt;, argname = &amp;#x27;world1&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:743: in pytest_fixture_setup\n    hook_result = yield\n                  ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:313: in _asyncgen_fixture_wrapper\n    result = runner.run(setup(), context=context)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:118: in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/base_events.py:725: in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:309: in setup\n    res = await gen_obj.__anext__()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n../pac0/src/pac0/shared/test/world.py:338: in world1\n    await world.pa_new()\n../pac0/src/pac0/shared/test/world.py:71: in pa_new\n    await asyncio.gather(*tasks)\n../pac0/src/pac0/shared/test/service/pac.py:58: in __aenter__\n    await asyncio.gather(*[s.__aenter__() for s in self._services()])\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = &amp;lt;pac0.shared.test.service.fastapi.FastApiServiceContext object at 0x7d037ab26c10&amp;gt;\n\n    async def __aenter__(self) -&amp;gt; Self:\n        &amp;quot;&amp;quot;&amp;quot;Start the service subprocess.&amp;quot;&amp;quot;&amp;quot;\n        if self.config.port == 0:\n            self.config.port = find_available_port(start_port=8000)\n        logger.info(\n            f&amp;quot;Starting service {self.config.name} on port {self.config.port} : {&amp;#x27; &amp;#x27;.join(self.config.command)}&amp;quot;\n        )\n        env = os.environ.copy()\n        env[&amp;quot;PORT&amp;quot;] = str(self.config.port)\n        if self.config.env_var_extra:\n            env.update(self.config.env_var_extra)\n        command = [c.format(**env) for c in self.config.command]\n    \n        self._process = subprocess.Popen(\n            command,\n            # stdout=subprocess.PIPE,  # self.config.stdout,\n            # stderr=subprocess.PIPE,  # self.config.stderr,\n            text=True,\n            env=env,\n            cwd=PACKAGE_BASE_FOLDER,\n        )\n    \n        # Wait for service to be ready\n        self.is_ready = await self.wait_for_ready(self.config.startup_timeout)\n        if not self.is_ready:\n            await self._terminate()\n&amp;gt;           raise TimeoutError(\n                f&amp;quot;Service {self.config.name} failed to start within {self.config.startup_timeout}s&amp;quot;\n            )\nE           TimeoutError: Service api_gateway failed to start within 30.0s\n\n../pac0/src/pac0/shared/test/service/base.py:157: TimeoutError\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:4222 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8138\n    server   Documentation at http://0.0.0.0:8138/docs\n \n             Logs:\n \n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8138/healthcheck\ncccccc All connection attempts failed\nsetup pac0 service ...\n\n----------------------------- Captured stderr call -----------------------------\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[80748] 2026/01/13 17:54:28.823860 [INF] Starting nats-server\n[80748] 2026/01/13 17:54:28.823916 [INF]   Version:  2.12.3\n[80748] 2026/01/13 17:54:28.823922 [INF]   Git:      [450a519]\n[80748] 2026/01/13 17:54:28.823926 [INF]   Name:     NDV4KUFL3VMFBJHVTNBSJFNQPSK3W6P64J3BM4255XT6ZJMWXZAM6NQ6\n[80748] 2026/01/13 17:54:28.823930 [INF]   ID:       NDV4KUFL3VMFBJHVTNBSJFNQPSK3W6P64J3BM4255XT6ZJMWXZAM6NQ6\n[80748] 2026/01/13 17:54:28.824662 [INF] Listening for client connections on 0.0.0.0:8188\n[80748] 2026/01/13 17:54:28.825112 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n2026-01-13 17:54:29,264 INFO     - FastStream app starting...\n      INFO   Started server process [80762]\n      INFO   Waiting for application startup.\n     ERROR   Traceback (most recent call last):                                 \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/starlette/routing.py&amp;quot;, line 694, in lifespan    \n                 async with self.lifespan_context(app) as maybe_state:          \n                            ~~~~~~~~~~~~~~~~~~~~~^^^^^                          \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/fastapi/routing.py&amp;quot;, line 200, in               \n             merged_lifespan                                                    \n                 async with original_context(app) as maybe_original_state:      \n                            ~~~~~~~~~~~~~~~~^^^^^                               \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/fastapi/routing.py&amp;quot;, line 201, in               \n             merged_lifespan                                                    \n                 async with nested_context(app) as maybe_nested_state:          \n                            ~~~~~~~~~~~~~~^^^^^                                 \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/fastapi/router.py&amp;quot;, line   \n             290, in start_broker_lifespan                                      \n                 await self._start_broker()                                     \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/application.py&amp;quot;, line 98,  \n             in _start_broker                                                   \n                 await b.start()                                                \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/nats/broker/broker.py&amp;quot;, line 462, in \n             start                                                              \n                 await self.connect()                                           \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/broker/broker.py&amp;quot;, line    \n             111, in connect                                                    \n                 self._connection = await self._connect()                       \n                                    ^^^^^^^^^^^^^^^^^^^^^                       \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/nats/broker/broker.py&amp;quot;, line 427, in \n             _connect                                                           \n                 connection = await nats.connect(**self._connection_kwargs)     \n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^     \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/__init__.py&amp;quot;, line 46, in connect          \n                 await nc.connect(servers, **options)                           \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 547, in connect       \n                 raise e                                                        \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 535, in connect       \n                 await self._select_next_server()                               \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 1365, in              \n             _select_next_server                                                \n                 raise errors.NoServersError                                    \n             nats.errors.NoServersError: nats: no servers available for         \n             connection\n     ERROR   Application startup failed. Exiting.\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/cli/main.py:213 in run                         \u2502\n\u2502                                                                              \u2502\n\u2502   210 \u2502   \u2502   \u2502   raise typer.BadParameter(msg)                              \u2502\n\u2502   211 \u2502                                                                      \u2502\n\u2502   212 \u2502   else:                                                              \u2502\n\u2502 \u2771 213 \u2502   \u2502   _run_imported_app(app_obj, args=run_args)                      \u2502\n\u2502   214                                                                        \u2502\n\u2502   215                                                                        \u2502\n\u2502   216 def _run(args: RunArgs) -&amp;gt; None:                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502              app = &amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;         \u2502 \u2502\n\u2502 \u2502          app_dir = &amp;#x27;.&amp;#x27;                                                   \u2502 \u2502\n\u2502 \u2502          app_obj = &amp;lt;faststream.app.FastStream object at 0x7d620f802120&amp;gt;  \u2502 \u2502\n\u2502 \u2502 casted_log_level = 0                                                     \u2502 \u2502\n\u2502 \u2502              ctx = &amp;lt;click.core.Context object at 0x7d620fad9950&amp;gt;         \u2502 \u2502\n\u2502 \u2502            extra = {&amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;}                                      \u2502 \u2502\n\u2502 \u2502       is_factory = False                                                 \u2502 \u2502\n\u2502 \u2502       log_config = None                                                  \u2502 \u2502\n\u2502 \u2502        log_level = &amp;lt;LogLevels.notset: &amp;#x27;notset&amp;#x27;&amp;gt;                          \u2502 \u2502\n\u2502 \u2502             loop = &amp;#x27;auto&amp;#x27;                                                \u2502 \u2502\n\u2502 \u2502      module_path = PosixPath(&amp;#x27;/home/philippe/src/PA_Communautaire/packa\u2026 \u2502 \u2502\n\u2502 \u2502           reload = False                                                 \u2502 \u2502\n\u2502 \u2502         run_args = RunArgs(                                              \u2502 \u2502\n\u2502 \u2502                    \u2502                                                     \u2502 \u2502\n\u2502 \u2502                    app=&amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;,    \u2502 \u2502\n\u2502 \u2502                    \u2502   extra_options={                                   \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   &amp;#x27;worker_id&amp;#x27;: None,                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   &amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;                                \u2502 \u2502\n\u2502 \u2502                    \u2502   },                                                \u2502 \u2502\n\u2502 \u2502                    \u2502   is_factory=False,                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   log_config=None,                                  \u2502 \u2502\n\u2502 \u2502                    \u2502   log_level=0,                                      \u2502 \u2502\n\u2502 \u2502                    \u2502   app_level=20,                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   loop=&amp;#x27;auto&amp;#x27;                                       \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502 watch_extensions = []                                                    \u2502 \u2502\n\u2502 \u2502          workers = 1                                                     \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/cli/main.py:248 in _run_imported_app           \u2502\n\u2502                                                                              \u2502\n\u2502   245 \u2502   \u2502   \u2502   backend_options[&amp;quot;loop_factory&amp;quot;] = uvloop.new_event_loop    \u2502\n\u2502   246 \u2502                                                                      \u2502\n\u2502   247 \u2502   try:                                                               \u2502\n\u2502 \u2771 248 \u2502   \u2502   anyio.run(                                                     \u2502\n\u2502   249 \u2502   \u2502   \u2502   app_obj.run,                                               \u2502\n\u2502   250 \u2502   \u2502   \u2502   args.app_level,                                            \u2502\n\u2502   251 \u2502   \u2502   \u2502   args.extra_options,                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         app_obj = &amp;lt;faststream.app.FastStream object at 0x7d620f802120&amp;gt;   \u2502 \u2502\n\u2502 \u2502            args = RunArgs(                                               \u2502 \u2502\n\u2502 \u2502                   \u2502   app=&amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;, \u2502 \u2502\n\u2502 \u2502                   \u2502   extra_options={                                    \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   &amp;#x27;worker_id&amp;#x27;: None,                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   &amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;                                 \u2502 \u2502\n\u2502 \u2502                   \u2502   },                                                 \u2502 \u2502\n\u2502 \u2502                   \u2502   is_factory=False,                                  \u2502 \u2502\n\u2502 \u2502                   \u2502   log_config=None,                                   \u2502 \u2502\n\u2502 \u2502                   \u2502   log_level=0,                                       \u2502 \u2502\n\u2502 \u2502                   \u2502   app_level=20,                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   loop=&amp;#x27;auto&amp;#x27;                                        \u2502 \u2502\n\u2502 \u2502                   )                                                      \u2502 \u2502\n\u2502 \u2502 backend_options = {                                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   &amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at        \u2502 \u2502\n\u2502 \u2502                   0x7d620f976520&amp;gt;                                        \u2502 \u2502\n\u2502 \u2502                   }                                                      \u2502 \u2502\n\u2502 \u2502          uvloop = &amp;lt;module &amp;#x27;uvloop&amp;#x27; from                                  \u2502 \u2502\n\u2502 \u2502                   &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/.v\u2026 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_core/_eventloop.py:75 in run                                 \u2502\n\u2502                                                                              \u2502\n\u2502    72 \u2502                                                                      \u2502\n\u2502    73 \u2502   try:                                                               \u2502\n\u2502    74 \u2502   \u2502   backend_options = backend_options or {}                        \u2502\n\u2502 \u2771  75 \u2502   \u2502   return async_backend.run(func, args, {}, backend_options)      \u2502\n\u2502    76 \u2502   finally:                                                           \u2502\n\u2502    77 \u2502   \u2502   reset_current_async_library(token)                             \u2502\n\u2502    78                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502            args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;})              \u2502 \u2502\n\u2502 \u2502   asynclib_name = None                                                   \u2502 \u2502\n\u2502 \u2502         backend = &amp;#x27;asyncio&amp;#x27;                                              \u2502 \u2502\n\u2502 \u2502 backend_options = {                                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   &amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at        \u2502 \u2502\n\u2502 \u2502                   0x7d620f976520&amp;gt;                                        \u2502 \u2502\n\u2502 \u2502                   }                                                      \u2502 \u2502\n\u2502 \u2502            func = &amp;lt;bound method FastStream.run of                        \u2502 \u2502\n\u2502 \u2502                   &amp;lt;faststream.app.FastStream object at 0x7d620f802120&amp;gt;&amp;gt;  \u2502 \u2502\n\u2502 \u2502           token = None                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_backends/_asyncio.py:2365 in run                             \u2502\n\u2502                                                                              \u2502\n\u2502   2362 \u2502   \u2502   \u2502   \u2502   loop_factory = winloop.new_event_loop                 \u2502\n\u2502   2363 \u2502   \u2502                                                                 \u2502\n\u2502   2364 \u2502   \u2502   with Runner(debug=debug, loop_factory=loop_factory) as runner \u2502\n\u2502 \u2771 2365 \u2502   \u2502   \u2502   return runner.run(wrapper())                              \u2502\n\u2502   2366 \u2502                                                                     \u2502\n\u2502   2367 \u2502   @classmethod                                                      \u2502\n\u2502   2368 \u2502   def current_token(cls) -&amp;gt; object:                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502    args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;})                      \u2502 \u2502\n\u2502 \u2502   debug = None                                                           \u2502 \u2502\n\u2502 \u2502    func = &amp;lt;bound method FastStream.run of &amp;lt;faststream.app.FastStream     \u2502 \u2502\n\u2502 \u2502           object at 0x7d620f802120&amp;gt;&amp;gt;                                     \u2502 \u2502\n\u2502 \u2502  kwargs = {}                                                             \u2502 \u2502\n\u2502 \u2502 options = {&amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at 0x7d620f976520&amp;gt;}  \u2502 \u2502\n\u2502 \u2502  runner = &amp;lt;asyncio.runners.Runner object at 0x7d620f802a50&amp;gt;              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/py \u2502\n\u2502 thon3.13/asyncio/runners.py:118 in run                                       \u2502\n\u2502                                                                              \u2502\n\u2502   115 \u2502   \u2502                                                                  \u2502\n\u2502   116 \u2502   \u2502   self._interrupt_count = 0                                      \u2502\n\u2502   117 \u2502   \u2502   try:                                                           \u2502\n\u2502 \u2771 118 \u2502   \u2502   \u2502   return self._loop.run_until_complete(task)                 \u2502\n\u2502   119 \u2502   \u2502   except exceptions.CancelledError:                              \u2502\n\u2502   120 \u2502   \u2502   \u2502   if self._interrupt_count &amp;gt; 0:                              \u2502\n\u2502   121 \u2502   \u2502   \u2502   \u2502   uncancel = getattr(task, &amp;quot;uncancel&amp;quot;, None)             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        context = &amp;lt;_contextvars.Context object at 0x7d620f4a5200&amp;gt;         \u2502 \u2502\n\u2502 \u2502           coro = &amp;lt;coroutine object FastStream.run at 0x7d620f48f4c0&amp;gt;     \u2502 \u2502\n\u2502 \u2502           self = &amp;lt;asyncio.runners.Runner object at 0x7d620f802a50&amp;gt;       \u2502 \u2502\n\u2502 \u2502 sigint_handler = functools.partial(&amp;lt;bound method Runner._on_sigint of    \u2502 \u2502\n\u2502 \u2502                  &amp;lt;asyncio.runners.Runner object at 0x7d620f802a50&amp;gt;&amp;gt;,     \u2502 \u2502\n\u2502 \u2502                  main_task=&amp;lt;Task finished                                \u2502 \u2502\n\u2502 \u2502                  name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;                    \u2502 \u2502\n\u2502 \u2502                  coro=&amp;lt;FastStream.run() done, defined at                 \u2502 \u2502\n\u2502 \u2502                  /home/philippe/src/PA_Communautaire/packages/pac0/.ven\u2026 \u2502 \u2502\n\u2502 \u2502                  exception=NoServersError()&amp;gt;)                            \u2502 \u2502\n\u2502 \u2502           task = &amp;lt;Task finished name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;     \u2502 \u2502\n\u2502 \u2502                  coro=&amp;lt;FastStream.run() done, defined at                 \u2502 \u2502\n\u2502 \u2502                  /home/philippe/src/PA_Communautaire/packages/pac0/.ven\u2026 \u2502 \u2502\n\u2502 \u2502                  exception=NoServersError()&amp;gt;                             \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 in uvloop.loop.Loop.run_until_complete:1518                                  \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_backends/_asyncio.py:2348 in wrapper                         \u2502\n\u2502                                                                              \u2502\n\u2502   2345 \u2502   \u2502   \u2502   _task_states[task] = TaskState(None, None)                \u2502\n\u2502   2346 \u2502   \u2502   \u2502                                                             \u2502\n\u2502   2347 \u2502   \u2502   \u2502   try:                                                      \u2502\n\u2502 \u2771 2348 \u2502   \u2502   \u2502   \u2502   return await func(*args)                              \u2502\n\u2502   2349 \u2502   \u2502   \u2502   finally:                                                  \u2502\n\u2502   2350 \u2502   \u2502   \u2502   \u2502   del _task_states[task]                                \u2502\n\u2502   2351                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;})                         \u2502 \u2502\n\u2502 \u2502 func = &amp;lt;bound method FastStream.run of &amp;lt;faststream.app.FastStream object \u2502 \u2502\n\u2502 \u2502        at 0x7d620f802120&amp;gt;&amp;gt;                                               \u2502 \u2502\n\u2502 \u2502 task = &amp;lt;Task finished name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;               \u2502 \u2502\n\u2502 \u2502        coro=&amp;lt;FastStream.run() done, defined at                           \u2502 \u2502\n\u2502 \u2502        /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/pyth\u2026 \u2502 \u2502\n\u2502 \u2502        exception=NoServersError()&amp;gt;                                       \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/app.py:100 in run                                        \u2502\n\u2502                                                                              \u2502\n\u2502    97 \u2502   \u2502   \u2502   \u2502   \u2502   tg.cancel_scope.cancel()                           \u2502\n\u2502    98 \u2502   \u2502   \u2502   except ExceptionGroup as e:                                \u2502\n\u2502    99 \u2502   \u2502   \u2502   \u2502   for ex in e.exceptions:                                \u2502\n\u2502 \u2771 100 \u2502   \u2502   \u2502   \u2502   \u2502   raise ex from None                                 \u2502\n\u2502   101 \u2502                                                                      \u2502\n\u2502   102 \u2502   def exit(self) -&amp;gt; None:                                            \u2502\n\u2502   103 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Stop application manually.&amp;quot;&amp;quot;&amp;quot;                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502                ex = NoServersError()                                     \u2502 \u2502\n\u2502 \u2502         log_level = 20                                                   \u2502 \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7d620f802120&amp;gt; \u2502 \u2502\n\u2502 \u2502        sleep_time = 0.1                                                  \u2502 \u2502\n\u2502 \u2502                tg = &amp;lt;anyio._backends._asyncio.TaskGroup object at        \u2502 \u2502\n\u2502 \u2502                     0x7d620f8034d0&amp;gt;                                      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:205 in _startup                 \u2502\n\u2502                                                                              \u2502\n\u2502   202 \u2502   ) -&amp;gt; None:                                                         \u2502\n\u2502   203 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Private method calls `start` with logging.&amp;quot;&amp;quot;&amp;quot;               \u2502\n\u2502   204 \u2502   \u2502   async with self._startup_logging(log_level=log_level):         \u2502\n\u2502 \u2771 205 \u2502   \u2502   \u2502   await self.start(**(run_extra_options or {}))              \u2502\n\u2502   206 \u2502   \u2502                                                                  \u2502\n\u2502   207 \u2502   \u2502   self.running = True                                            \u2502\n\u2502   208                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         log_level = 20                                                   \u2502 \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7d620f802120&amp;gt; \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:215 in start                    \u2502\n\u2502                                                                              \u2502\n\u2502   212 \u2502   ) -&amp;gt; None:                                                         \u2502\n\u2502   213 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Executes startup hooks and start broker.&amp;quot;&amp;quot;&amp;quot;                 \u2502\n\u2502   214 \u2502   \u2502   async with self._start_hooks_context(**run_extra_options):     \u2502\n\u2502 \u2771 215 \u2502   \u2502   \u2502   await self._start_broker()                                 \u2502\n\u2502   216 \u2502                                                                      \u2502\n\u2502   217 \u2502   @asynccontextmanager                                               \u2502\n\u2502   218 \u2502   async def _start_hooks_context(                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8001&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7d620f802120&amp;gt; \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:98 in _start_broker             \u2502\n\u2502                                                                              \u2502\n\u2502    95 \u2502   async def _start_broker(self) -&amp;gt; None:                             \u2502\n\u2502    96 \u2502   \u2502   assert self.brokers, &amp;quot;You should setup a broker&amp;quot;               \u2502\n\u2502    97 \u2502   \u2502   for b in self.brokers:                                         \u2502\n\u2502 \u2771  98 \u2502   \u2502   \u2502   await b.start()                                            \u2502\n\u2502    99 \u2502                                                                      \u2502\n\u2502   100 \u2502   @property                                                          \u2502\n\u2502   101 \u2502   def broker(self) -&amp;gt; Optional[&amp;quot;BrokerUsecase[Any, Any]&amp;quot;]:           \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502    b = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7d620f801940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2502 self = &amp;lt;faststream.app.FastStream object at 0x7d620f802120&amp;gt;              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/nats/broker/broker.py:462 in start                       \u2502\n\u2502                                                                              \u2502\n\u2502   459 \u2502                                                                      \u2502\n\u2502   460 \u2502   async def start(self) -&amp;gt; None:                                     \u2502\n\u2502   461 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Connect broker to NATS cluster and startup all subscribers. \u2502\n\u2502 \u2771 462 \u2502   \u2502   await self.connect()                                           \u2502\n\u2502   463 \u2502   \u2502                                                                  \u2502\n\u2502   464 \u2502   \u2502   stream_context = self.config.connection_state.stream           \u2502\n\u2502   465                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7d620f801940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/broker/broker.py:111 in connect                \u2502\n\u2502                                                                              \u2502\n\u2502   108 \u2502   async def connect(self) -&amp;gt; ConnectionType:                         \u2502\n\u2502   109 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Connect to a remote server.&amp;quot;&amp;quot;&amp;quot;                              \u2502\n\u2502   110 \u2502   \u2502   if self._connection is None:                                   \u2502\n\u2502 \u2771 111 \u2502   \u2502   \u2502   self._connection = await self._connect()                   \u2502\n\u2502   112 \u2502   \u2502   \u2502   self._setup_logger()                                       \u2502\n\u2502   113 \u2502   \u2502                                                                  \u2502\n\u2502   114 \u2502   \u2502   return self._connection                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7d620f801940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/nats/broker/broker.py:427 in _connect                    \u2502\n\u2502                                                                              \u2502\n\u2502   424 \u2502   \u2502   )                                                              \u2502\n\u2502   425 \u2502                                                                      \u2502\n\u2502   426 \u2502   async def _connect(self) -&amp;gt; &amp;quot;Client&amp;quot;:                              \u2502\n\u2502 \u2771 427 \u2502   \u2502   connection = await nats.connect(**self._connection_kwargs)     \u2502\n\u2502   428 \u2502   \u2502   self.config.connect(connection)                                \u2502\n\u2502   429 \u2502   \u2502   return connection                                              \u2502\n\u2502   430                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7d620f801940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/__init__.py:46 in connect                                      \u2502\n\u2502                                                                              \u2502\n\u2502   43 \u2502                                                                       \u2502\n\u2502   44 \u2502   &amp;quot;&amp;quot;&amp;quot;                                                                 \u2502\n\u2502   45 \u2502   nc = NATS()                                                         \u2502\n\u2502 \u2771 46 \u2502   await nc.connect(servers, **options)                                \u2502\n\u2502   47 \u2502   return nc                                                           \u2502\n\u2502   48                                                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                              \u2502\n\u2502 \u2502      nc = &amp;lt;nats client v2.12.0&amp;gt;             \u2502                              \u2502\n\u2502 \u2502 options = {                                 \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;name&amp;#x27;: &amp;#x27;faststream-0.6.4&amp;#x27;,   \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;verbose&amp;#x27;: False,             \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;allow_reconnect&amp;#x27;: True,      \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;reconnect_time_wait&amp;#x27;: 2,     \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;max_reconnect_attempts&amp;#x27;: 60, \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;no_echo&amp;#x27;: False,             \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;pedantic&amp;#x27;: False,            \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;inbox_prefix&amp;#x27;: b&amp;#x27;_INBOX&amp;#x27;,    \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;pending_size&amp;#x27;: 2097152,      \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;connect_timeout&amp;#x27;: 2,         \u2502                              \u2502\n\u2502 \u2502           \u2502   ... +18                       \u2502                              \u2502\n\u2502 \u2502           }                                 \u2502                              \u2502\n\u2502 \u2502 servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502                              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                              \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:547 in connect                                   \u2502\n\u2502                                                                              \u2502\n\u2502    544 \u2502   \u2502   \u2502   \u2502   \u2502   # Never stop reconnecting                         \u2502\n\u2502    545 \u2502   \u2502   \u2502   \u2502   \u2502   continue                                          \u2502\n\u2502    546 \u2502   \u2502   \u2502   \u2502   self._err = e                                         \u2502\n\u2502 \u2771  547 \u2502   \u2502   \u2502   \u2502   raise e                                               \u2502\n\u2502    548 \u2502   \u2502   \u2502   except (OSError, errors.Error, asyncio.TimeoutError) as e \u2502\n\u2502    549 \u2502   \u2502   \u2502   \u2502   self._err = e                                         \u2502\n\u2502    550 \u2502   \u2502   \u2502   \u2502   await self._error_cb(e)                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                \u2502\n\u2502 \u2502        allow_reconnect = True                             \u2502                \u2502\n\u2502 \u2502                     cb = None                             \u2502                \u2502\n\u2502 \u2502              closed_cb = None                             \u2502                \u2502\n\u2502 \u2502        connect_timeout = 2                                \u2502                \u2502\n\u2502 \u2502        disconnected_cb = None                             \u2502                \u2502\n\u2502 \u2502   discovered_server_cb = None                             \u2502                \u2502\n\u2502 \u2502         dont_randomize = False                            \u2502                \u2502\n\u2502 \u2502          drain_timeout = 30                               \u2502                \u2502\n\u2502 \u2502          flush_timeout = None                             \u2502                \u2502\n\u2502 \u2502     flusher_queue_size = 1024                             \u2502                \u2502\n\u2502 \u2502           inbox_prefix = b&amp;#x27;_INBOX&amp;#x27;                        \u2502                \u2502\n\u2502 \u2502  max_outstanding_pings = 2                                \u2502                \u2502\n\u2502 \u2502 max_reconnect_attempts = 60                               \u2502                \u2502\n\u2502 \u2502                   name = &amp;#x27;faststream-0.6.4&amp;#x27;               \u2502                \u2502\n\u2502 \u2502             nkeys_seed = None                             \u2502                \u2502\n\u2502 \u2502         nkeys_seed_str = None                             \u2502                \u2502\n\u2502 \u2502                no_echo = False                            \u2502                \u2502\n\u2502 \u2502               password = None                             \u2502                \u2502\n\u2502 \u2502               pedantic = False                            \u2502                \u2502\n\u2502 \u2502           pending_size = 2097152                          \u2502                \u2502\n\u2502 \u2502          ping_interval = 120                              \u2502                \u2502\n\u2502 \u2502    reconnect_time_wait = 2                                \u2502                \u2502\n\u2502 \u2502                   self = &amp;lt;nats client v2.12.0&amp;gt;            \u2502                \u2502\n\u2502 \u2502                 server = Srv(                             \u2502                \u2502\n\u2502 \u2502                          \u2502   uri=ParseResult(             \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,           \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;, \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                 \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   params=&amp;#x27;&amp;#x27;,               \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;              \u2502                \u2502\n\u2502 \u2502                          \u2502   ),                           \u2502                \u2502\n\u2502 \u2502                          \u2502   reconnects=61,               \u2502                \u2502\n\u2502 \u2502                          \u2502   last_attempt=32465.34247708, \u2502                \u2502\n\u2502 \u2502                          \u2502   did_connect=False,           \u2502                \u2502\n\u2502 \u2502                          \u2502   discovered=False,            \u2502                \u2502\n\u2502 \u2502                          \u2502   tls_name=None,               \u2502                \u2502\n\u2502 \u2502                          \u2502   server_version=None          \u2502                \u2502\n\u2502 \u2502                          )                                \u2502                \u2502\n\u2502 \u2502 server_auth_configured = False                            \u2502                \u2502\n\u2502 \u2502                servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]        \u2502                \u2502\n\u2502 \u2502           signature_cb = None                             \u2502                \u2502\n\u2502 \u2502                    tls = None                             \u2502                \u2502\n\u2502 \u2502    tls_handshake_first = False                            \u2502                \u2502\n\u2502 \u2502           tls_hostname = None                             \u2502                \u2502\n\u2502 \u2502                  token = None                             \u2502                \u2502\n\u2502 \u2502                   user = None                             \u2502                \u2502\n\u2502 \u2502       user_credentials = None                             \u2502                \u2502\n\u2502 \u2502            user_jwt_cb = None                             \u2502                \u2502\n\u2502 \u2502                verbose = False                            \u2502                \u2502\n\u2502 \u2502  ws_connection_headers = None                             \u2502                \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:535 in connect                                   \u2502\n\u2502                                                                              \u2502\n\u2502    532 \u2502   \u2502                                                                 \u2502\n\u2502    533 \u2502   \u2502   while True:                                                   \u2502\n\u2502    534 \u2502   \u2502   \u2502   try:                                                      \u2502\n\u2502 \u2771  535 \u2502   \u2502   \u2502   \u2502   await self._select_next_server()                      \u2502\n\u2502    536 \u2502   \u2502   \u2502   \u2502   await self._process_connect_init()                    \u2502\n\u2502    537 \u2502   \u2502   \u2502   \u2502   assert (                                              \u2502\n\u2502    538 \u2502   \u2502   \u2502   \u2502   \u2502   self._current_server                              \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                \u2502\n\u2502 \u2502        allow_reconnect = True                             \u2502                \u2502\n\u2502 \u2502                     cb = None                             \u2502                \u2502\n\u2502 \u2502              closed_cb = None                             \u2502                \u2502\n\u2502 \u2502        connect_timeout = 2                                \u2502                \u2502\n\u2502 \u2502        disconnected_cb = None                             \u2502                \u2502\n\u2502 \u2502   discovered_server_cb = None                             \u2502                \u2502\n\u2502 \u2502         dont_randomize = False                            \u2502                \u2502\n\u2502 \u2502          drain_timeout = 30                               \u2502                \u2502\n\u2502 \u2502          flush_timeout = None                             \u2502                \u2502\n\u2502 \u2502     flusher_queue_size = 1024                             \u2502                \u2502\n\u2502 \u2502           inbox_prefix = b&amp;#x27;_INBOX&amp;#x27;                        \u2502                \u2502\n\u2502 \u2502  max_outstanding_pings = 2                                \u2502                \u2502\n\u2502 \u2502 max_reconnect_attempts = 60                               \u2502                \u2502\n\u2502 \u2502                   name = &amp;#x27;faststream-0.6.4&amp;#x27;               \u2502                \u2502\n\u2502 \u2502             nkeys_seed = None                             \u2502                \u2502\n\u2502 \u2502         nkeys_seed_str = None                             \u2502                \u2502\n\u2502 \u2502                no_echo = False                            \u2502                \u2502\n\u2502 \u2502               password = None                             \u2502                \u2502\n\u2502 \u2502               pedantic = False                            \u2502                \u2502\n\u2502 \u2502           pending_size = 2097152                          \u2502                \u2502\n\u2502 \u2502          ping_interval = 120                              \u2502                \u2502\n\u2502 \u2502    reconnect_time_wait = 2                                \u2502                \u2502\n\u2502 \u2502                   self = &amp;lt;nats client v2.12.0&amp;gt;            \u2502                \u2502\n\u2502 \u2502                 server = Srv(                             \u2502                \u2502\n\u2502 \u2502                          \u2502   uri=ParseResult(             \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,           \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;, \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                 \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   params=&amp;#x27;&amp;#x27;,               \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                \u2502                \u2502\n\u2502 \u2502                          \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;              \u2502                \u2502\n\u2502 \u2502                          \u2502   ),                           \u2502                \u2502\n\u2502 \u2502                          \u2502   reconnects=61,               \u2502                \u2502\n\u2502 \u2502                          \u2502   last_attempt=32465.34247708, \u2502                \u2502\n\u2502 \u2502                          \u2502   did_connect=False,           \u2502                \u2502\n\u2502 \u2502                          \u2502   discovered=False,            \u2502                \u2502\n\u2502 \u2502                          \u2502   tls_name=None,               \u2502                \u2502\n\u2502 \u2502                          \u2502   server_version=None          \u2502                \u2502\n\u2502 \u2502                          )                                \u2502                \u2502\n\u2502 \u2502 server_auth_configured = False                            \u2502                \u2502\n\u2502 \u2502                servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]        \u2502                \u2502\n\u2502 \u2502           signature_cb = None                             \u2502                \u2502\n\u2502 \u2502                    tls = None                             \u2502                \u2502\n\u2502 \u2502    tls_handshake_first = False                            \u2502                \u2502\n\u2502 \u2502           tls_hostname = None                             \u2502                \u2502\n\u2502 \u2502                  token = None                             \u2502                \u2502\n\u2502 \u2502                   user = None                             \u2502                \u2502\n\u2502 \u2502       user_credentials = None                             \u2502                \u2502\n\u2502 \u2502            user_jwt_cb = None                             \u2502                \u2502\n\u2502 \u2502                verbose = False                            \u2502                \u2502\n\u2502 \u2502  ws_connection_headers = None                             \u2502                \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:1365 in _select_next_server                      \u2502\n\u2502                                                                              \u2502\n\u2502   1362 \u2502   \u2502   while True:                                                   \u2502\n\u2502   1363 \u2502   \u2502   \u2502   if len(self._server_pool) == 0:                           \u2502\n\u2502   1364 \u2502   \u2502   \u2502   \u2502   self._current_server = None                           \u2502\n\u2502 \u2771 1365 \u2502   \u2502   \u2502   \u2502   raise errors.NoServersError                           \u2502\n\u2502   1366 \u2502   \u2502   \u2502                                                             \u2502\n\u2502   1367 \u2502   \u2502   \u2502   now = time.monotonic()                                    \u2502\n\u2502   1368 \u2502   \u2502   \u2502   s = self._server_pool.pop(0)                              \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                                  \u2502\n\u2502 \u2502  now = 32465.342495634                  \u2502                                  \u2502\n\u2502 \u2502    s = Srv(                             \u2502                                  \u2502\n\u2502 \u2502        \u2502   uri=ParseResult(             \u2502                                  \u2502\n\u2502 \u2502        \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,           \u2502                                  \u2502\n\u2502 \u2502        \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;, \u2502                                  \u2502\n\u2502 \u2502        \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                 \u2502                                  \u2502\n\u2502 \u2502        \u2502   \u2502   params=&amp;#x27;&amp;#x27;,               \u2502                                  \u2502\n\u2502 \u2502        \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                \u2502                                  \u2502\n\u2502 \u2502        \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;              \u2502                                  \u2502\n\u2502 \u2502        \u2502   ),                           \u2502                                  \u2502\n\u2502 \u2502        \u2502   reconnects=61,               \u2502                                  \u2502\n\u2502 \u2502        \u2502   last_attempt=32465.34247708, \u2502                                  \u2502\n\u2502 \u2502        \u2502   did_connect=False,           \u2502                                  \u2502\n\u2502 \u2502        \u2502   discovered=False,            \u2502                                  \u2502\n\u2502 \u2502        \u2502   tls_name=None,               \u2502                                  \u2502\n\u2502 \u2502        \u2502   server_version=None          \u2502                                  \u2502\n\u2502 \u2502        )                                \u2502                                  \u2502\n\u2502 \u2502 self = &amp;lt;nats client v2.12.0&amp;gt;            \u2502                                  \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                                  \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nNoServersError: nats: no servers available for connection\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API POST /flows&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8123 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8123\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service api_gateway on port 8138 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service esb_central on port 8188 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  esb_central started on localhost:8188\nINFO     pac0.shared.test.service.base:base.py:135 Starting service controle_formats on port 8026 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  controle_formats started on localhost:8026\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8138 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nWARNING  pac0.shared.test.service.base:base.py:179 Service didn&amp;#x27;t terminate gracefully, killing...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_api_gateway&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_api_gateway&#34;, &#34;duration&#34;: &#34;00:00:01&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marragearr\u00eat_service_api_gateway&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:01&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8060/healthcheck\ncccccc All connection attempts failed\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:8019 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8060\n    server   Documentation at http://0.0.0.0:8060/docs\n \n             Logs:\n \n_check_http_health http://localhost:8060/healthcheck\n      INFO   127.0.0.1:42126 - &amp;quot;GET /healthcheck HTTP/1.1&amp;quot; 200\n\n----------------------------- Captured stderr call -----------------------------\n[80791] 2026/01/13 17:55:09.270900 [INF] Starting nats-server\n[80791] 2026/01/13 17:55:09.271049 [INF]   Version:  2.12.3\n[80791] 2026/01/13 17:55:09.271058 [INF]   Git:      [450a519]\n[80791] 2026/01/13 17:55:09.271065 [INF]   Name:     NDNBWPDVFBBLZCL2OUJHTXP2NNX4MVXTNKIOOCDM435ZTHFUVGBKTTYM\n[80791] 2026/01/13 17:55:09.271088 [INF]   ID:       NDNBWPDVFBBLZCL2OUJHTXP2NNX4MVXTNKIOOCDM435ZTHFUVGBKTTYM\n[80791] 2026/01/13 17:55:09.271988 [INF] Listening for client connections on 0.0.0.0:8019\n[80791] 2026/01/13 17:55:09.272538 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n      INFO   Started server process [80804]\n      INFO   Waiting for application startup.\n      INFO   Application startup complete.\n      INFO   Uvicorn running on http://0.0.0.0:8060 (Press CTRL+C to quit)\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je lance le service &amp;quot;02-esb-central&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je lance le service &amp;quot;02-esb-central&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service None on port 8019 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready None ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  None started on localhost:8019\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;01-api-gateway&amp;quot; n\\&amp;#x27;est pas pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;01-api-gateway&amp;quot; n\\&amp;#x27;est pas pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je lance le service &amp;quot;01-api-gateway&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je lance le service &amp;quot;01-api-gateway&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nINFO     pac0.shared.test.service.base:base.py:135 Starting service api_gateway on port 8060 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8060 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8060 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.complete return_value=&amp;lt;httpcore._backends.anyio.AnyIOStream object at 0x7d037ac50050&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_headers.complete\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 send_request_body.complete\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_headers.complete return_value=(b&amp;#x27;HTTP/1.1&amp;#x27;, 200, b&amp;#x27;OK&amp;#x27;, [(b&amp;#x27;date&amp;#x27;, b&amp;#x27;Tue, 13 Jan 2026 16:55:09 GMT&amp;#x27;), (b&amp;#x27;server&amp;#x27;, b&amp;#x27;uvicorn&amp;#x27;), (b&amp;#x27;content-length&amp;#x27;, b&amp;#x27;28&amp;#x27;), (b&amp;#x27;content-type&amp;#x27;, b&amp;#x27;application/json&amp;#x27;)])\nINFO     httpx:_client.py:1740 HTTP Request: GET http://localhost:8060/healthcheck &amp;quot;HTTP/1.1 200 OK&amp;quot;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.started request=&amp;lt;Request [b&amp;#x27;GET&amp;#x27;]&amp;gt;\nDEBUG    httpcore.http11:_trace.py:87 receive_response_body.complete\nDEBUG    httpcore.http11:_trace.py:87 response_closed.started\nDEBUG    httpcore.http11:_trace.py:87 response_closed.complete\nDEBUG    httpcore.connection:_trace.py:87 close.started\nDEBUG    httpcore.connection:_trace.py:87 close.complete\nINFO     pac0.shared.test.service.base:base.py:161 Service  api_gateway started on localhost:8060\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;01-api-gateway&amp;quot; est pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;01-api-gateway&amp;quot; est pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n--------------------------- Captured stderr teardown ---------------------------\n      INFO   Shutting down\n      INFO   Waiting for application shutdown.\n      INFO   Application shutdown complete.\n      INFO   Finished server process [80804]\n[80791] 2026/01/13 17:55:10.517182 [INF] Trapped &amp;quot;terminated&amp;quot; signal\n[80791] 2026/01/13 17:55:10.517440 [INF] Initiating Shutdown...\n[80791] 2026/01/13 17:55:10.517576 [INF] Server Exiting..\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...&#34;}], &#34;test_scenario.py::test_contr\u00f4le_sha256&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_contr\u00f4le_sha256&#34;, &#34;duration&#34;: &#34;00:00:40&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_contr\u00f4le_sha256&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:40&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_contr\u00f4le_sha256&amp;gt;&amp;gt;, argname = &amp;#x27;world1&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:743: in pytest_fixture_setup\n    hook_result = yield\n                  ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:313: in _asyncgen_fixture_wrapper\n    result = runner.run(setup(), context=context)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:118: in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/base_events.py:725: in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:309: in setup\n    res = await gen_obj.__anext__()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n../pac0/src/pac0/shared/test/world.py:338: in world1\n    await world.pa_new()\n../pac0/src/pac0/shared/test/world.py:71: in pa_new\n    await asyncio.gather(*tasks)\n../pac0/src/pac0/shared/test/service/pac.py:58: in __aenter__\n    await asyncio.gather(*[s.__aenter__() for s in self._services()])\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = &amp;lt;pac0.shared.test.service.fastapi.FastApiServiceContext object at 0x7d0379d80640&amp;gt;\n\n    async def __aenter__(self) -&amp;gt; Self:\n        &amp;quot;&amp;quot;&amp;quot;Start the service subprocess.&amp;quot;&amp;quot;&amp;quot;\n        if self.config.port == 0:\n            self.config.port = find_available_port(start_port=8000)\n        logger.info(\n            f&amp;quot;Starting service {self.config.name} on port {self.config.port} : {&amp;#x27; &amp;#x27;.join(self.config.command)}&amp;quot;\n        )\n        env = os.environ.copy()\n        env[&amp;quot;PORT&amp;quot;] = str(self.config.port)\n        if self.config.env_var_extra:\n            env.update(self.config.env_var_extra)\n        command = [c.format(**env) for c in self.config.command]\n    \n        self._process = subprocess.Popen(\n            command,\n            # stdout=subprocess.PIPE,  # self.config.stdout,\n            # stderr=subprocess.PIPE,  # self.config.stderr,\n            text=True,\n            env=env,\n            cwd=PACKAGE_BASE_FOLDER,\n        )\n    \n        # Wait for service to be ready\n        self.is_ready = await self.wait_for_ready(self.config.startup_timeout)\n        if not self.is_ready:\n            await self._terminate()\n&amp;gt;           raise TimeoutError(\n                f&amp;quot;Service {self.config.name} failed to start within {self.config.startup_timeout}s&amp;quot;\n            )\nE           TimeoutError: Service api_gateway failed to start within 30.0s\n\n../pac0/src/pac0/shared/test/service/base.py:157: TimeoutError\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:4222 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8196\n    server   Documentation at http://0.0.0.0:8196/docs\n \n             Logs:\n \n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8196/healthcheck\ncccccc All connection attempts failed\nsetup pac0 service ...\n\n----------------------------- Captured stderr call -----------------------------\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[80819] 2026/01/13 17:55:10.563304 [INF] Starting nats-server\n[80819] 2026/01/13 17:55:10.563389 [INF]   Version:  2.12.3\n[80819] 2026/01/13 17:55:10.563394 [INF]   Git:      [450a519]\n[80819] 2026/01/13 17:55:10.563398 [INF]   Name:     NCVCDKAG43W5YCZGPXWSE4DCPKQVXCXCXBACGLNWDXXMNCPGRZ6ESNC7\n[80819] 2026/01/13 17:55:10.563408 [INF]   ID:       NCVCDKAG43W5YCZGPXWSE4DCPKQVXCXCXBACGLNWDXXMNCPGRZ6ESNC7\n[80819] 2026/01/13 17:55:10.564211 [INF] Listening for client connections on 0.0.0.0:8086\n[80819] 2026/01/13 17:55:10.564661 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n2026-01-13 17:55:11,077 INFO     - FastStream app starting...\n      INFO   Started server process [80833]\n      INFO   Waiting for application startup.\n     ERROR   Traceback (most recent call last):                                 \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/starlette/routing.py&amp;quot;, line 694, in lifespan    \n                 async with self.lifespan_context(app) as maybe_state:          \n                            ~~~~~~~~~~~~~~~~~~~~~^^^^^                          \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/fastapi/routing.py&amp;quot;, line 200, in               \n             merged_lifespan                                                    \n                 async with original_context(app) as maybe_original_state:      \n                            ~~~~~~~~~~~~~~~~^^^^^                               \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/fastapi/routing.py&amp;quot;, line 201, in               \n             merged_lifespan                                                    \n                 async with nested_context(app) as maybe_nested_state:          \n                            ~~~~~~~~~~~~~~^^^^^                                 \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/fastapi/router.py&amp;quot;, line   \n             290, in start_broker_lifespan                                      \n                 await self._start_broker()                                     \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/application.py&amp;quot;, line 98,  \n             in _start_broker                                                   \n                 await b.start()                                                \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/nats/broker/broker.py&amp;quot;, line 462, in \n             start                                                              \n                 await self.connect()                                           \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/broker/broker.py&amp;quot;, line    \n             111, in connect                                                    \n                 self._connection = await self._connect()                       \n                                    ^^^^^^^^^^^^^^^^^^^^^                       \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/nats/broker/broker.py&amp;quot;, line 427, in \n             _connect                                                           \n                 connection = await nats.connect(**self._connection_kwargs)     \n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^     \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/__init__.py&amp;quot;, line 46, in connect          \n                 await nc.connect(servers, **options)                           \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 547, in connect       \n                 raise e                                                        \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 535, in connect       \n                 await self._select_next_server()                               \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 1365, in              \n             _select_next_server                                                \n                 raise errors.NoServersError                                    \n             nats.errors.NoServersError: nats: no servers available for         \n             connection\n     ERROR   Application startup failed. Exiting.\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/cli/main.py:213 in run                         \u2502\n\u2502                                                                              \u2502\n\u2502   210 \u2502   \u2502   \u2502   raise typer.BadParameter(msg)                              \u2502\n\u2502   211 \u2502                                                                      \u2502\n\u2502   212 \u2502   else:                                                              \u2502\n\u2502 \u2771 213 \u2502   \u2502   _run_imported_app(app_obj, args=run_args)                      \u2502\n\u2502   214                                                                        \u2502\n\u2502   215                                                                        \u2502\n\u2502   216 def _run(args: RunArgs) -&amp;gt; None:                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502              app = &amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;         \u2502 \u2502\n\u2502 \u2502          app_dir = &amp;#x27;.&amp;#x27;                                                   \u2502 \u2502\n\u2502 \u2502          app_obj = &amp;lt;faststream.app.FastStream object at 0x7cf19e50e120&amp;gt;  \u2502 \u2502\n\u2502 \u2502 casted_log_level = 0                                                     \u2502 \u2502\n\u2502 \u2502              ctx = &amp;lt;click.core.Context object at 0x7cf19e7e5950&amp;gt;         \u2502 \u2502\n\u2502 \u2502            extra = {&amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;}                                      \u2502 \u2502\n\u2502 \u2502       is_factory = False                                                 \u2502 \u2502\n\u2502 \u2502       log_config = None                                                  \u2502 \u2502\n\u2502 \u2502        log_level = &amp;lt;LogLevels.notset: &amp;#x27;notset&amp;#x27;&amp;gt;                          \u2502 \u2502\n\u2502 \u2502             loop = &amp;#x27;auto&amp;#x27;                                                \u2502 \u2502\n\u2502 \u2502      module_path = PosixPath(&amp;#x27;/home/philippe/src/PA_Communautaire/packa\u2026 \u2502 \u2502\n\u2502 \u2502           reload = False                                                 \u2502 \u2502\n\u2502 \u2502         run_args = RunArgs(                                              \u2502 \u2502\n\u2502 \u2502                    \u2502                                                     \u2502 \u2502\n\u2502 \u2502                    app=&amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;,    \u2502 \u2502\n\u2502 \u2502                    \u2502   extra_options={                                   \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   &amp;#x27;worker_id&amp;#x27;: None,                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   &amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;                                \u2502 \u2502\n\u2502 \u2502                    \u2502   },                                                \u2502 \u2502\n\u2502 \u2502                    \u2502   is_factory=False,                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   log_config=None,                                  \u2502 \u2502\n\u2502 \u2502                    \u2502   log_level=0,                                      \u2502 \u2502\n\u2502 \u2502                    \u2502   app_level=20,                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   loop=&amp;#x27;auto&amp;#x27;                                       \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502 watch_extensions = []                                                    \u2502 \u2502\n\u2502 \u2502          workers = 1                                                     \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/cli/main.py:248 in _run_imported_app           \u2502\n\u2502                                                                              \u2502\n\u2502   245 \u2502   \u2502   \u2502   backend_options[&amp;quot;loop_factory&amp;quot;] = uvloop.new_event_loop    \u2502\n\u2502   246 \u2502                                                                      \u2502\n\u2502   247 \u2502   try:                                                               \u2502\n\u2502 \u2771 248 \u2502   \u2502   anyio.run(                                                     \u2502\n\u2502   249 \u2502   \u2502   \u2502   app_obj.run,                                               \u2502\n\u2502   250 \u2502   \u2502   \u2502   args.app_level,                                            \u2502\n\u2502   251 \u2502   \u2502   \u2502   args.extra_options,                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         app_obj = &amp;lt;faststream.app.FastStream object at 0x7cf19e50e120&amp;gt;   \u2502 \u2502\n\u2502 \u2502            args = RunArgs(                                               \u2502 \u2502\n\u2502 \u2502                   \u2502   app=&amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;, \u2502 \u2502\n\u2502 \u2502                   \u2502   extra_options={                                    \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   &amp;#x27;worker_id&amp;#x27;: None,                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   &amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;                                 \u2502 \u2502\n\u2502 \u2502                   \u2502   },                                                 \u2502 \u2502\n\u2502 \u2502                   \u2502   is_factory=False,                                  \u2502 \u2502\n\u2502 \u2502                   \u2502   log_config=None,                                   \u2502 \u2502\n\u2502 \u2502                   \u2502   log_level=0,                                       \u2502 \u2502\n\u2502 \u2502                   \u2502   app_level=20,                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   loop=&amp;#x27;auto&amp;#x27;                                        \u2502 \u2502\n\u2502 \u2502                   )                                                      \u2502 \u2502\n\u2502 \u2502 backend_options = {                                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   &amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at        \u2502 \u2502\n\u2502 \u2502                   0x7cf19e682520&amp;gt;                                        \u2502 \u2502\n\u2502 \u2502                   }                                                      \u2502 \u2502\n\u2502 \u2502          uvloop = &amp;lt;module &amp;#x27;uvloop&amp;#x27; from                                  \u2502 \u2502\n\u2502 \u2502                   &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/.v\u2026 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_core/_eventloop.py:75 in run                                 \u2502\n\u2502                                                                              \u2502\n\u2502    72 \u2502                                                                      \u2502\n\u2502    73 \u2502   try:                                                               \u2502\n\u2502    74 \u2502   \u2502   backend_options = backend_options or {}                        \u2502\n\u2502 \u2771  75 \u2502   \u2502   return async_backend.run(func, args, {}, backend_options)      \u2502\n\u2502    76 \u2502   finally:                                                           \u2502\n\u2502    77 \u2502   \u2502   reset_current_async_library(token)                             \u2502\n\u2502    78                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502            args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;})              \u2502 \u2502\n\u2502 \u2502   asynclib_name = None                                                   \u2502 \u2502\n\u2502 \u2502         backend = &amp;#x27;asyncio&amp;#x27;                                              \u2502 \u2502\n\u2502 \u2502 backend_options = {                                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   &amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at        \u2502 \u2502\n\u2502 \u2502                   0x7cf19e682520&amp;gt;                                        \u2502 \u2502\n\u2502 \u2502                   }                                                      \u2502 \u2502\n\u2502 \u2502            func = &amp;lt;bound method FastStream.run of                        \u2502 \u2502\n\u2502 \u2502                   &amp;lt;faststream.app.FastStream object at 0x7cf19e50e120&amp;gt;&amp;gt;  \u2502 \u2502\n\u2502 \u2502           token = None                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_backends/_asyncio.py:2365 in run                             \u2502\n\u2502                                                                              \u2502\n\u2502   2362 \u2502   \u2502   \u2502   \u2502   loop_factory = winloop.new_event_loop                 \u2502\n\u2502   2363 \u2502   \u2502                                                                 \u2502\n\u2502   2364 \u2502   \u2502   with Runner(debug=debug, loop_factory=loop_factory) as runner \u2502\n\u2502 \u2771 2365 \u2502   \u2502   \u2502   return runner.run(wrapper())                              \u2502\n\u2502   2366 \u2502                                                                     \u2502\n\u2502   2367 \u2502   @classmethod                                                      \u2502\n\u2502   2368 \u2502   def current_token(cls) -&amp;gt; object:                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502    args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;})                      \u2502 \u2502\n\u2502 \u2502   debug = None                                                           \u2502 \u2502\n\u2502 \u2502    func = &amp;lt;bound method FastStream.run of &amp;lt;faststream.app.FastStream     \u2502 \u2502\n\u2502 \u2502           object at 0x7cf19e50e120&amp;gt;&amp;gt;                                     \u2502 \u2502\n\u2502 \u2502  kwargs = {}                                                             \u2502 \u2502\n\u2502 \u2502 options = {&amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at 0x7cf19e682520&amp;gt;}  \u2502 \u2502\n\u2502 \u2502  runner = &amp;lt;asyncio.runners.Runner object at 0x7cf19e50ea50&amp;gt;              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/py \u2502\n\u2502 thon3.13/asyncio/runners.py:118 in run                                       \u2502\n\u2502                                                                              \u2502\n\u2502   115 \u2502   \u2502                                                                  \u2502\n\u2502   116 \u2502   \u2502   self._interrupt_count = 0                                      \u2502\n\u2502   117 \u2502   \u2502   try:                                                           \u2502\n\u2502 \u2771 118 \u2502   \u2502   \u2502   return self._loop.run_until_complete(task)                 \u2502\n\u2502   119 \u2502   \u2502   except exceptions.CancelledError:                              \u2502\n\u2502   120 \u2502   \u2502   \u2502   if self._interrupt_count &amp;gt; 0:                              \u2502\n\u2502   121 \u2502   \u2502   \u2502   \u2502   uncancel = getattr(task, &amp;quot;uncancel&amp;quot;, None)             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        context = &amp;lt;_contextvars.Context object at 0x7cf19e1b1380&amp;gt;         \u2502 \u2502\n\u2502 \u2502           coro = &amp;lt;coroutine object FastStream.run at 0x7cf19e19b4c0&amp;gt;     \u2502 \u2502\n\u2502 \u2502           self = &amp;lt;asyncio.runners.Runner object at 0x7cf19e50ea50&amp;gt;       \u2502 \u2502\n\u2502 \u2502 sigint_handler = functools.partial(&amp;lt;bound method Runner._on_sigint of    \u2502 \u2502\n\u2502 \u2502                  &amp;lt;asyncio.runners.Runner object at 0x7cf19e50ea50&amp;gt;&amp;gt;,     \u2502 \u2502\n\u2502 \u2502                  main_task=&amp;lt;Task finished                                \u2502 \u2502\n\u2502 \u2502                  name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;                    \u2502 \u2502\n\u2502 \u2502                  coro=&amp;lt;FastStream.run() done, defined at                 \u2502 \u2502\n\u2502 \u2502                  /home/philippe/src/PA_Communautaire/packages/pac0/.ven\u2026 \u2502 \u2502\n\u2502 \u2502                  exception=NoServersError()&amp;gt;)                            \u2502 \u2502\n\u2502 \u2502           task = &amp;lt;Task finished name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;     \u2502 \u2502\n\u2502 \u2502                  coro=&amp;lt;FastStream.run() done, defined at                 \u2502 \u2502\n\u2502 \u2502                  /home/philippe/src/PA_Communautaire/packages/pac0/.ven\u2026 \u2502 \u2502\n\u2502 \u2502                  exception=NoServersError()&amp;gt;                             \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 in uvloop.loop.Loop.run_until_complete:1518                                  \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_backends/_asyncio.py:2348 in wrapper                         \u2502\n\u2502                                                                              \u2502\n\u2502   2345 \u2502   \u2502   \u2502   _task_states[task] = TaskState(None, None)                \u2502\n\u2502   2346 \u2502   \u2502   \u2502                                                             \u2502\n\u2502   2347 \u2502   \u2502   \u2502   try:                                                      \u2502\n\u2502 \u2771 2348 \u2502   \u2502   \u2502   \u2502   return await func(*args)                              \u2502\n\u2502   2349 \u2502   \u2502   \u2502   finally:                                                  \u2502\n\u2502   2350 \u2502   \u2502   \u2502   \u2502   del _task_states[task]                                \u2502\n\u2502   2351                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;})                         \u2502 \u2502\n\u2502 \u2502 func = &amp;lt;bound method FastStream.run of &amp;lt;faststream.app.FastStream object \u2502 \u2502\n\u2502 \u2502        at 0x7cf19e50e120&amp;gt;&amp;gt;                                               \u2502 \u2502\n\u2502 \u2502 task = &amp;lt;Task finished name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;               \u2502 \u2502\n\u2502 \u2502        coro=&amp;lt;FastStream.run() done, defined at                           \u2502 \u2502\n\u2502 \u2502        /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/pyth\u2026 \u2502 \u2502\n\u2502 \u2502        exception=NoServersError()&amp;gt;                                       \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/app.py:100 in run                                        \u2502\n\u2502                                                                              \u2502\n\u2502    97 \u2502   \u2502   \u2502   \u2502   \u2502   tg.cancel_scope.cancel()                           \u2502\n\u2502    98 \u2502   \u2502   \u2502   except ExceptionGroup as e:                                \u2502\n\u2502    99 \u2502   \u2502   \u2502   \u2502   for ex in e.exceptions:                                \u2502\n\u2502 \u2771 100 \u2502   \u2502   \u2502   \u2502   \u2502   raise ex from None                                 \u2502\n\u2502   101 \u2502                                                                      \u2502\n\u2502   102 \u2502   def exit(self) -&amp;gt; None:                                            \u2502\n\u2502   103 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Stop application manually.&amp;quot;&amp;quot;&amp;quot;                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502                ex = NoServersError()                                     \u2502 \u2502\n\u2502 \u2502         log_level = 20                                                   \u2502 \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7cf19e50e120&amp;gt; \u2502 \u2502\n\u2502 \u2502        sleep_time = 0.1                                                  \u2502 \u2502\n\u2502 \u2502                tg = &amp;lt;anyio._backends._asyncio.TaskGroup object at        \u2502 \u2502\n\u2502 \u2502                     0x7cf19e50f4d0&amp;gt;                                      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:205 in _startup                 \u2502\n\u2502                                                                              \u2502\n\u2502   202 \u2502   ) -&amp;gt; None:                                                         \u2502\n\u2502   203 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Private method calls `start` with logging.&amp;quot;&amp;quot;&amp;quot;               \u2502\n\u2502   204 \u2502   \u2502   async with self._startup_logging(log_level=log_level):         \u2502\n\u2502 \u2771 205 \u2502   \u2502   \u2502   await self.start(**(run_extra_options or {}))              \u2502\n\u2502   206 \u2502   \u2502                                                                  \u2502\n\u2502   207 \u2502   \u2502   self.running = True                                            \u2502\n\u2502   208                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         log_level = 20                                                   \u2502 \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7cf19e50e120&amp;gt; \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:215 in start                    \u2502\n\u2502                                                                              \u2502\n\u2502   212 \u2502   ) -&amp;gt; None:                                                         \u2502\n\u2502   213 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Executes startup hooks and start broker.&amp;quot;&amp;quot;&amp;quot;                 \u2502\n\u2502   214 \u2502   \u2502   async with self._start_hooks_context(**run_extra_options):     \u2502\n\u2502 \u2771 215 \u2502   \u2502   \u2502   await self._start_broker()                                 \u2502\n\u2502   216 \u2502                                                                      \u2502\n\u2502   217 \u2502   @asynccontextmanager                                               \u2502\n\u2502   218 \u2502   async def _start_hooks_context(                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8089&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7cf19e50e120&amp;gt; \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:98 in _start_broker             \u2502\n\u2502                                                                              \u2502\n\u2502    95 \u2502   async def _start_broker(self) -&amp;gt; None:                             \u2502\n\u2502    96 \u2502   \u2502   assert self.brokers, &amp;quot;You should setup a broker&amp;quot;               \u2502\n\u2502    97 \u2502   \u2502   for b in self.brokers:                                         \u2502\n\u2502 \u2771  98 \u2502   \u2502   \u2502   await b.start()                                            \u2502\n\u2502    99 \u2502                                                                      \u2502\n\u2502   100 \u2502   @property                                                          \u2502\n\u2502   101 \u2502   def broker(self) -&amp;gt; Optional[&amp;quot;BrokerUsecase[Any, Any]&amp;quot;]:           \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502    b = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7cf19e50d940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2502 self = &amp;lt;faststream.app.FastStream object at 0x7cf19e50e120&amp;gt;              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/nats/broker/broker.py:462 in start                       \u2502\n\u2502                                                                              \u2502\n\u2502   459 \u2502                                                                      \u2502\n\u2502   460 \u2502   async def start(self) -&amp;gt; None:                                     \u2502\n\u2502   461 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Connect broker to NATS cluster and startup all subscribers. \u2502\n\u2502 \u2771 462 \u2502   \u2502   await self.connect()                                           \u2502\n\u2502   463 \u2502   \u2502                                                                  \u2502\n\u2502   464 \u2502   \u2502   stream_context = self.config.connection_state.stream           \u2502\n\u2502   465                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7cf19e50d940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/broker/broker.py:111 in connect                \u2502\n\u2502                                                                              \u2502\n\u2502   108 \u2502   async def connect(self) -&amp;gt; ConnectionType:                         \u2502\n\u2502   109 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Connect to a remote server.&amp;quot;&amp;quot;&amp;quot;                              \u2502\n\u2502   110 \u2502   \u2502   if self._connection is None:                                   \u2502\n\u2502 \u2771 111 \u2502   \u2502   \u2502   self._connection = await self._connect()                   \u2502\n\u2502   112 \u2502   \u2502   \u2502   self._setup_logger()                                       \u2502\n\u2502   113 \u2502   \u2502                                                                  \u2502\n\u2502   114 \u2502   \u2502   return self._connection                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7cf19e50d940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/nats/broker/broker.py:427 in _connect                    \u2502\n\u2502                                                                              \u2502\n\u2502   424 \u2502   \u2502   )                                                              \u2502\n\u2502   425 \u2502                                                                      \u2502\n\u2502   426 \u2502   async def _connect(self) -&amp;gt; &amp;quot;Client&amp;quot;:                              \u2502\n\u2502 \u2771 427 \u2502   \u2502   connection = await nats.connect(**self._connection_kwargs)     \u2502\n\u2502   428 \u2502   \u2502   self.config.connect(connection)                                \u2502\n\u2502   429 \u2502   \u2502   return connection                                              \u2502\n\u2502   430                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7cf19e50d940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/__init__.py:46 in connect                                      \u2502\n\u2502                                                                              \u2502\n\u2502   43 \u2502                                                                       \u2502\n\u2502   44 \u2502   &amp;quot;&amp;quot;&amp;quot;                                                                 \u2502\n\u2502   45 \u2502   nc = NATS()                                                         \u2502\n\u2502 \u2771 46 \u2502   await nc.connect(servers, **options)                                \u2502\n\u2502   47 \u2502   return nc                                                           \u2502\n\u2502   48                                                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                              \u2502\n\u2502 \u2502      nc = &amp;lt;nats client v2.12.0&amp;gt;             \u2502                              \u2502\n\u2502 \u2502 options = {                                 \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;name&amp;#x27;: &amp;#x27;faststream-0.6.4&amp;#x27;,   \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;verbose&amp;#x27;: False,             \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;allow_reconnect&amp;#x27;: True,      \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;reconnect_time_wait&amp;#x27;: 2,     \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;max_reconnect_attempts&amp;#x27;: 60, \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;no_echo&amp;#x27;: False,             \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;pedantic&amp;#x27;: False,            \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;inbox_prefix&amp;#x27;: b&amp;#x27;_INBOX&amp;#x27;,    \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;pending_size&amp;#x27;: 2097152,      \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;connect_timeout&amp;#x27;: 2,         \u2502                              \u2502\n\u2502 \u2502           \u2502   ... +18                       \u2502                              \u2502\n\u2502 \u2502           }                                 \u2502                              \u2502\n\u2502 \u2502 servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502                              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                              \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:547 in connect                                   \u2502\n\u2502                                                                              \u2502\n\u2502    544 \u2502   \u2502   \u2502   \u2502   \u2502   # Never stop reconnecting                         \u2502\n\u2502    545 \u2502   \u2502   \u2502   \u2502   \u2502   continue                                          \u2502\n\u2502    546 \u2502   \u2502   \u2502   \u2502   self._err = e                                         \u2502\n\u2502 \u2771  547 \u2502   \u2502   \u2502   \u2502   raise e                                               \u2502\n\u2502    548 \u2502   \u2502   \u2502   except (OSError, errors.Error, asyncio.TimeoutError) as e \u2502\n\u2502    549 \u2502   \u2502   \u2502   \u2502   self._err = e                                         \u2502\n\u2502    550 \u2502   \u2502   \u2502   \u2502   await self._error_cb(e)                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502        allow_reconnect = True                              \u2502               \u2502\n\u2502 \u2502                     cb = None                              \u2502               \u2502\n\u2502 \u2502              closed_cb = None                              \u2502               \u2502\n\u2502 \u2502        connect_timeout = 2                                 \u2502               \u2502\n\u2502 \u2502        disconnected_cb = None                              \u2502               \u2502\n\u2502 \u2502   discovered_server_cb = None                              \u2502               \u2502\n\u2502 \u2502         dont_randomize = False                             \u2502               \u2502\n\u2502 \u2502          drain_timeout = 30                                \u2502               \u2502\n\u2502 \u2502          flush_timeout = None                              \u2502               \u2502\n\u2502 \u2502     flusher_queue_size = 1024                              \u2502               \u2502\n\u2502 \u2502           inbox_prefix = b&amp;#x27;_INBOX&amp;#x27;                         \u2502               \u2502\n\u2502 \u2502  max_outstanding_pings = 2                                 \u2502               \u2502\n\u2502 \u2502 max_reconnect_attempts = 60                                \u2502               \u2502\n\u2502 \u2502                   name = &amp;#x27;faststream-0.6.4&amp;#x27;                \u2502               \u2502\n\u2502 \u2502             nkeys_seed = None                              \u2502               \u2502\n\u2502 \u2502         nkeys_seed_str = None                              \u2502               \u2502\n\u2502 \u2502                no_echo = False                             \u2502               \u2502\n\u2502 \u2502               password = None                              \u2502               \u2502\n\u2502 \u2502               pedantic = False                             \u2502               \u2502\n\u2502 \u2502           pending_size = 2097152                           \u2502               \u2502\n\u2502 \u2502          ping_interval = 120                               \u2502               \u2502\n\u2502 \u2502    reconnect_time_wait = 2                                 \u2502               \u2502\n\u2502 \u2502                   self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502               \u2502\n\u2502 \u2502                 server = Srv(                              \u2502               \u2502\n\u2502 \u2502                          \u2502   uri=ParseResult(              \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502               \u2502\n\u2502 \u2502                          \u2502   ),                            \u2502               \u2502\n\u2502 \u2502                          \u2502   reconnects=61,                \u2502               \u2502\n\u2502 \u2502                          \u2502   last_attempt=32506.038029579, \u2502               \u2502\n\u2502 \u2502                          \u2502   did_connect=False,            \u2502               \u2502\n\u2502 \u2502                          \u2502   discovered=False,             \u2502               \u2502\n\u2502 \u2502                          \u2502   tls_name=None,                \u2502               \u2502\n\u2502 \u2502                          \u2502   server_version=None           \u2502               \u2502\n\u2502 \u2502                          )                                 \u2502               \u2502\n\u2502 \u2502 server_auth_configured = False                             \u2502               \u2502\n\u2502 \u2502                servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502               \u2502\n\u2502 \u2502           signature_cb = None                              \u2502               \u2502\n\u2502 \u2502                    tls = None                              \u2502               \u2502\n\u2502 \u2502    tls_handshake_first = False                             \u2502               \u2502\n\u2502 \u2502           tls_hostname = None                              \u2502               \u2502\n\u2502 \u2502                  token = None                              \u2502               \u2502\n\u2502 \u2502                   user = None                              \u2502               \u2502\n\u2502 \u2502       user_credentials = None                              \u2502               \u2502\n\u2502 \u2502            user_jwt_cb = None                              \u2502               \u2502\n\u2502 \u2502                verbose = False                             \u2502               \u2502\n\u2502 \u2502  ws_connection_headers = None                              \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:535 in connect                                   \u2502\n\u2502                                                                              \u2502\n\u2502    532 \u2502   \u2502                                                                 \u2502\n\u2502    533 \u2502   \u2502   while True:                                                   \u2502\n\u2502    534 \u2502   \u2502   \u2502   try:                                                      \u2502\n\u2502 \u2771  535 \u2502   \u2502   \u2502   \u2502   await self._select_next_server()                      \u2502\n\u2502    536 \u2502   \u2502   \u2502   \u2502   await self._process_connect_init()                    \u2502\n\u2502    537 \u2502   \u2502   \u2502   \u2502   assert (                                              \u2502\n\u2502    538 \u2502   \u2502   \u2502   \u2502   \u2502   self._current_server                              \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502        allow_reconnect = True                              \u2502               \u2502\n\u2502 \u2502                     cb = None                              \u2502               \u2502\n\u2502 \u2502              closed_cb = None                              \u2502               \u2502\n\u2502 \u2502        connect_timeout = 2                                 \u2502               \u2502\n\u2502 \u2502        disconnected_cb = None                              \u2502               \u2502\n\u2502 \u2502   discovered_server_cb = None                              \u2502               \u2502\n\u2502 \u2502         dont_randomize = False                             \u2502               \u2502\n\u2502 \u2502          drain_timeout = 30                                \u2502               \u2502\n\u2502 \u2502          flush_timeout = None                              \u2502               \u2502\n\u2502 \u2502     flusher_queue_size = 1024                              \u2502               \u2502\n\u2502 \u2502           inbox_prefix = b&amp;#x27;_INBOX&amp;#x27;                         \u2502               \u2502\n\u2502 \u2502  max_outstanding_pings = 2                                 \u2502               \u2502\n\u2502 \u2502 max_reconnect_attempts = 60                                \u2502               \u2502\n\u2502 \u2502                   name = &amp;#x27;faststream-0.6.4&amp;#x27;                \u2502               \u2502\n\u2502 \u2502             nkeys_seed = None                              \u2502               \u2502\n\u2502 \u2502         nkeys_seed_str = None                              \u2502               \u2502\n\u2502 \u2502                no_echo = False                             \u2502               \u2502\n\u2502 \u2502               password = None                              \u2502               \u2502\n\u2502 \u2502               pedantic = False                             \u2502               \u2502\n\u2502 \u2502           pending_size = 2097152                           \u2502               \u2502\n\u2502 \u2502          ping_interval = 120                               \u2502               \u2502\n\u2502 \u2502    reconnect_time_wait = 2                                 \u2502               \u2502\n\u2502 \u2502                   self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502               \u2502\n\u2502 \u2502                 server = Srv(                              \u2502               \u2502\n\u2502 \u2502                          \u2502   uri=ParseResult(              \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502               \u2502\n\u2502 \u2502                          \u2502   ),                            \u2502               \u2502\n\u2502 \u2502                          \u2502   reconnects=61,                \u2502               \u2502\n\u2502 \u2502                          \u2502   last_attempt=32506.038029579, \u2502               \u2502\n\u2502 \u2502                          \u2502   did_connect=False,            \u2502               \u2502\n\u2502 \u2502                          \u2502   discovered=False,             \u2502               \u2502\n\u2502 \u2502                          \u2502   tls_name=None,                \u2502               \u2502\n\u2502 \u2502                          \u2502   server_version=None           \u2502               \u2502\n\u2502 \u2502                          )                                 \u2502               \u2502\n\u2502 \u2502 server_auth_configured = False                             \u2502               \u2502\n\u2502 \u2502                servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502               \u2502\n\u2502 \u2502           signature_cb = None                              \u2502               \u2502\n\u2502 \u2502                    tls = None                              \u2502               \u2502\n\u2502 \u2502    tls_handshake_first = False                             \u2502               \u2502\n\u2502 \u2502           tls_hostname = None                              \u2502               \u2502\n\u2502 \u2502                  token = None                              \u2502               \u2502\n\u2502 \u2502                   user = None                              \u2502               \u2502\n\u2502 \u2502       user_credentials = None                              \u2502               \u2502\n\u2502 \u2502            user_jwt_cb = None                              \u2502               \u2502\n\u2502 \u2502                verbose = False                             \u2502               \u2502\n\u2502 \u2502  ws_connection_headers = None                              \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:1365 in _select_next_server                      \u2502\n\u2502                                                                              \u2502\n\u2502   1362 \u2502   \u2502   while True:                                                   \u2502\n\u2502   1363 \u2502   \u2502   \u2502   if len(self._server_pool) == 0:                           \u2502\n\u2502   1364 \u2502   \u2502   \u2502   \u2502   self._current_server = None                           \u2502\n\u2502 \u2771 1365 \u2502   \u2502   \u2502   \u2502   raise errors.NoServersError                           \u2502\n\u2502   1366 \u2502   \u2502   \u2502                                                             \u2502\n\u2502   1367 \u2502   \u2502   \u2502   now = time.monotonic()                                    \u2502\n\u2502   1368 \u2502   \u2502   \u2502   s = self._server_pool.pop(0)                              \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                                 \u2502\n\u2502 \u2502  now = 32506.038046871                   \u2502                                 \u2502\n\u2502 \u2502    s = Srv(                              \u2502                                 \u2502\n\u2502 \u2502        \u2502   uri=ParseResult(              \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502                                 \u2502\n\u2502 \u2502        \u2502   ),                            \u2502                                 \u2502\n\u2502 \u2502        \u2502   reconnects=61,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   last_attempt=32506.038029579, \u2502                                 \u2502\n\u2502 \u2502        \u2502   did_connect=False,            \u2502                                 \u2502\n\u2502 \u2502        \u2502   discovered=False,             \u2502                                 \u2502\n\u2502 \u2502        \u2502   tls_name=None,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   server_version=None           \u2502                                 \u2502\n\u2502 \u2502        )                                 \u2502                                 \u2502\n\u2502 \u2502 self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502                                 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                                 \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nNoServersError: nats: no servers available for connection\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;appele l&amp;#x27;API POST /flows&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;appele l&amp;#x27;API {verb} {path}&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8198 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8198\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service api_gateway on port 8196 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service esb_central on port 8086 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  esb_central started on localhost:8086\nINFO     pac0.shared.test.service.base:base.py:135 Starting service controle_formats on port 8110 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  controle_formats started on localhost:8110\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8196 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nWARNING  pac0.shared.test.service.base:base.py:179 Service didn&amp;#x27;t terminate gracefully, killing...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_healthcheck_ok&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_healthcheck_ok&#34;, &#34;duration&#34;: &#34;00:00:40&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_healthcheck_ok&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:40&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_healthcheck_ok&amp;gt;&amp;gt;, argname = &amp;#x27;world1&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:743: in pytest_fixture_setup\n    hook_result = yield\n                  ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:313: in _asyncgen_fixture_wrapper\n    result = runner.run(setup(), context=context)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:118: in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/base_events.py:725: in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:309: in setup\n    res = await gen_obj.__anext__()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n../pac0/src/pac0/shared/test/world.py:338: in world1\n    await world.pa_new()\n../pac0/src/pac0/shared/test/world.py:71: in pa_new\n    await asyncio.gather(*tasks)\n../pac0/src/pac0/shared/test/service/pac.py:58: in __aenter__\n    await asyncio.gather(*[s.__aenter__() for s in self._services()])\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = &amp;lt;pac0.shared.test.service.fastapi.FastApiServiceContext object at 0x7d037ade67b0&amp;gt;\n\n    async def __aenter__(self) -&amp;gt; Self:\n        &amp;quot;&amp;quot;&amp;quot;Start the service subprocess.&amp;quot;&amp;quot;&amp;quot;\n        if self.config.port == 0:\n            self.config.port = find_available_port(start_port=8000)\n        logger.info(\n            f&amp;quot;Starting service {self.config.name} on port {self.config.port} : {&amp;#x27; &amp;#x27;.join(self.config.command)}&amp;quot;\n        )\n        env = os.environ.copy()\n        env[&amp;quot;PORT&amp;quot;] = str(self.config.port)\n        if self.config.env_var_extra:\n            env.update(self.config.env_var_extra)\n        command = [c.format(**env) for c in self.config.command]\n    \n        self._process = subprocess.Popen(\n            command,\n            # stdout=subprocess.PIPE,  # self.config.stdout,\n            # stderr=subprocess.PIPE,  # self.config.stderr,\n            text=True,\n            env=env,\n            cwd=PACKAGE_BASE_FOLDER,\n        )\n    \n        # Wait for service to be ready\n        self.is_ready = await self.wait_for_ready(self.config.startup_timeout)\n        if not self.is_ready:\n            await self._terminate()\n&amp;gt;           raise TimeoutError(\n                f&amp;quot;Service {self.config.name} failed to start within {self.config.startup_timeout}s&amp;quot;\n            )\nE           TimeoutError: Service api_gateway failed to start within 30.0s\n\n../pac0/src/pac0/shared/test/service/base.py:157: TimeoutError\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:4222 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8011\n    server   Documentation at http://0.0.0.0:8011/docs\n \n             Logs:\n \n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8011/healthcheck\ncccccc All connection attempts failed\nsetup pac0 service ...\n\n----------------------------- Captured stderr call -----------------------------\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[80921] 2026/01/13 17:55:51.114030 [INF] Starting nats-server\n[80921] 2026/01/13 17:55:51.114096 [INF]   Version:  2.12.3\n[80921] 2026/01/13 17:55:51.114101 [INF]   Git:      [450a519]\n[80921] 2026/01/13 17:55:51.114106 [INF]   Name:     NC3IALPVEROS35R4VWEQZOPPID42Z37SY7LKRN7BYVSHABFNP7DJOQUZ\n[80921] 2026/01/13 17:55:51.114111 [INF]   ID:       NC3IALPVEROS35R4VWEQZOPPID42Z37SY7LKRN7BYVSHABFNP7DJOQUZ\n[80921] 2026/01/13 17:55:51.114885 [INF] Listening for client connections on 0.0.0.0:8071\n[80921] 2026/01/13 17:55:51.115300 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n2026-01-13 17:55:51,558 INFO     - FastStream app starting...\n      INFO   Started server process [80933]\n      INFO   Waiting for application startup.\n     ERROR   Traceback (most recent call last):                                 \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/starlette/routing.py&amp;quot;, line 694, in lifespan    \n                 async with self.lifespan_context(app) as maybe_state:          \n                            ~~~~~~~~~~~~~~~~~~~~~^^^^^                          \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/fastapi/routing.py&amp;quot;, line 200, in               \n             merged_lifespan                                                    \n                 async with original_context(app) as maybe_original_state:      \n                            ~~~~~~~~~~~~~~~~^^^^^                               \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/fastapi/routing.py&amp;quot;, line 201, in               \n             merged_lifespan                                                    \n                 async with nested_context(app) as maybe_nested_state:          \n                            ~~~~~~~~~~~~~~^^^^^                                 \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/fastapi/router.py&amp;quot;, line   \n             290, in start_broker_lifespan                                      \n                 await self._start_broker()                                     \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/application.py&amp;quot;, line 98,  \n             in _start_broker                                                   \n                 await b.start()                                                \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/nats/broker/broker.py&amp;quot;, line 462, in \n             start                                                              \n                 await self.connect()                                           \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/broker/broker.py&amp;quot;, line    \n             111, in connect                                                    \n                 self._connection = await self._connect()                       \n                                    ^^^^^^^^^^^^^^^^^^^^^                       \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/nats/broker/broker.py&amp;quot;, line 427, in \n             _connect                                                           \n                 connection = await nats.connect(**self._connection_kwargs)     \n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^     \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/__init__.py&amp;quot;, line 46, in connect          \n                 await nc.connect(servers, **options)                           \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 547, in connect       \n                 raise e                                                        \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 535, in connect       \n                 await self._select_next_server()                               \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 1365, in              \n             _select_next_server                                                \n                 raise errors.NoServersError                                    \n             nats.errors.NoServersError: nats: no servers available for         \n             connection\n     ERROR   Application startup failed. Exiting.\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/cli/main.py:213 in run                         \u2502\n\u2502                                                                              \u2502\n\u2502   210 \u2502   \u2502   \u2502   raise typer.BadParameter(msg)                              \u2502\n\u2502   211 \u2502                                                                      \u2502\n\u2502   212 \u2502   else:                                                              \u2502\n\u2502 \u2771 213 \u2502   \u2502   _run_imported_app(app_obj, args=run_args)                      \u2502\n\u2502   214                                                                        \u2502\n\u2502   215                                                                        \u2502\n\u2502   216 def _run(args: RunArgs) -&amp;gt; None:                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502              app = &amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;         \u2502 \u2502\n\u2502 \u2502          app_dir = &amp;#x27;.&amp;#x27;                                                   \u2502 \u2502\n\u2502 \u2502          app_obj = &amp;lt;faststream.app.FastStream object at 0x7ac976202120&amp;gt;  \u2502 \u2502\n\u2502 \u2502 casted_log_level = 0                                                     \u2502 \u2502\n\u2502 \u2502              ctx = &amp;lt;click.core.Context object at 0x7ac9764d9950&amp;gt;         \u2502 \u2502\n\u2502 \u2502            extra = {&amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;}                                      \u2502 \u2502\n\u2502 \u2502       is_factory = False                                                 \u2502 \u2502\n\u2502 \u2502       log_config = None                                                  \u2502 \u2502\n\u2502 \u2502        log_level = &amp;lt;LogLevels.notset: &amp;#x27;notset&amp;#x27;&amp;gt;                          \u2502 \u2502\n\u2502 \u2502             loop = &amp;#x27;auto&amp;#x27;                                                \u2502 \u2502\n\u2502 \u2502      module_path = PosixPath(&amp;#x27;/home/philippe/src/PA_Communautaire/packa\u2026 \u2502 \u2502\n\u2502 \u2502           reload = False                                                 \u2502 \u2502\n\u2502 \u2502         run_args = RunArgs(                                              \u2502 \u2502\n\u2502 \u2502                    \u2502                                                     \u2502 \u2502\n\u2502 \u2502                    app=&amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;,    \u2502 \u2502\n\u2502 \u2502                    \u2502   extra_options={                                   \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   &amp;#x27;worker_id&amp;#x27;: None,                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   &amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;                                \u2502 \u2502\n\u2502 \u2502                    \u2502   },                                                \u2502 \u2502\n\u2502 \u2502                    \u2502   is_factory=False,                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   log_config=None,                                  \u2502 \u2502\n\u2502 \u2502                    \u2502   log_level=0,                                      \u2502 \u2502\n\u2502 \u2502                    \u2502   app_level=20,                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   loop=&amp;#x27;auto&amp;#x27;                                       \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502 watch_extensions = []                                                    \u2502 \u2502\n\u2502 \u2502          workers = 1                                                     \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/cli/main.py:248 in _run_imported_app           \u2502\n\u2502                                                                              \u2502\n\u2502   245 \u2502   \u2502   \u2502   backend_options[&amp;quot;loop_factory&amp;quot;] = uvloop.new_event_loop    \u2502\n\u2502   246 \u2502                                                                      \u2502\n\u2502   247 \u2502   try:                                                               \u2502\n\u2502 \u2771 248 \u2502   \u2502   anyio.run(                                                     \u2502\n\u2502   249 \u2502   \u2502   \u2502   app_obj.run,                                               \u2502\n\u2502   250 \u2502   \u2502   \u2502   args.app_level,                                            \u2502\n\u2502   251 \u2502   \u2502   \u2502   args.extra_options,                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         app_obj = &amp;lt;faststream.app.FastStream object at 0x7ac976202120&amp;gt;   \u2502 \u2502\n\u2502 \u2502            args = RunArgs(                                               \u2502 \u2502\n\u2502 \u2502                   \u2502   app=&amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;, \u2502 \u2502\n\u2502 \u2502                   \u2502   extra_options={                                    \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   &amp;#x27;worker_id&amp;#x27;: None,                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   &amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;                                 \u2502 \u2502\n\u2502 \u2502                   \u2502   },                                                 \u2502 \u2502\n\u2502 \u2502                   \u2502   is_factory=False,                                  \u2502 \u2502\n\u2502 \u2502                   \u2502   log_config=None,                                   \u2502 \u2502\n\u2502 \u2502                   \u2502   log_level=0,                                       \u2502 \u2502\n\u2502 \u2502                   \u2502   app_level=20,                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   loop=&amp;#x27;auto&amp;#x27;                                        \u2502 \u2502\n\u2502 \u2502                   )                                                      \u2502 \u2502\n\u2502 \u2502 backend_options = {                                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   &amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at        \u2502 \u2502\n\u2502 \u2502                   0x7ac976376520&amp;gt;                                        \u2502 \u2502\n\u2502 \u2502                   }                                                      \u2502 \u2502\n\u2502 \u2502          uvloop = &amp;lt;module &amp;#x27;uvloop&amp;#x27; from                                  \u2502 \u2502\n\u2502 \u2502                   &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/.v\u2026 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_core/_eventloop.py:75 in run                                 \u2502\n\u2502                                                                              \u2502\n\u2502    72 \u2502                                                                      \u2502\n\u2502    73 \u2502   try:                                                               \u2502\n\u2502    74 \u2502   \u2502   backend_options = backend_options or {}                        \u2502\n\u2502 \u2771  75 \u2502   \u2502   return async_backend.run(func, args, {}, backend_options)      \u2502\n\u2502    76 \u2502   finally:                                                           \u2502\n\u2502    77 \u2502   \u2502   reset_current_async_library(token)                             \u2502\n\u2502    78                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502            args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;})              \u2502 \u2502\n\u2502 \u2502   asynclib_name = None                                                   \u2502 \u2502\n\u2502 \u2502         backend = &amp;#x27;asyncio&amp;#x27;                                              \u2502 \u2502\n\u2502 \u2502 backend_options = {                                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   &amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at        \u2502 \u2502\n\u2502 \u2502                   0x7ac976376520&amp;gt;                                        \u2502 \u2502\n\u2502 \u2502                   }                                                      \u2502 \u2502\n\u2502 \u2502            func = &amp;lt;bound method FastStream.run of                        \u2502 \u2502\n\u2502 \u2502                   &amp;lt;faststream.app.FastStream object at 0x7ac976202120&amp;gt;&amp;gt;  \u2502 \u2502\n\u2502 \u2502           token = None                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_backends/_asyncio.py:2365 in run                             \u2502\n\u2502                                                                              \u2502\n\u2502   2362 \u2502   \u2502   \u2502   \u2502   loop_factory = winloop.new_event_loop                 \u2502\n\u2502   2363 \u2502   \u2502                                                                 \u2502\n\u2502   2364 \u2502   \u2502   with Runner(debug=debug, loop_factory=loop_factory) as runner \u2502\n\u2502 \u2771 2365 \u2502   \u2502   \u2502   return runner.run(wrapper())                              \u2502\n\u2502   2366 \u2502                                                                     \u2502\n\u2502   2367 \u2502   @classmethod                                                      \u2502\n\u2502   2368 \u2502   def current_token(cls) -&amp;gt; object:                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502    args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;})                      \u2502 \u2502\n\u2502 \u2502   debug = None                                                           \u2502 \u2502\n\u2502 \u2502    func = &amp;lt;bound method FastStream.run of &amp;lt;faststream.app.FastStream     \u2502 \u2502\n\u2502 \u2502           object at 0x7ac976202120&amp;gt;&amp;gt;                                     \u2502 \u2502\n\u2502 \u2502  kwargs = {}                                                             \u2502 \u2502\n\u2502 \u2502 options = {&amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at 0x7ac976376520&amp;gt;}  \u2502 \u2502\n\u2502 \u2502  runner = &amp;lt;asyncio.runners.Runner object at 0x7ac976202a50&amp;gt;              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/py \u2502\n\u2502 thon3.13/asyncio/runners.py:118 in run                                       \u2502\n\u2502                                                                              \u2502\n\u2502   115 \u2502   \u2502                                                                  \u2502\n\u2502   116 \u2502   \u2502   self._interrupt_count = 0                                      \u2502\n\u2502   117 \u2502   \u2502   try:                                                           \u2502\n\u2502 \u2771 118 \u2502   \u2502   \u2502   return self._loop.run_until_complete(task)                 \u2502\n\u2502   119 \u2502   \u2502   except exceptions.CancelledError:                              \u2502\n\u2502   120 \u2502   \u2502   \u2502   if self._interrupt_count &amp;gt; 0:                              \u2502\n\u2502   121 \u2502   \u2502   \u2502   \u2502   uncancel = getattr(task, &amp;quot;uncancel&amp;quot;, None)             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        context = &amp;lt;_contextvars.Context object at 0x7ac975ea5140&amp;gt;         \u2502 \u2502\n\u2502 \u2502           coro = &amp;lt;coroutine object FastStream.run at 0x7ac975e8f4c0&amp;gt;     \u2502 \u2502\n\u2502 \u2502           self = &amp;lt;asyncio.runners.Runner object at 0x7ac976202a50&amp;gt;       \u2502 \u2502\n\u2502 \u2502 sigint_handler = functools.partial(&amp;lt;bound method Runner._on_sigint of    \u2502 \u2502\n\u2502 \u2502                  &amp;lt;asyncio.runners.Runner object at 0x7ac976202a50&amp;gt;&amp;gt;,     \u2502 \u2502\n\u2502 \u2502                  main_task=&amp;lt;Task finished                                \u2502 \u2502\n\u2502 \u2502                  name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;                    \u2502 \u2502\n\u2502 \u2502                  coro=&amp;lt;FastStream.run() done, defined at                 \u2502 \u2502\n\u2502 \u2502                  /home/philippe/src/PA_Communautaire/packages/pac0/.ven\u2026 \u2502 \u2502\n\u2502 \u2502                  exception=NoServersError()&amp;gt;)                            \u2502 \u2502\n\u2502 \u2502           task = &amp;lt;Task finished name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;     \u2502 \u2502\n\u2502 \u2502                  coro=&amp;lt;FastStream.run() done, defined at                 \u2502 \u2502\n\u2502 \u2502                  /home/philippe/src/PA_Communautaire/packages/pac0/.ven\u2026 \u2502 \u2502\n\u2502 \u2502                  exception=NoServersError()&amp;gt;                             \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 in uvloop.loop.Loop.run_until_complete:1518                                  \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_backends/_asyncio.py:2348 in wrapper                         \u2502\n\u2502                                                                              \u2502\n\u2502   2345 \u2502   \u2502   \u2502   _task_states[task] = TaskState(None, None)                \u2502\n\u2502   2346 \u2502   \u2502   \u2502                                                             \u2502\n\u2502   2347 \u2502   \u2502   \u2502   try:                                                      \u2502\n\u2502 \u2771 2348 \u2502   \u2502   \u2502   \u2502   return await func(*args)                              \u2502\n\u2502   2349 \u2502   \u2502   \u2502   finally:                                                  \u2502\n\u2502   2350 \u2502   \u2502   \u2502   \u2502   del _task_states[task]                                \u2502\n\u2502   2351                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;})                         \u2502 \u2502\n\u2502 \u2502 func = &amp;lt;bound method FastStream.run of &amp;lt;faststream.app.FastStream object \u2502 \u2502\n\u2502 \u2502        at 0x7ac976202120&amp;gt;&amp;gt;                                               \u2502 \u2502\n\u2502 \u2502 task = &amp;lt;Task finished name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;               \u2502 \u2502\n\u2502 \u2502        coro=&amp;lt;FastStream.run() done, defined at                           \u2502 \u2502\n\u2502 \u2502        /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/pyth\u2026 \u2502 \u2502\n\u2502 \u2502        exception=NoServersError()&amp;gt;                                       \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/app.py:100 in run                                        \u2502\n\u2502                                                                              \u2502\n\u2502    97 \u2502   \u2502   \u2502   \u2502   \u2502   tg.cancel_scope.cancel()                           \u2502\n\u2502    98 \u2502   \u2502   \u2502   except ExceptionGroup as e:                                \u2502\n\u2502    99 \u2502   \u2502   \u2502   \u2502   for ex in e.exceptions:                                \u2502\n\u2502 \u2771 100 \u2502   \u2502   \u2502   \u2502   \u2502   raise ex from None                                 \u2502\n\u2502   101 \u2502                                                                      \u2502\n\u2502   102 \u2502   def exit(self) -&amp;gt; None:                                            \u2502\n\u2502   103 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Stop application manually.&amp;quot;&amp;quot;&amp;quot;                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502                ex = NoServersError()                                     \u2502 \u2502\n\u2502 \u2502         log_level = 20                                                   \u2502 \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7ac976202120&amp;gt; \u2502 \u2502\n\u2502 \u2502        sleep_time = 0.1                                                  \u2502 \u2502\n\u2502 \u2502                tg = &amp;lt;anyio._backends._asyncio.TaskGroup object at        \u2502 \u2502\n\u2502 \u2502                     0x7ac9762034d0&amp;gt;                                      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:205 in _startup                 \u2502\n\u2502                                                                              \u2502\n\u2502   202 \u2502   ) -&amp;gt; None:                                                         \u2502\n\u2502   203 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Private method calls `start` with logging.&amp;quot;&amp;quot;&amp;quot;               \u2502\n\u2502   204 \u2502   \u2502   async with self._startup_logging(log_level=log_level):         \u2502\n\u2502 \u2771 205 \u2502   \u2502   \u2502   await self.start(**(run_extra_options or {}))              \u2502\n\u2502   206 \u2502   \u2502                                                                  \u2502\n\u2502   207 \u2502   \u2502   self.running = True                                            \u2502\n\u2502   208                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         log_level = 20                                                   \u2502 \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7ac976202120&amp;gt; \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:215 in start                    \u2502\n\u2502                                                                              \u2502\n\u2502   212 \u2502   ) -&amp;gt; None:                                                         \u2502\n\u2502   213 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Executes startup hooks and start broker.&amp;quot;&amp;quot;&amp;quot;                 \u2502\n\u2502   214 \u2502   \u2502   async with self._start_hooks_context(**run_extra_options):     \u2502\n\u2502 \u2771 215 \u2502   \u2502   \u2502   await self._start_broker()                                 \u2502\n\u2502   216 \u2502                                                                      \u2502\n\u2502   217 \u2502   @asynccontextmanager                                               \u2502\n\u2502   218 \u2502   async def _start_hooks_context(                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8026&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7ac976202120&amp;gt; \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:98 in _start_broker             \u2502\n\u2502                                                                              \u2502\n\u2502    95 \u2502   async def _start_broker(self) -&amp;gt; None:                             \u2502\n\u2502    96 \u2502   \u2502   assert self.brokers, &amp;quot;You should setup a broker&amp;quot;               \u2502\n\u2502    97 \u2502   \u2502   for b in self.brokers:                                         \u2502\n\u2502 \u2771  98 \u2502   \u2502   \u2502   await b.start()                                            \u2502\n\u2502    99 \u2502                                                                      \u2502\n\u2502   100 \u2502   @property                                                          \u2502\n\u2502   101 \u2502   def broker(self) -&amp;gt; Optional[&amp;quot;BrokerUsecase[Any, Any]&amp;quot;]:           \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502    b = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7ac976201940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2502 self = &amp;lt;faststream.app.FastStream object at 0x7ac976202120&amp;gt;              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/nats/broker/broker.py:462 in start                       \u2502\n\u2502                                                                              \u2502\n\u2502   459 \u2502                                                                      \u2502\n\u2502   460 \u2502   async def start(self) -&amp;gt; None:                                     \u2502\n\u2502   461 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Connect broker to NATS cluster and startup all subscribers. \u2502\n\u2502 \u2771 462 \u2502   \u2502   await self.connect()                                           \u2502\n\u2502   463 \u2502   \u2502                                                                  \u2502\n\u2502   464 \u2502   \u2502   stream_context = self.config.connection_state.stream           \u2502\n\u2502   465                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7ac976201940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/broker/broker.py:111 in connect                \u2502\n\u2502                                                                              \u2502\n\u2502   108 \u2502   async def connect(self) -&amp;gt; ConnectionType:                         \u2502\n\u2502   109 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Connect to a remote server.&amp;quot;&amp;quot;&amp;quot;                              \u2502\n\u2502   110 \u2502   \u2502   if self._connection is None:                                   \u2502\n\u2502 \u2771 111 \u2502   \u2502   \u2502   self._connection = await self._connect()                   \u2502\n\u2502   112 \u2502   \u2502   \u2502   self._setup_logger()                                       \u2502\n\u2502   113 \u2502   \u2502                                                                  \u2502\n\u2502   114 \u2502   \u2502   return self._connection                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7ac976201940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/nats/broker/broker.py:427 in _connect                    \u2502\n\u2502                                                                              \u2502\n\u2502   424 \u2502   \u2502   )                                                              \u2502\n\u2502   425 \u2502                                                                      \u2502\n\u2502   426 \u2502   async def _connect(self) -&amp;gt; &amp;quot;Client&amp;quot;:                              \u2502\n\u2502 \u2771 427 \u2502   \u2502   connection = await nats.connect(**self._connection_kwargs)     \u2502\n\u2502   428 \u2502   \u2502   self.config.connect(connection)                                \u2502\n\u2502   429 \u2502   \u2502   return connection                                              \u2502\n\u2502   430                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7ac976201940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/__init__.py:46 in connect                                      \u2502\n\u2502                                                                              \u2502\n\u2502   43 \u2502                                                                       \u2502\n\u2502   44 \u2502   &amp;quot;&amp;quot;&amp;quot;                                                                 \u2502\n\u2502   45 \u2502   nc = NATS()                                                         \u2502\n\u2502 \u2771 46 \u2502   await nc.connect(servers, **options)                                \u2502\n\u2502   47 \u2502   return nc                                                           \u2502\n\u2502   48                                                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                              \u2502\n\u2502 \u2502      nc = &amp;lt;nats client v2.12.0&amp;gt;             \u2502                              \u2502\n\u2502 \u2502 options = {                                 \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;name&amp;#x27;: &amp;#x27;faststream-0.6.4&amp;#x27;,   \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;verbose&amp;#x27;: False,             \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;allow_reconnect&amp;#x27;: True,      \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;reconnect_time_wait&amp;#x27;: 2,     \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;max_reconnect_attempts&amp;#x27;: 60, \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;no_echo&amp;#x27;: False,             \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;pedantic&amp;#x27;: False,            \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;inbox_prefix&amp;#x27;: b&amp;#x27;_INBOX&amp;#x27;,    \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;pending_size&amp;#x27;: 2097152,      \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;connect_timeout&amp;#x27;: 2,         \u2502                              \u2502\n\u2502 \u2502           \u2502   ... +18                       \u2502                              \u2502\n\u2502 \u2502           }                                 \u2502                              \u2502\n\u2502 \u2502 servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502                              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                              \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:547 in connect                                   \u2502\n\u2502                                                                              \u2502\n\u2502    544 \u2502   \u2502   \u2502   \u2502   \u2502   # Never stop reconnecting                         \u2502\n\u2502    545 \u2502   \u2502   \u2502   \u2502   \u2502   continue                                          \u2502\n\u2502    546 \u2502   \u2502   \u2502   \u2502   self._err = e                                         \u2502\n\u2502 \u2771  547 \u2502   \u2502   \u2502   \u2502   raise e                                               \u2502\n\u2502    548 \u2502   \u2502   \u2502   except (OSError, errors.Error, asyncio.TimeoutError) as e \u2502\n\u2502    549 \u2502   \u2502   \u2502   \u2502   self._err = e                                         \u2502\n\u2502    550 \u2502   \u2502   \u2502   \u2502   await self._error_cb(e)                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502        allow_reconnect = True                              \u2502               \u2502\n\u2502 \u2502                     cb = None                              \u2502               \u2502\n\u2502 \u2502              closed_cb = None                              \u2502               \u2502\n\u2502 \u2502        connect_timeout = 2                                 \u2502               \u2502\n\u2502 \u2502        disconnected_cb = None                              \u2502               \u2502\n\u2502 \u2502   discovered_server_cb = None                              \u2502               \u2502\n\u2502 \u2502         dont_randomize = False                             \u2502               \u2502\n\u2502 \u2502          drain_timeout = 30                                \u2502               \u2502\n\u2502 \u2502          flush_timeout = None                              \u2502               \u2502\n\u2502 \u2502     flusher_queue_size = 1024                              \u2502               \u2502\n\u2502 \u2502           inbox_prefix = b&amp;#x27;_INBOX&amp;#x27;                         \u2502               \u2502\n\u2502 \u2502  max_outstanding_pings = 2                                 \u2502               \u2502\n\u2502 \u2502 max_reconnect_attempts = 60                                \u2502               \u2502\n\u2502 \u2502                   name = &amp;#x27;faststream-0.6.4&amp;#x27;                \u2502               \u2502\n\u2502 \u2502             nkeys_seed = None                              \u2502               \u2502\n\u2502 \u2502         nkeys_seed_str = None                              \u2502               \u2502\n\u2502 \u2502                no_echo = False                             \u2502               \u2502\n\u2502 \u2502               password = None                              \u2502               \u2502\n\u2502 \u2502               pedantic = False                             \u2502               \u2502\n\u2502 \u2502           pending_size = 2097152                           \u2502               \u2502\n\u2502 \u2502          ping_interval = 120                               \u2502               \u2502\n\u2502 \u2502    reconnect_time_wait = 2                                 \u2502               \u2502\n\u2502 \u2502                   self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502               \u2502\n\u2502 \u2502                 server = Srv(                              \u2502               \u2502\n\u2502 \u2502                          \u2502   uri=ParseResult(              \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502               \u2502\n\u2502 \u2502                          \u2502   ),                            \u2502               \u2502\n\u2502 \u2502                          \u2502   reconnects=61,                \u2502               \u2502\n\u2502 \u2502                          \u2502   last_attempt=32546.519184256, \u2502               \u2502\n\u2502 \u2502                          \u2502   did_connect=False,            \u2502               \u2502\n\u2502 \u2502                          \u2502   discovered=False,             \u2502               \u2502\n\u2502 \u2502                          \u2502   tls_name=None,                \u2502               \u2502\n\u2502 \u2502                          \u2502   server_version=None           \u2502               \u2502\n\u2502 \u2502                          )                                 \u2502               \u2502\n\u2502 \u2502 server_auth_configured = False                             \u2502               \u2502\n\u2502 \u2502                servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502               \u2502\n\u2502 \u2502           signature_cb = None                              \u2502               \u2502\n\u2502 \u2502                    tls = None                              \u2502               \u2502\n\u2502 \u2502    tls_handshake_first = False                             \u2502               \u2502\n\u2502 \u2502           tls_hostname = None                              \u2502               \u2502\n\u2502 \u2502                  token = None                              \u2502               \u2502\n\u2502 \u2502                   user = None                              \u2502               \u2502\n\u2502 \u2502       user_credentials = None                              \u2502               \u2502\n\u2502 \u2502            user_jwt_cb = None                              \u2502               \u2502\n\u2502 \u2502                verbose = False                             \u2502               \u2502\n\u2502 \u2502  ws_connection_headers = None                              \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:535 in connect                                   \u2502\n\u2502                                                                              \u2502\n\u2502    532 \u2502   \u2502                                                                 \u2502\n\u2502    533 \u2502   \u2502   while True:                                                   \u2502\n\u2502    534 \u2502   \u2502   \u2502   try:                                                      \u2502\n\u2502 \u2771  535 \u2502   \u2502   \u2502   \u2502   await self._select_next_server()                      \u2502\n\u2502    536 \u2502   \u2502   \u2502   \u2502   await self._process_connect_init()                    \u2502\n\u2502    537 \u2502   \u2502   \u2502   \u2502   assert (                                              \u2502\n\u2502    538 \u2502   \u2502   \u2502   \u2502   \u2502   self._current_server                              \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502        allow_reconnect = True                              \u2502               \u2502\n\u2502 \u2502                     cb = None                              \u2502               \u2502\n\u2502 \u2502              closed_cb = None                              \u2502               \u2502\n\u2502 \u2502        connect_timeout = 2                                 \u2502               \u2502\n\u2502 \u2502        disconnected_cb = None                              \u2502               \u2502\n\u2502 \u2502   discovered_server_cb = None                              \u2502               \u2502\n\u2502 \u2502         dont_randomize = False                             \u2502               \u2502\n\u2502 \u2502          drain_timeout = 30                                \u2502               \u2502\n\u2502 \u2502          flush_timeout = None                              \u2502               \u2502\n\u2502 \u2502     flusher_queue_size = 1024                              \u2502               \u2502\n\u2502 \u2502           inbox_prefix = b&amp;#x27;_INBOX&amp;#x27;                         \u2502               \u2502\n\u2502 \u2502  max_outstanding_pings = 2                                 \u2502               \u2502\n\u2502 \u2502 max_reconnect_attempts = 60                                \u2502               \u2502\n\u2502 \u2502                   name = &amp;#x27;faststream-0.6.4&amp;#x27;                \u2502               \u2502\n\u2502 \u2502             nkeys_seed = None                              \u2502               \u2502\n\u2502 \u2502         nkeys_seed_str = None                              \u2502               \u2502\n\u2502 \u2502                no_echo = False                             \u2502               \u2502\n\u2502 \u2502               password = None                              \u2502               \u2502\n\u2502 \u2502               pedantic = False                             \u2502               \u2502\n\u2502 \u2502           pending_size = 2097152                           \u2502               \u2502\n\u2502 \u2502          ping_interval = 120                               \u2502               \u2502\n\u2502 \u2502    reconnect_time_wait = 2                                 \u2502               \u2502\n\u2502 \u2502                   self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502               \u2502\n\u2502 \u2502                 server = Srv(                              \u2502               \u2502\n\u2502 \u2502                          \u2502   uri=ParseResult(              \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502               \u2502\n\u2502 \u2502                          \u2502   ),                            \u2502               \u2502\n\u2502 \u2502                          \u2502   reconnects=61,                \u2502               \u2502\n\u2502 \u2502                          \u2502   last_attempt=32546.519184256, \u2502               \u2502\n\u2502 \u2502                          \u2502   did_connect=False,            \u2502               \u2502\n\u2502 \u2502                          \u2502   discovered=False,             \u2502               \u2502\n\u2502 \u2502                          \u2502   tls_name=None,                \u2502               \u2502\n\u2502 \u2502                          \u2502   server_version=None           \u2502               \u2502\n\u2502 \u2502                          )                                 \u2502               \u2502\n\u2502 \u2502 server_auth_configured = False                             \u2502               \u2502\n\u2502 \u2502                servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502               \u2502\n\u2502 \u2502           signature_cb = None                              \u2502               \u2502\n\u2502 \u2502                    tls = None                              \u2502               \u2502\n\u2502 \u2502    tls_handshake_first = False                             \u2502               \u2502\n\u2502 \u2502           tls_hostname = None                              \u2502               \u2502\n\u2502 \u2502                  token = None                              \u2502               \u2502\n\u2502 \u2502                   user = None                              \u2502               \u2502\n\u2502 \u2502       user_credentials = None                              \u2502               \u2502\n\u2502 \u2502            user_jwt_cb = None                              \u2502               \u2502\n\u2502 \u2502                verbose = False                             \u2502               \u2502\n\u2502 \u2502  ws_connection_headers = None                              \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:1365 in _select_next_server                      \u2502\n\u2502                                                                              \u2502\n\u2502   1362 \u2502   \u2502   while True:                                                   \u2502\n\u2502   1363 \u2502   \u2502   \u2502   if len(self._server_pool) == 0:                           \u2502\n\u2502   1364 \u2502   \u2502   \u2502   \u2502   self._current_server = None                           \u2502\n\u2502 \u2771 1365 \u2502   \u2502   \u2502   \u2502   raise errors.NoServersError                           \u2502\n\u2502   1366 \u2502   \u2502   \u2502                                                             \u2502\n\u2502   1367 \u2502   \u2502   \u2502   now = time.monotonic()                                    \u2502\n\u2502   1368 \u2502   \u2502   \u2502   s = self._server_pool.pop(0)                              \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                                 \u2502\n\u2502 \u2502  now = 32546.519206196                   \u2502                                 \u2502\n\u2502 \u2502    s = Srv(                              \u2502                                 \u2502\n\u2502 \u2502        \u2502   uri=ParseResult(              \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502                                 \u2502\n\u2502 \u2502        \u2502   ),                            \u2502                                 \u2502\n\u2502 \u2502        \u2502   reconnects=61,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   last_attempt=32546.519184256, \u2502                                 \u2502\n\u2502 \u2502        \u2502   did_connect=False,            \u2502                                 \u2502\n\u2502 \u2502        \u2502   discovered=False,             \u2502                                 \u2502\n\u2502 \u2502        \u2502   tls_name=None,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   server_version=None           \u2502                                 \u2502\n\u2502 \u2502        )                                 \u2502                                 \u2502\n\u2502 \u2502 self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502                                 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                                 \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nNoServersError: nats: no servers available for connection\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_une pa communautaire&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_une pa communautaire&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8016 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8016\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service api_gateway on port 8011 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service esb_central on port 8071 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  esb_central started on localhost:8071\nINFO     pac0.shared.test.service.base:base.py:135 Starting service controle_formats on port 8133 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  controle_formats started on localhost:8133\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8011 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nWARNING  pac0.shared.test.service.base:base.py:179 Service didn&amp;#x27;t terminate gracefully, killing...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_healthcheck_full_ok&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_healthcheck_full_ok&#34;, &#34;duration&#34;: &#34;00:00:40&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_healthcheck_full_ok&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:40&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_healthcheck_full_ok&amp;gt;&amp;gt;, argname = &amp;#x27;world1&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:743: in pytest_fixture_setup\n    hook_result = yield\n                  ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:313: in _asyncgen_fixture_wrapper\n    result = runner.run(setup(), context=context)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:118: in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/base_events.py:725: in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:309: in setup\n    res = await gen_obj.__anext__()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n../pac0/src/pac0/shared/test/world.py:338: in world1\n    await world.pa_new()\n../pac0/src/pac0/shared/test/world.py:71: in pa_new\n    await asyncio.gather(*tasks)\n../pac0/src/pac0/shared/test/service/pac.py:58: in __aenter__\n    await asyncio.gather(*[s.__aenter__() for s in self._services()])\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = &amp;lt;pac0.shared.test.service.fastapi.FastApiServiceContext object at 0x7d037aaddae0&amp;gt;\n\n    async def __aenter__(self) -&amp;gt; Self:\n        &amp;quot;&amp;quot;&amp;quot;Start the service subprocess.&amp;quot;&amp;quot;&amp;quot;\n        if self.config.port == 0:\n            self.config.port = find_available_port(start_port=8000)\n        logger.info(\n            f&amp;quot;Starting service {self.config.name} on port {self.config.port} : {&amp;#x27; &amp;#x27;.join(self.config.command)}&amp;quot;\n        )\n        env = os.environ.copy()\n        env[&amp;quot;PORT&amp;quot;] = str(self.config.port)\n        if self.config.env_var_extra:\n            env.update(self.config.env_var_extra)\n        command = [c.format(**env) for c in self.config.command]\n    \n        self._process = subprocess.Popen(\n            command,\n            # stdout=subprocess.PIPE,  # self.config.stdout,\n            # stderr=subprocess.PIPE,  # self.config.stderr,\n            text=True,\n            env=env,\n            cwd=PACKAGE_BASE_FOLDER,\n        )\n    \n        # Wait for service to be ready\n        self.is_ready = await self.wait_for_ready(self.config.startup_timeout)\n        if not self.is_ready:\n            await self._terminate()\n&amp;gt;           raise TimeoutError(\n                f&amp;quot;Service {self.config.name} failed to start within {self.config.startup_timeout}s&amp;quot;\n            )\nE           TimeoutError: Service api_gateway failed to start within 30.0s\n\n../pac0/src/pac0/shared/test/service/base.py:157: TimeoutError\n\n----------------------------- Captured stdout call -----------------------------\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n\n   FastAPI   Starting production server \ud83d\ude80\n \n             Searching for package file structure from directories with         \n             __init__.py files                                                  \nConnecting to NATS nats://localhost:4222 ...\n             Importing from                                                     \n             /home/philippe/src/PA_Communautaire/packages/pac0/src/pac0/service/\n             api_gateway                                                        \n \n    module   \ud83d\udc0d main.py\n \n      code   Importing the FastAPI app object from the module with the following\n             code:                                                              \n \n             from main import app\n \n       app   Using import string: main:app\n \n    server   Server started at http://0.0.0.0:8105\n    server   Documentation at http://0.0.0.0:8105/docs\n \n             Logs:\n \n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\n_check_http_health http://localhost:8105/healthcheck\ncccccc All connection attempts failed\nsetup pac0 service ...\n\n----------------------------- Captured stderr call -----------------------------\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n[80980] 2026/01/13 17:56:31.607189 [INF] Starting nats-server\n[80980] 2026/01/13 17:56:31.607245 [INF]   Version:  2.12.3\n[80980] 2026/01/13 17:56:31.607250 [INF]   Git:      [450a519]\n[80980] 2026/01/13 17:56:31.607254 [INF]   Name:     NAJIMGDQBTDJ56EVHQ2RQCIR35QCYSACEXHWWJK4CFYXK42K7FEUAIWY\n[80980] 2026/01/13 17:56:31.607257 [INF]   ID:       NAJIMGDQBTDJ56EVHQ2RQCIR35QCYSACEXHWWJK4CFYXK42K7FEUAIWY\n[80980] 2026/01/13 17:56:31.607981 [INF] Listening for client connections on 0.0.0.0:8167\n[80980] 2026/01/13 17:56:31.608400 [INF] Server is ready\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n2026-01-13 17:56:32,040 INFO     - FastStream app starting...\n      INFO   Started server process [80981]\n      INFO   Waiting for application startup.\n     ERROR   Traceback (most recent call last):                                 \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/starlette/routing.py&amp;quot;, line 694, in lifespan    \n                 async with self.lifespan_context(app) as maybe_state:          \n                            ~~~~~~~~~~~~~~~~~~~~~^^^^^                          \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/fastapi/routing.py&amp;quot;, line 200, in               \n             merged_lifespan                                                    \n                 async with original_context(app) as maybe_original_state:      \n                            ~~~~~~~~~~~~~~~~^^^^^                               \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/fastapi/routing.py&amp;quot;, line 201, in               \n             merged_lifespan                                                    \n                 async with nested_context(app) as maybe_nested_state:          \n                            ~~~~~~~~~~~~~~^^^^^                                 \n               File                                                             \n             &amp;quot;/home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-\n             gnu/lib/python3.13/contextlib.py&amp;quot;, line 214, in __aenter__         \n                 return await anext(self.gen)                                   \n                        ^^^^^^^^^^^^^^^^^^^^^                                   \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/fastapi/router.py&amp;quot;, line   \n             290, in start_broker_lifespan                                      \n                 await self._start_broker()                                     \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/application.py&amp;quot;, line 98,  \n             in _start_broker                                                   \n                 await b.start()                                                \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/nats/broker/broker.py&amp;quot;, line 462, in \n             start                                                              \n                 await self.connect()                                           \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/_internal/broker/broker.py&amp;quot;, line    \n             111, in connect                                                    \n                 self._connection = await self._connect()                       \n                                    ^^^^^^^^^^^^^^^^^^^^^                       \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/faststream/nats/broker/broker.py&amp;quot;, line 427, in \n             _connect                                                           \n                 connection = await nats.connect(**self._connection_kwargs)     \n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^     \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/__init__.py&amp;quot;, line 46, in connect          \n                 await nc.connect(servers, **options)                           \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 547, in connect       \n                 raise e                                                        \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 535, in connect       \n                 await self._select_next_server()                               \n               File                                                             \n             &amp;quot;/home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python\n             3.13/site-packages/nats/aio/client.py&amp;quot;, line 1365, in              \n             _select_next_server                                                \n                 raise errors.NoServersError                                    \n             nats.errors.NoServersError: nats: no servers available for         \n             connection\n     ERROR   Application startup failed. Exiting.\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_une pa communautaire&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_une pa communautaire&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8187 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8187\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service api_gateway on port 8105 : uv run fastapi run src/pac0/service/api_gateway/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nINFO     pac0.shared.test.service.base:base.py:135 Starting service esb_central on port 8167 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready esb_central ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  esb_central started on localhost:8167\nINFO     pac0.shared.test.service.base:base.py:135 Starting service controle_formats on port 8106 : uv run faststream run src/pac0/service/validation_metier/main:app --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready controle_formats ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  controle_formats started on localhost:8106\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready api_gateway ...\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.started host=&amp;#x27;localhost&amp;#x27; port=8105 local_address=None timeout=5.0 socket_options=None\nDEBUG    httpcore.connection:_trace.py:87 connect_tcp.failed exception=ConnectError(OSError(&amp;#x27;All connection attempts failed&amp;#x27;))\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nWARNING  pac0.shared.test.service.base:base.py:179 Service didn&amp;#x27;t terminate gracefully, killing...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_controle_format_facturx&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_controle_format_facturx&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_controle_format_facturx&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function control_invoice at 0x7d037ae719e0&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_controle_format_facturx&amp;gt;&amp;gt;, kwargs = {}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\n    @when(\n        parsers.parse(&amp;quot;je d\u00e9pose pour contr\u00f4le la facture @{invoice}&amp;quot;),\n    )\n    def control_invoice():\n&amp;gt;       raise NotImplementedError()\nE       NotImplementedError\n\nsrc/pac_bdd/tobeimplemented.py:30: NotImplementedError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je d\u00e9pose pour contr\u00f4le la facture @FA213746_20251211_124749.pdf&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je d\u00e9pose pour contr\u00f4le la facture @{invoice}&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_dun_serveur_nats&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_dun_serveur_nats&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_dun_serveur_nats&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un serveur NATS disponible&amp;quot;. Line 19 in scenario &amp;quot;D\u00e9marrage d&amp;#x27;un serveur NATS&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/service_lifecycle.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_connexion_dun_broker_au_serveur_nats&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_connexion_dun_broker_au_serveur_nats&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_connexion_dun_broker_au_serveur_nats&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un serveur NATS disponible&amp;quot;. Line 23 in scenario &amp;quot;Connexion d&amp;#x27;un broker au serveur NATS&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/service_lifecycle.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_de_plusieurs_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_de_plusieurs_pa&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_de_plusieurs_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;2 PA d\u00e9marr\u00e9es&amp;quot;. Line 32 in scenario &amp;quot;D\u00e9marrage de plusieurs PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/service_lifecycle.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_dun_service_nats_local&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_dun_service_nats_local&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_dun_service_nats_local&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service NATS local&amp;quot;. Line 21 in scenario &amp;quot;D\u00e9marrage d&amp;#x27;un service NATS local&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_connexion_\u00e0_un_service_nats_distant&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_connexion_\u00e0_un_service_nats_distant&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_connexion_\u00e0_un_service_nats_distant&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service NATS local comme r\u00e9f\u00e9rence&amp;quot;. Line 27 in scenario &amp;quot;Connexion \u00e0 un service NATS distant&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_dun_service_peppol_mock&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_dun_service_peppol_mock&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_dun_service_peppol_mock&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service Peppol en mode mock&amp;quot;. Line 33 in scenario &amp;quot;D\u00e9marrage d&amp;#x27;un service Peppol mock&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_configuration_des_r\u00e9ponses_peppol_mock&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_configuration_des_r\u00e9ponses_peppol_mock&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_configuration_des_r\u00e9ponses_peppol_mock&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service Peppol en mode mock&amp;quot;. Line 38 in scenario &amp;quot;Configuration des r\u00e9ponses Peppol mock&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_recherche_peppol_dune_entreprise_non_enregistr\u00e9e&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_recherche_peppol_dune_entreprise_non_enregistr\u00e9e&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_recherche_peppol_dune_entreprise_non_enregistr\u00e9e&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service Peppol en mode mock&amp;quot;. Line 45 in scenario &amp;quot;Recherche Peppol d&amp;#x27;une entreprise non enregistr\u00e9e&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marrage_dun_service_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marrage_dun_service_pa&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marrage_dun_service_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service PA&amp;quot;. Line 51 in scenario &amp;quot;D\u00e9marrage d&amp;#x27;un service PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_1_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_1_pa&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_1_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 1 PA&amp;quot;. Line 61 in scenario &amp;quot;Cr\u00e9ation d&amp;#x27;un monde avec 1 PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_2_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_2_pa&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_2_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 68 in scenario &amp;quot;Cr\u00e9ation d&amp;#x27;un monde avec 2 PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_4_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_4_pa&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_cr\u00e9ation_dun_monde_avec_4_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 4 PA&amp;quot;. Line 74 in scenario &amp;quot;Cr\u00e9ation d&amp;#x27;un monde avec 4 PA&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_les_pa_partagent_le_m\u00eame_service_nats&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_les_pa_partagent_le_m\u00eame_service_nats&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_les_pa_partagent_le_m\u00eame_service_nats&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 82 in scenario &amp;quot;Les PA partagent le m\u00eame service NATS&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_les_pa_ont_des_ports_api_distincts&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_les_pa_ont_des_ports_api_distincts&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_les_pa_ont_des_ports_api_distincts&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 3 PA&amp;quot;. Line 87 in scenario &amp;quot;Les PA ont des ports API distincts&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_toutes_les_pa_r\u00e9pondent_au_healthcheck&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_toutes_les_pa_r\u00e9pondent_au_healthcheck&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_toutes_les_pa_r\u00e9pondent_au_healthcheck&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 95 in scenario &amp;quot;Toutes les PA r\u00e9pondent au healthcheck&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_information_du_monde&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_information_du_monde&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_information_du_monde&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 104 in scenario &amp;quot;Information du monde&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_arr\u00eat_propre_du_monde&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_arr\u00eat_propre_du_monde&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_arr\u00eat_propre_du_monde&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA d\u00e9marr\u00e9&amp;quot;. Line 115 in scenario &amp;quot;Arr\u00eat propre du monde&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_monde_avec_nats_externe&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_monde_avec_nats_externe&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_monde_avec_nats_externe&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service NATS local comme r\u00e9f\u00e9rence&amp;quot;. Line 126 in scenario &amp;quot;Monde avec NATS externe&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_monde_avec_peppol_personnalis\u00e9&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_monde_avec_peppol_personnalis\u00e9&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_monde_avec_peppol_personnalis\u00e9&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un service Peppol en mode mock comme r\u00e9f\u00e9rence&amp;quot;. Line 132 in scenario &amp;quot;Monde avec Peppol personnalis\u00e9&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9p\u00f4t_de_facture_entre_2_pa_via_peppol&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9p\u00f4t_de_facture_entre_2_pa_via_peppol&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9p\u00f4t_de_facture_entre_2_pa_via_peppol&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;E   pytest_bdd.exceptions.StepDefinitionNotFoundError: Step definition is not found: Given &amp;quot;un monde avec 2 PA&amp;quot;. Line 141 in scenario &amp;quot;D\u00e9p\u00f4t de facture entre 2 PA via Peppol&amp;quot; in the feature &amp;quot;/home/philippe/src/PA_Communautaire/docs/briques/02-esb-central/world.feature&amp;quot;\nAll traceback entries are hidden. Pass `--full-trace` to see hidden and internal frames.\n&#34;}], &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_esb_central&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_d\u00e9marragearr\u00eat_service_esb_central&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_d\u00e9marragearr\u00eat_service_esb_central&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_le service &amp;quot;02-esb-central&amp;quot; n\\&amp;#x27;est pas pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_le service &amp;quot;02-esb-central&amp;quot; n\\&amp;#x27;est pas pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je lance le service &amp;quot;02-esb-central&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je lance le service &amp;quot;02-esb-central&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service None on port 8140 : nats-server --port={PORT}\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready None ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  None started on localhost:8140\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_le service &amp;quot;02-esb-central&amp;quot; est pr\u00eat&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...&#34;}], &#34;test_scenario.py::test_healthcheck_message&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_healthcheck_message&#34;, &#34;duration&#34;: &#34;6 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_healthcheck_message&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;6 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function esb_sub at 0x7d037ae70b80&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_healthcheck_message&amp;gt;&amp;gt;\nkwargs = {&amp;#x27;canal&amp;#x27;: &amp;#x27;healthcheck&amp;#x27;, &amp;#x27;world&amp;#x27;: WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceContext object at 0x7d037ab757b0&amp;gt;, pas=[])}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nsrc/pac_bdd/esb.py:18: in wrapper\n    return asyncio.run(fn(*args, **kwargs))\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:195: in run\n    return runner.run(main)\n           ^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:118: in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/base_events.py:725: in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nworld = WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceContext object at 0x7d037ab757b0&amp;gt;, pas=[]), canal = &amp;#x27;healthcheck&amp;#x27;\n\n    @when(\n        parsers.parse(&amp;quot;j&amp;#x27;\u00e9coute le canal &amp;#x27;{canal}&amp;#x27;&amp;quot;),\n    )\n    @async_to_sync\n    async def esb_sub(\n        world: WorldContextOld,\n        canal: str,\n    ):\n        global handle_GLOBAL\n    \n        print(f&amp;quot;esb_sub {canal=}...&amp;quot;)\n        #raise NotImplementedError()\n&amp;gt;       broker = world.pac.broker\n                 ^^^^^^^^^\nE       AttributeError: &amp;#x27;WorldContext&amp;#x27; object has no attribute &amp;#x27;pac&amp;#x27;. Did you mean: &amp;#x27;pa&amp;#x27;?\n\nsrc/pac_bdd/esb.py:38: AttributeError\n\n----------------------------- Captured stdout call -----------------------------\nesb_sub canal=&amp;#x27;healthcheck&amp;#x27;...\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;\u00e9coute le canal &amp;#x27;healthcheck&amp;#x27;&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;\u00e9coute le canal &amp;#x27;{canal}&amp;#x27;&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8041 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8041\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\n\n--------------------------- Captured stderr teardown ---------------------------\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/cli/main.py:213 in run                         \u2502\n\u2502                                                                              \u2502\n\u2502   210 \u2502   \u2502   \u2502   raise typer.BadParameter(msg)                              \u2502\n\u2502   211 \u2502                                                                      \u2502\n\u2502   212 \u2502   else:                                                              \u2502\n\u2502 \u2771 213 \u2502   \u2502   _run_imported_app(app_obj, args=run_args)                      \u2502\n\u2502   214                                                                        \u2502\n\u2502   215                                                                        \u2502\n\u2502   216 def _run(args: RunArgs) -&amp;gt; None:                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502              app = &amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;         \u2502 \u2502\n\u2502 \u2502          app_dir = &amp;#x27;.&amp;#x27;                                                   \u2502 \u2502\n\u2502 \u2502          app_obj = &amp;lt;faststream.app.FastStream object at 0x7c6755e02120&amp;gt;  \u2502 \u2502\n\u2502 \u2502 casted_log_level = 0                                                     \u2502 \u2502\n\u2502 \u2502              ctx = &amp;lt;click.core.Context object at 0x7c67560d9950&amp;gt;         \u2502 \u2502\n\u2502 \u2502            extra = {&amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;}                                      \u2502 \u2502\n\u2502 \u2502       is_factory = False                                                 \u2502 \u2502\n\u2502 \u2502       log_config = None                                                  \u2502 \u2502\n\u2502 \u2502        log_level = &amp;lt;LogLevels.notset: &amp;#x27;notset&amp;#x27;&amp;gt;                          \u2502 \u2502\n\u2502 \u2502             loop = &amp;#x27;auto&amp;#x27;                                                \u2502 \u2502\n\u2502 \u2502      module_path = PosixPath(&amp;#x27;/home/philippe/src/PA_Communautaire/packa\u2026 \u2502 \u2502\n\u2502 \u2502           reload = False                                                 \u2502 \u2502\n\u2502 \u2502         run_args = RunArgs(                                              \u2502 \u2502\n\u2502 \u2502                    \u2502                                                     \u2502 \u2502\n\u2502 \u2502                    app=&amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;,    \u2502 \u2502\n\u2502 \u2502                    \u2502   extra_options={                                   \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   &amp;#x27;worker_id&amp;#x27;: None,                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   &amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;                                \u2502 \u2502\n\u2502 \u2502                    \u2502   },                                                \u2502 \u2502\n\u2502 \u2502                    \u2502   is_factory=False,                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   log_config=None,                                  \u2502 \u2502\n\u2502 \u2502                    \u2502   log_level=0,                                      \u2502 \u2502\n\u2502 \u2502                    \u2502   app_level=20,                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   loop=&amp;#x27;auto&amp;#x27;                                       \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502 watch_extensions = []                                                    \u2502 \u2502\n\u2502 \u2502          workers = 1                                                     \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/cli/main.py:248 in _run_imported_app           \u2502\n\u2502                                                                              \u2502\n\u2502   245 \u2502   \u2502   \u2502   backend_options[&amp;quot;loop_factory&amp;quot;] = uvloop.new_event_loop    \u2502\n\u2502   246 \u2502                                                                      \u2502\n\u2502   247 \u2502   try:                                                               \u2502\n\u2502 \u2771 248 \u2502   \u2502   anyio.run(                                                     \u2502\n\u2502   249 \u2502   \u2502   \u2502   app_obj.run,                                               \u2502\n\u2502   250 \u2502   \u2502   \u2502   args.app_level,                                            \u2502\n\u2502   251 \u2502   \u2502   \u2502   args.extra_options,                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         app_obj = &amp;lt;faststream.app.FastStream object at 0x7c6755e02120&amp;gt;   \u2502 \u2502\n\u2502 \u2502            args = RunArgs(                                               \u2502 \u2502\n\u2502 \u2502                   \u2502   app=&amp;#x27;src/pac0/service/validation_metier/main:app&amp;#x27;, \u2502 \u2502\n\u2502 \u2502                   \u2502   extra_options={                                    \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   &amp;#x27;worker_id&amp;#x27;: None,                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   &amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;                                 \u2502 \u2502\n\u2502 \u2502                   \u2502   },                                                 \u2502 \u2502\n\u2502 \u2502                   \u2502   is_factory=False,                                  \u2502 \u2502\n\u2502 \u2502                   \u2502   log_config=None,                                   \u2502 \u2502\n\u2502 \u2502                   \u2502   log_level=0,                                       \u2502 \u2502\n\u2502 \u2502                   \u2502   app_level=20,                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   loop=&amp;#x27;auto&amp;#x27;                                        \u2502 \u2502\n\u2502 \u2502                   )                                                      \u2502 \u2502\n\u2502 \u2502 backend_options = {                                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   &amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at        \u2502 \u2502\n\u2502 \u2502                   0x7c6755f76520&amp;gt;                                        \u2502 \u2502\n\u2502 \u2502                   }                                                      \u2502 \u2502\n\u2502 \u2502          uvloop = &amp;lt;module &amp;#x27;uvloop&amp;#x27; from                                  \u2502 \u2502\n\u2502 \u2502                   &amp;#x27;/home/philippe/src/PA_Communautaire/packages/pac0/.v\u2026 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_core/_eventloop.py:75 in run                                 \u2502\n\u2502                                                                              \u2502\n\u2502    72 \u2502                                                                      \u2502\n\u2502    73 \u2502   try:                                                               \u2502\n\u2502    74 \u2502   \u2502   backend_options = backend_options or {}                        \u2502\n\u2502 \u2771  75 \u2502   \u2502   return async_backend.run(func, args, {}, backend_options)      \u2502\n\u2502    76 \u2502   finally:                                                           \u2502\n\u2502    77 \u2502   \u2502   reset_current_async_library(token)                             \u2502\n\u2502    78                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502            args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;})              \u2502 \u2502\n\u2502 \u2502   asynclib_name = None                                                   \u2502 \u2502\n\u2502 \u2502         backend = &amp;#x27;asyncio&amp;#x27;                                              \u2502 \u2502\n\u2502 \u2502 backend_options = {                                                      \u2502 \u2502\n\u2502 \u2502                   \u2502   &amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at        \u2502 \u2502\n\u2502 \u2502                   0x7c6755f76520&amp;gt;                                        \u2502 \u2502\n\u2502 \u2502                   }                                                      \u2502 \u2502\n\u2502 \u2502            func = &amp;lt;bound method FastStream.run of                        \u2502 \u2502\n\u2502 \u2502                   &amp;lt;faststream.app.FastStream object at 0x7c6755e02120&amp;gt;&amp;gt;  \u2502 \u2502\n\u2502 \u2502           token = None                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_backends/_asyncio.py:2365 in run                             \u2502\n\u2502                                                                              \u2502\n\u2502   2362 \u2502   \u2502   \u2502   \u2502   loop_factory = winloop.new_event_loop                 \u2502\n\u2502   2363 \u2502   \u2502                                                                 \u2502\n\u2502   2364 \u2502   \u2502   with Runner(debug=debug, loop_factory=loop_factory) as runner \u2502\n\u2502 \u2771 2365 \u2502   \u2502   \u2502   return runner.run(wrapper())                              \u2502\n\u2502   2366 \u2502                                                                     \u2502\n\u2502   2367 \u2502   @classmethod                                                      \u2502\n\u2502   2368 \u2502   def current_token(cls) -&amp;gt; object:                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502    args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;})                      \u2502 \u2502\n\u2502 \u2502   debug = None                                                           \u2502 \u2502\n\u2502 \u2502    func = &amp;lt;bound method FastStream.run of &amp;lt;faststream.app.FastStream     \u2502 \u2502\n\u2502 \u2502           object at 0x7c6755e02120&amp;gt;&amp;gt;                                     \u2502 \u2502\n\u2502 \u2502  kwargs = {}                                                             \u2502 \u2502\n\u2502 \u2502 options = {&amp;#x27;loop_factory&amp;#x27;: &amp;lt;function new_event_loop at 0x7c6755f76520&amp;gt;}  \u2502 \u2502\n\u2502 \u2502  runner = &amp;lt;asyncio.runners.Runner object at 0x7c6755e02a50&amp;gt;              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/py \u2502\n\u2502 thon3.13/asyncio/runners.py:118 in run                                       \u2502\n\u2502                                                                              \u2502\n\u2502   115 \u2502   \u2502                                                                  \u2502\n\u2502   116 \u2502   \u2502   self._interrupt_count = 0                                      \u2502\n\u2502   117 \u2502   \u2502   try:                                                           \u2502\n\u2502 \u2771 118 \u2502   \u2502   \u2502   return self._loop.run_until_complete(task)                 \u2502\n\u2502   119 \u2502   \u2502   except exceptions.CancelledError:                              \u2502\n\u2502   120 \u2502   \u2502   \u2502   if self._interrupt_count &amp;gt; 0:                              \u2502\n\u2502   121 \u2502   \u2502   \u2502   \u2502   uncancel = getattr(task, &amp;quot;uncancel&amp;quot;, None)             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        context = &amp;lt;_contextvars.Context object at 0x7c6755aa5040&amp;gt;         \u2502 \u2502\n\u2502 \u2502           coro = &amp;lt;coroutine object FastStream.run at 0x7c6755a8f4c0&amp;gt;     \u2502 \u2502\n\u2502 \u2502           self = &amp;lt;asyncio.runners.Runner object at 0x7c6755e02a50&amp;gt;       \u2502 \u2502\n\u2502 \u2502 sigint_handler = functools.partial(&amp;lt;bound method Runner._on_sigint of    \u2502 \u2502\n\u2502 \u2502                  &amp;lt;asyncio.runners.Runner object at 0x7c6755e02a50&amp;gt;&amp;gt;,     \u2502 \u2502\n\u2502 \u2502                  main_task=&amp;lt;Task finished                                \u2502 \u2502\n\u2502 \u2502                  name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;                    \u2502 \u2502\n\u2502 \u2502                  coro=&amp;lt;FastStream.run() done, defined at                 \u2502 \u2502\n\u2502 \u2502                  /home/philippe/src/PA_Communautaire/packages/pac0/.ven\u2026 \u2502 \u2502\n\u2502 \u2502                  exception=NoServersError()&amp;gt;)                            \u2502 \u2502\n\u2502 \u2502           task = &amp;lt;Task finished name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;     \u2502 \u2502\n\u2502 \u2502                  coro=&amp;lt;FastStream.run() done, defined at                 \u2502 \u2502\n\u2502 \u2502                  /home/philippe/src/PA_Communautaire/packages/pac0/.ven\u2026 \u2502 \u2502\n\u2502 \u2502                  exception=NoServersError()&amp;gt;                             \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 in uvloop.loop.Loop.run_until_complete:1518                                  \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/anyio/_backends/_asyncio.py:2348 in wrapper                         \u2502\n\u2502                                                                              \u2502\n\u2502   2345 \u2502   \u2502   \u2502   _task_states[task] = TaskState(None, None)                \u2502\n\u2502   2346 \u2502   \u2502   \u2502                                                             \u2502\n\u2502   2347 \u2502   \u2502   \u2502   try:                                                      \u2502\n\u2502 \u2771 2348 \u2502   \u2502   \u2502   \u2502   return await func(*args)                              \u2502\n\u2502   2349 \u2502   \u2502   \u2502   finally:                                                  \u2502\n\u2502   2350 \u2502   \u2502   \u2502   \u2502   del _task_states[task]                                \u2502\n\u2502   2351                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 args = (20, {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;})                         \u2502 \u2502\n\u2502 \u2502 func = &amp;lt;bound method FastStream.run of &amp;lt;faststream.app.FastStream object \u2502 \u2502\n\u2502 \u2502        at 0x7c6755e02120&amp;gt;&amp;gt;                                               \u2502 \u2502\n\u2502 \u2502 task = &amp;lt;Task finished name=&amp;#x27;faststream.app.FastStream.run&amp;#x27;               \u2502 \u2502\n\u2502 \u2502        coro=&amp;lt;FastStream.run() done, defined at                           \u2502 \u2502\n\u2502 \u2502        /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/pyth\u2026 \u2502 \u2502\n\u2502 \u2502        exception=NoServersError()&amp;gt;                                       \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/app.py:100 in run                                        \u2502\n\u2502                                                                              \u2502\n\u2502    97 \u2502   \u2502   \u2502   \u2502   \u2502   tg.cancel_scope.cancel()                           \u2502\n\u2502    98 \u2502   \u2502   \u2502   except ExceptionGroup as e:                                \u2502\n\u2502    99 \u2502   \u2502   \u2502   \u2502   for ex in e.exceptions:                                \u2502\n\u2502 \u2771 100 \u2502   \u2502   \u2502   \u2502   \u2502   raise ex from None                                 \u2502\n\u2502   101 \u2502                                                                      \u2502\n\u2502   102 \u2502   def exit(self) -&amp;gt; None:                                            \u2502\n\u2502   103 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Stop application manually.&amp;quot;&amp;quot;&amp;quot;                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502                ex = NoServersError()                                     \u2502 \u2502\n\u2502 \u2502         log_level = 20                                                   \u2502 \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7c6755e02120&amp;gt; \u2502 \u2502\n\u2502 \u2502        sleep_time = 0.1                                                  \u2502 \u2502\n\u2502 \u2502                tg = &amp;lt;anyio._backends._asyncio.TaskGroup object at        \u2502 \u2502\n\u2502 \u2502                     0x7c6755e034d0&amp;gt;                                      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:205 in _startup                 \u2502\n\u2502                                                                              \u2502\n\u2502   202 \u2502   ) -&amp;gt; None:                                                         \u2502\n\u2502   203 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Private method calls `start` with logging.&amp;quot;&amp;quot;&amp;quot;               \u2502\n\u2502   204 \u2502   \u2502   async with self._startup_logging(log_level=log_level):         \u2502\n\u2502 \u2771 205 \u2502   \u2502   \u2502   await self.start(**(run_extra_options or {}))              \u2502\n\u2502   206 \u2502   \u2502                                                                  \u2502\n\u2502   207 \u2502   \u2502   self.running = True                                            \u2502\n\u2502   208                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         log_level = 20                                                   \u2502 \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7c6755e02120&amp;gt; \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:215 in start                    \u2502\n\u2502                                                                              \u2502\n\u2502   212 \u2502   ) -&amp;gt; None:                                                         \u2502\n\u2502   213 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Executes startup hooks and start broker.&amp;quot;&amp;quot;&amp;quot;                 \u2502\n\u2502   214 \u2502   \u2502   async with self._start_hooks_context(**run_extra_options):     \u2502\n\u2502 \u2771 215 \u2502   \u2502   \u2502   await self._start_broker()                                 \u2502\n\u2502   216 \u2502                                                                      \u2502\n\u2502   217 \u2502   @asynccontextmanager                                               \u2502\n\u2502   218 \u2502   async def _start_hooks_context(                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 run_extra_options = {&amp;#x27;worker_id&amp;#x27;: None, &amp;#x27;port&amp;#x27;: &amp;#x27;8110&amp;#x27;}                  \u2502 \u2502\n\u2502 \u2502              self = &amp;lt;faststream.app.FastStream object at 0x7c6755e02120&amp;gt; \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/application.py:98 in _start_broker             \u2502\n\u2502                                                                              \u2502\n\u2502    95 \u2502   async def _start_broker(self) -&amp;gt; None:                             \u2502\n\u2502    96 \u2502   \u2502   assert self.brokers, &amp;quot;You should setup a broker&amp;quot;               \u2502\n\u2502    97 \u2502   \u2502   for b in self.brokers:                                         \u2502\n\u2502 \u2771  98 \u2502   \u2502   \u2502   await b.start()                                            \u2502\n\u2502    99 \u2502                                                                      \u2502\n\u2502   100 \u2502   @property                                                          \u2502\n\u2502   101 \u2502   def broker(self) -&amp;gt; Optional[&amp;quot;BrokerUsecase[Any, Any]&amp;quot;]:           \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502    b = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7c6755e01940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2502 self = &amp;lt;faststream.app.FastStream object at 0x7c6755e02120&amp;gt;              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/nats/broker/broker.py:462 in start                       \u2502\n\u2502                                                                              \u2502\n\u2502   459 \u2502                                                                      \u2502\n\u2502   460 \u2502   async def start(self) -&amp;gt; None:                                     \u2502\n\u2502   461 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Connect broker to NATS cluster and startup all subscribers. \u2502\n\u2502 \u2771 462 \u2502   \u2502   await self.connect()                                           \u2502\n\u2502   463 \u2502   \u2502                                                                  \u2502\n\u2502   464 \u2502   \u2502   stream_context = self.config.connection_state.stream           \u2502\n\u2502   465                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7c6755e01940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/_internal/broker/broker.py:111 in connect                \u2502\n\u2502                                                                              \u2502\n\u2502   108 \u2502   async def connect(self) -&amp;gt; ConnectionType:                         \u2502\n\u2502   109 \u2502   \u2502   &amp;quot;&amp;quot;&amp;quot;Connect to a remote server.&amp;quot;&amp;quot;&amp;quot;                              \u2502\n\u2502   110 \u2502   \u2502   if self._connection is None:                                   \u2502\n\u2502 \u2771 111 \u2502   \u2502   \u2502   self._connection = await self._connect()                   \u2502\n\u2502   112 \u2502   \u2502   \u2502   self._setup_logger()                                       \u2502\n\u2502   113 \u2502   \u2502                                                                  \u2502\n\u2502   114 \u2502   \u2502   return self._connection                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7c6755e01940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/faststream/nats/broker/broker.py:427 in _connect                    \u2502\n\u2502                                                                              \u2502\n\u2502   424 \u2502   \u2502   )                                                              \u2502\n\u2502   425 \u2502                                                                      \u2502\n\u2502   426 \u2502   async def _connect(self) -&amp;gt; &amp;quot;Client&amp;quot;:                              \u2502\n\u2502 \u2771 427 \u2502   \u2502   connection = await nats.connect(**self._connection_kwargs)     \u2502\n\u2502   428 \u2502   \u2502   self.config.connect(connection)                                \u2502\n\u2502   429 \u2502   \u2502   return connection                                              \u2502\n\u2502   430                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = &amp;lt;faststream.nats.broker.broker.NatsBroker object at               \u2502 \u2502\n\u2502 \u2502        0x7c6755e01940&amp;gt;                                                   \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/__init__.py:46 in connect                                      \u2502\n\u2502                                                                              \u2502\n\u2502   43 \u2502                                                                       \u2502\n\u2502   44 \u2502   &amp;quot;&amp;quot;&amp;quot;                                                                 \u2502\n\u2502   45 \u2502   nc = NATS()                                                         \u2502\n\u2502 \u2771 46 \u2502   await nc.connect(servers, **options)                                \u2502\n\u2502   47 \u2502   return nc                                                           \u2502\n\u2502   48                                                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                              \u2502\n\u2502 \u2502      nc = &amp;lt;nats client v2.12.0&amp;gt;             \u2502                              \u2502\n\u2502 \u2502 options = {                                 \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;name&amp;#x27;: &amp;#x27;faststream-0.6.4&amp;#x27;,   \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;verbose&amp;#x27;: False,             \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;allow_reconnect&amp;#x27;: True,      \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;reconnect_time_wait&amp;#x27;: 2,     \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;max_reconnect_attempts&amp;#x27;: 60, \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;no_echo&amp;#x27;: False,             \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;pedantic&amp;#x27;: False,            \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;inbox_prefix&amp;#x27;: b&amp;#x27;_INBOX&amp;#x27;,    \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;pending_size&amp;#x27;: 2097152,      \u2502                              \u2502\n\u2502 \u2502           \u2502   &amp;#x27;connect_timeout&amp;#x27;: 2,         \u2502                              \u2502\n\u2502 \u2502           \u2502   ... +18                       \u2502                              \u2502\n\u2502 \u2502           }                                 \u2502                              \u2502\n\u2502 \u2502 servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502                              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                              \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:547 in connect                                   \u2502\n\u2502                                                                              \u2502\n\u2502    544 \u2502   \u2502   \u2502   \u2502   \u2502   # Never stop reconnecting                         \u2502\n\u2502    545 \u2502   \u2502   \u2502   \u2502   \u2502   continue                                          \u2502\n\u2502    546 \u2502   \u2502   \u2502   \u2502   self._err = e                                         \u2502\n\u2502 \u2771  547 \u2502   \u2502   \u2502   \u2502   raise e                                               \u2502\n\u2502    548 \u2502   \u2502   \u2502   except (OSError, errors.Error, asyncio.TimeoutError) as e \u2502\n\u2502    549 \u2502   \u2502   \u2502   \u2502   self._err = e                                         \u2502\n\u2502    550 \u2502   \u2502   \u2502   \u2502   await self._error_cb(e)                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502        allow_reconnect = True                              \u2502               \u2502\n\u2502 \u2502                     cb = None                              \u2502               \u2502\n\u2502 \u2502              closed_cb = None                              \u2502               \u2502\n\u2502 \u2502        connect_timeout = 2                                 \u2502               \u2502\n\u2502 \u2502        disconnected_cb = None                              \u2502               \u2502\n\u2502 \u2502   discovered_server_cb = None                              \u2502               \u2502\n\u2502 \u2502         dont_randomize = False                             \u2502               \u2502\n\u2502 \u2502          drain_timeout = 30                                \u2502               \u2502\n\u2502 \u2502          flush_timeout = None                              \u2502               \u2502\n\u2502 \u2502     flusher_queue_size = 1024                              \u2502               \u2502\n\u2502 \u2502           inbox_prefix = b&amp;#x27;_INBOX&amp;#x27;                         \u2502               \u2502\n\u2502 \u2502  max_outstanding_pings = 2                                 \u2502               \u2502\n\u2502 \u2502 max_reconnect_attempts = 60                                \u2502               \u2502\n\u2502 \u2502                   name = &amp;#x27;faststream-0.6.4&amp;#x27;                \u2502               \u2502\n\u2502 \u2502             nkeys_seed = None                              \u2502               \u2502\n\u2502 \u2502         nkeys_seed_str = None                              \u2502               \u2502\n\u2502 \u2502                no_echo = False                             \u2502               \u2502\n\u2502 \u2502               password = None                              \u2502               \u2502\n\u2502 \u2502               pedantic = False                             \u2502               \u2502\n\u2502 \u2502           pending_size = 2097152                           \u2502               \u2502\n\u2502 \u2502          ping_interval = 120                               \u2502               \u2502\n\u2502 \u2502    reconnect_time_wait = 2                                 \u2502               \u2502\n\u2502 \u2502                   self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502               \u2502\n\u2502 \u2502                 server = Srv(                              \u2502               \u2502\n\u2502 \u2502                          \u2502   uri=ParseResult(              \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502               \u2502\n\u2502 \u2502                          \u2502   ),                            \u2502               \u2502\n\u2502 \u2502                          \u2502   reconnects=61,                \u2502               \u2502\n\u2502 \u2502                          \u2502   last_attempt=32588.334817356, \u2502               \u2502\n\u2502 \u2502                          \u2502   did_connect=False,            \u2502               \u2502\n\u2502 \u2502                          \u2502   discovered=False,             \u2502               \u2502\n\u2502 \u2502                          \u2502   tls_name=None,                \u2502               \u2502\n\u2502 \u2502                          \u2502   server_version=None           \u2502               \u2502\n\u2502 \u2502                          )                                 \u2502               \u2502\n\u2502 \u2502 server_auth_configured = False                             \u2502               \u2502\n\u2502 \u2502                servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502               \u2502\n\u2502 \u2502           signature_cb = None                              \u2502               \u2502\n\u2502 \u2502                    tls = None                              \u2502               \u2502\n\u2502 \u2502    tls_handshake_first = False                             \u2502               \u2502\n\u2502 \u2502           tls_hostname = None                              \u2502               \u2502\n\u2502 \u2502                  token = None                              \u2502               \u2502\n\u2502 \u2502                   user = None                              \u2502               \u2502\n\u2502 \u2502       user_credentials = None                              \u2502               \u2502\n\u2502 \u2502            user_jwt_cb = None                              \u2502               \u2502\n\u2502 \u2502                verbose = False                             \u2502               \u2502\n\u2502 \u2502  ws_connection_headers = None                              \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:535 in connect                                   \u2502\n\u2502                                                                              \u2502\n\u2502    532 \u2502   \u2502                                                                 \u2502\n\u2502    533 \u2502   \u2502   while True:                                                   \u2502\n\u2502    534 \u2502   \u2502   \u2502   try:                                                      \u2502\n\u2502 \u2771  535 \u2502   \u2502   \u2502   \u2502   await self._select_next_server()                      \u2502\n\u2502    536 \u2502   \u2502   \u2502   \u2502   await self._process_connect_init()                    \u2502\n\u2502    537 \u2502   \u2502   \u2502   \u2502   assert (                                              \u2502\n\u2502    538 \u2502   \u2502   \u2502   \u2502   \u2502   self._current_server                              \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502        allow_reconnect = True                              \u2502               \u2502\n\u2502 \u2502                     cb = None                              \u2502               \u2502\n\u2502 \u2502              closed_cb = None                              \u2502               \u2502\n\u2502 \u2502        connect_timeout = 2                                 \u2502               \u2502\n\u2502 \u2502        disconnected_cb = None                              \u2502               \u2502\n\u2502 \u2502   discovered_server_cb = None                              \u2502               \u2502\n\u2502 \u2502         dont_randomize = False                             \u2502               \u2502\n\u2502 \u2502          drain_timeout = 30                                \u2502               \u2502\n\u2502 \u2502          flush_timeout = None                              \u2502               \u2502\n\u2502 \u2502     flusher_queue_size = 1024                              \u2502               \u2502\n\u2502 \u2502           inbox_prefix = b&amp;#x27;_INBOX&amp;#x27;                         \u2502               \u2502\n\u2502 \u2502  max_outstanding_pings = 2                                 \u2502               \u2502\n\u2502 \u2502 max_reconnect_attempts = 60                                \u2502               \u2502\n\u2502 \u2502                   name = &amp;#x27;faststream-0.6.4&amp;#x27;                \u2502               \u2502\n\u2502 \u2502             nkeys_seed = None                              \u2502               \u2502\n\u2502 \u2502         nkeys_seed_str = None                              \u2502               \u2502\n\u2502 \u2502                no_echo = False                             \u2502               \u2502\n\u2502 \u2502               password = None                              \u2502               \u2502\n\u2502 \u2502               pedantic = False                             \u2502               \u2502\n\u2502 \u2502           pending_size = 2097152                           \u2502               \u2502\n\u2502 \u2502          ping_interval = 120                               \u2502               \u2502\n\u2502 \u2502    reconnect_time_wait = 2                                 \u2502               \u2502\n\u2502 \u2502                   self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502               \u2502\n\u2502 \u2502                 server = Srv(                              \u2502               \u2502\n\u2502 \u2502                          \u2502   uri=ParseResult(              \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502               \u2502\n\u2502 \u2502                          \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502               \u2502\n\u2502 \u2502                          \u2502   ),                            \u2502               \u2502\n\u2502 \u2502                          \u2502   reconnects=61,                \u2502               \u2502\n\u2502 \u2502                          \u2502   last_attempt=32588.334817356, \u2502               \u2502\n\u2502 \u2502                          \u2502   did_connect=False,            \u2502               \u2502\n\u2502 \u2502                          \u2502   discovered=False,             \u2502               \u2502\n\u2502 \u2502                          \u2502   tls_name=None,                \u2502               \u2502\n\u2502 \u2502                          \u2502   server_version=None           \u2502               \u2502\n\u2502 \u2502                          )                                 \u2502               \u2502\n\u2502 \u2502 server_auth_configured = False                             \u2502               \u2502\n\u2502 \u2502                servers = [&amp;#x27;nats://localhost:4222&amp;#x27;]         \u2502               \u2502\n\u2502 \u2502           signature_cb = None                              \u2502               \u2502\n\u2502 \u2502                    tls = None                              \u2502               \u2502\n\u2502 \u2502    tls_handshake_first = False                             \u2502               \u2502\n\u2502 \u2502           tls_hostname = None                              \u2502               \u2502\n\u2502 \u2502                  token = None                              \u2502               \u2502\n\u2502 \u2502                   user = None                              \u2502               \u2502\n\u2502 \u2502       user_credentials = None                              \u2502               \u2502\n\u2502 \u2502            user_jwt_cb = None                              \u2502               \u2502\n\u2502 \u2502                verbose = False                             \u2502               \u2502\n\u2502 \u2502  ws_connection_headers = None                              \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /home/philippe/src/PA_Communautaire/packages/pac0/.venv/lib/python3.13/site- \u2502\n\u2502 packages/nats/aio/client.py:1365 in _select_next_server                      \u2502\n\u2502                                                                              \u2502\n\u2502   1362 \u2502   \u2502   while True:                                                   \u2502\n\u2502   1363 \u2502   \u2502   \u2502   if len(self._server_pool) == 0:                           \u2502\n\u2502   1364 \u2502   \u2502   \u2502   \u2502   self._current_server = None                           \u2502\n\u2502 \u2771 1365 \u2502   \u2502   \u2502   \u2502   raise errors.NoServersError                           \u2502\n\u2502   1366 \u2502   \u2502   \u2502                                                             \u2502\n\u2502   1367 \u2502   \u2502   \u2502   now = time.monotonic()                                    \u2502\n\u2502   1368 \u2502   \u2502   \u2502   s = self._server_pool.pop(0)                              \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                                 \u2502\n\u2502 \u2502  now = 32588.334835659                   \u2502                                 \u2502\n\u2502 \u2502    s = Srv(                              \u2502                                 \u2502\n\u2502 \u2502        \u2502   uri=ParseResult(              \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   scheme=&amp;#x27;nats&amp;#x27;,            \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   netloc=&amp;#x27;localhost:4222&amp;#x27;,  \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   path=&amp;#x27;&amp;#x27;,                  \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   params=&amp;#x27;&amp;#x27;,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   query=&amp;#x27;&amp;#x27;,                 \u2502                                 \u2502\n\u2502 \u2502        \u2502   \u2502   fragment=&amp;#x27;&amp;#x27;               \u2502                                 \u2502\n\u2502 \u2502        \u2502   ),                            \u2502                                 \u2502\n\u2502 \u2502        \u2502   reconnects=61,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   last_attempt=32588.334817356, \u2502                                 \u2502\n\u2502 \u2502        \u2502   did_connect=False,            \u2502                                 \u2502\n\u2502 \u2502        \u2502   discovered=False,             \u2502                                 \u2502\n\u2502 \u2502        \u2502   tls_name=None,                \u2502                                 \u2502\n\u2502 \u2502        \u2502   server_version=None           \u2502                                 \u2502\n\u2502 \u2502        )                                 \u2502                                 \u2502\n\u2502 \u2502 self = &amp;lt;nats client v2.12.0&amp;gt;             \u2502                                 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                                 \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nNoServersError: nats: no servers available for connection\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_canal_pingpong&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_canal_pingpong&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_canal_pingpong&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function esb_sub at 0x7d037ae70b80&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_canal_pingpong&amp;gt;&amp;gt;\nkwargs = {&amp;#x27;canal&amp;#x27;: &amp;#x27;pong&amp;#x27;, &amp;#x27;world&amp;#x27;: WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceContext object at 0x7d037ab745a0&amp;gt;, pas=[])}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nsrc/pac_bdd/esb.py:18: in wrapper\n    return asyncio.run(fn(*args, **kwargs))\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:195: in run\n    return runner.run(main)\n           ^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/runners.py:118: in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../../.local/share/uv/python/cpython-3.13.2-linux-x86_64-gnu/lib/python3.13/asyncio/base_events.py:725: in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nworld = WorldContext(peppol=&amp;lt;pac0.shared.test.service.dns.DNSServiceContext object at 0x7d037ab745a0&amp;gt;, pas=[]), canal = &amp;#x27;pong&amp;#x27;\n\n    @when(\n        parsers.parse(&amp;quot;j&amp;#x27;\u00e9coute le canal &amp;#x27;{canal}&amp;#x27;&amp;quot;),\n    )\n    @async_to_sync\n    async def esb_sub(\n        world: WorldContextOld,\n        canal: str,\n    ):\n        global handle_GLOBAL\n    \n        print(f&amp;quot;esb_sub {canal=}...&amp;quot;)\n        #raise NotImplementedError()\n&amp;gt;       broker = world.pac.broker\n                 ^^^^^^^^^\nE       AttributeError: &amp;#x27;WorldContext&amp;#x27; object has no attribute &amp;#x27;pac&amp;#x27;. Did you mean: &amp;#x27;pa&amp;#x27;?\n\nsrc/pac_bdd/esb.py:38: AttributeError\n\n----------------------------- Captured stdout call -----------------------------\nesb_sub canal=&amp;#x27;pong&amp;#x27;...\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;quot;pytestbdd_stepimpl_when_j&amp;#x27;\u00e9coute le canal &amp;#x27;pong&amp;#x27;&amp;quot;: [&amp;lt;FixtureDef argname=&amp;quot;pytestbdd_stepdef_when_j&amp;#x27;\u00e9coute le canal &amp;#x27;{canal}&amp;#x27;&amp;quot; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8063 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8063\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\n\n--------------------------- Captured stderr teardown ---------------------------\nwarning: `VIRTUAL_ENV=/home/philippe/src/PA_Communautaire/packages/pac-bdd/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_pa&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function pa_defined at 0x7d037ad120c0&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_pa&amp;gt;&amp;gt;\nkwargs = {&amp;#x27;pa_id&amp;#x27;: &amp;#x27;pa1&amp;#x27;, &amp;#x27;peppol_context&amp;#x27;: PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None), pa_id = &amp;#x27;pa1&amp;#x27;\n\n    @given(parsers.parse(&amp;quot;la PA #{pa_id}&amp;quot;))\n    def pa_defined(peppol_context, pa_id: str):\n        &amp;quot;&amp;quot;&amp;quot;D\u00e9finit une PA.&amp;quot;&amp;quot;&amp;quot;\n&amp;gt;       peppol_context[&amp;quot;pas&amp;quot;][pa_id] = {\n        ^^^^^^^^^^^^^^^^^^^^^\n            &amp;quot;id&amp;quot;: pa_id,\n            &amp;quot;enterprises&amp;quot;: [],\n            &amp;quot;endpoint&amp;quot;: f&amp;quot;https://ap.{pa_id}.fr/as4&amp;quot;,\n        }\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:307: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_la PA #pa1&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_la PA #{pa_id}&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_r\u00e9solution_sml_r\u00e9ussie_pour_un_participant_enregistr\u00e9&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_r\u00e9solution_sml_r\u00e9ussie_pour_un_participant_enregistr\u00e9&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_r\u00e9solution_sml_r\u00e9ussie_pour_un_participant_enregistr\u00e9&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_r\u00e9solution_sml_r\u00e9ussie_pour_un_participant_enregistr\u00e9&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_r\u00e9solution_sml_\u00e9chou\u00e9e__participant_non_enregistr\u00e9&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_r\u00e9solution_sml_\u00e9chou\u00e9e__participant_non_enregistr\u00e9&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_r\u00e9solution_sml_\u00e9chou\u00e9e__participant_non_enregistr\u00e9&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_r\u00e9solution_sml_\u00e9chou\u00e9e__participant_non_enregistr\u00e9&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_r\u00e9cup\u00e9ration_m\u00e9tadonn\u00e9es_smp_r\u00e9ussie&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_r\u00e9cup\u00e9ration_m\u00e9tadonn\u00e9es_smp_r\u00e9ussie&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_r\u00e9cup\u00e9ration_m\u00e9tadonn\u00e9es_smp_r\u00e9ussie&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_r\u00e9cup\u00e9ration_m\u00e9tadonn\u00e9es_smp_r\u00e9ussie&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_smp_ne_supporte_pas_le_document_type_demand\u00e9&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_smp_ne_supporte_pas_le_document_type_demand\u00e9&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_smp_ne_supporte_pas_le_document_type_demand\u00e9&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_smp_ne_supporte_pas_le_document_type_demand\u00e9&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_lookup_peppol_complet_r\u00e9ussi_par_siren&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_lookup_peppol_complet_r\u00e9ussi_par_siren&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_lookup_peppol_complet_r\u00e9ussi_par_siren&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_lookup_peppol_complet_r\u00e9ussi_par_siren&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_lookup_peppol_complet_r\u00e9ussi_par_siret&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_lookup_peppol_complet_r\u00e9ussi_par_siret&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_lookup_peppol_complet_r\u00e9ussi_par_siret&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_lookup_peppol_complet_r\u00e9ussi_par_siret&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_lookup_peppol_\u00e9chou\u00e9__participant_introuvable&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_lookup_peppol_\u00e9chou\u00e9__participant_introuvable&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_lookup_peppol_\u00e9chou\u00e9__participant_introuvable&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_lookup_peppol_\u00e9chou\u00e9__participant_introuvable&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_routage_facture_vers_pa_distante_via_peppol&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_routage_facture_vers_pa_distante_via_peppol&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_routage_facture_vers_pa_distante_via_peppol&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_routage_facture_vers_pa_distante_via_peppol&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_routage_facture__destinataire_local_pas_de_lookup_peppol&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_routage_facture__destinataire_local_pas_de_lookup_peppol&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_routage_facture__destinataire_local_pas_de_lookup_peppol&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_routage_facture__destinataire_local_pas_de_lookup_peppol&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_routage_facture__fallback_vers_ppf&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_routage_facture__fallback_vers_ppf&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_routage_facture__fallback_vers_ppf&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_routage_facture__fallback_vers_ppf&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_validation_du_certificat_peppol&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_validation_du_certificat_peppol&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_validation_du_certificat_peppol&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_validation_du_certificat_peppol&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_v\u00e9rification_de_la_signature_smp&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_v\u00e9rification_de_la_signature_smp&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_v\u00e9rification_de_la_signature_smp&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_v\u00e9rification_de_la_signature_smp&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_v\u00e9rification_des_document_types_support\u00e9s&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_v\u00e9rification_des_document_types_support\u00e9s&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_v\u00e9rification_des_document_types_support\u00e9s&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_v\u00e9rification_des_document_types_support\u00e9s&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_timeout_lors_du_lookup_sml&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_timeout_lors_du_lookup_sml&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_timeout_lors_du_lookup_sml&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_timeout_lors_du_lookup_sml&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_smp_temporairement_indisponible&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_smp_temporairement_indisponible&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_smp_temporairement_indisponible&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_smp_temporairement_indisponible&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_retry_automatique_apr\u00e8s_\u00e9chec_temporaire&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_retry_automatique_apr\u00e8s_\u00e9chec_temporaire&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_retry_automatique_apr\u00e8s_\u00e9chec_temporaire&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_retry_automatique_apr\u00e8s_\u00e9chec_temporaire&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_\u00e9chec_d\u00e9finitif_apr\u00e8s_plusieurs_retries&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_\u00e9chec_d\u00e9finitif_apr\u00e8s_plusieurs_retries&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_\u00e9chec_d\u00e9finitif_apr\u00e8s_plusieurs_retries&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_\u00e9chec_d\u00e9finitif_apr\u00e8s_plusieurs_retries&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_communication_bidirectionnelle_entre_2_pa&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_communication_bidirectionnelle_entre_2_pa&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_communication_bidirectionnelle_entre_2_pa&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_communication_bidirectionnelle_entre_2_pa&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_r\u00e9ception_dune_facture_via_as4_depuis_une_pa_distante&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_r\u00e9ception_dune_facture_via_as4_depuis_une_pa_distante&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_r\u00e9ception_dune_facture_via_as4_depuis_une_pa_distante&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_r\u00e9ception_dune_facture_via_as4_depuis_une_pa_distante&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_facture_b2g_via_chorus_pro_peppol&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_facture_b2g_via_chorus_pro_peppol&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_facture_b2g_via_chorus_pro_peppol&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;FixtureRequest for &amp;lt;Function test_facture_b2g_via_chorus_pro_peppol&amp;gt;&amp;gt;, argname = &amp;#x27;peppol_service&amp;#x27;\n\n    def getfixturevalue(self, argname: str) -&amp;gt; Any:\n        &amp;quot;&amp;quot;&amp;quot;Dynamically run a named fixture function.\n    \n        Declaring fixtures via function argument is recommended where possible.\n        But if you can only decide whether to use another fixture at test\n        setup time, you may use this function to retrieve it inside a fixture\n        or test function body.\n    \n        This method can be used during the test setup phase or the test run\n        phase, but during the test teardown phase a fixture&amp;#x27;s value may not\n        be available.\n    \n        :param argname:\n            The fixture name.\n        :raises pytest.FixtureLookupError:\n            If the given fixture could not be found.\n        &amp;quot;&amp;quot;&amp;quot;\n        # Note that in addition to the use case described in the docstring,\n        # getfixturevalue() is also called by pytest itself during item and fixture\n        # setup to evaluate the fixtures that are requested statically\n        # (using function parameters, autouse, etc).\n    \n&amp;gt;       fixturedef = self._get_active_fixturedef(argname)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:549: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:640: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1128: in execute\n    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_hooks.py:512: in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:53: in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/pluggy/_callers.py:38: in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:1196: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=None)\n\n    @pytest.fixture\n    def peppol_service(peppol_context) -&amp;gt; PeppolLookupService:\n        &amp;quot;&amp;quot;&amp;quot;Service PEPPOL configur\u00e9 pour les tests.&amp;quot;&amp;quot;&amp;quot;\n    \n        def mock_dns_resolver(hostname: str) -&amp;gt; Optional[str]:\n            &amp;quot;&amp;quot;&amp;quot;R\u00e9solveur DNS mock pour les tests.&amp;quot;&amp;quot;&amp;quot;\n            return peppol_context[&amp;quot;dns_responses&amp;quot;].get(hostname)\n    \n        service = PeppolLookupService(\n&amp;gt;           environment=peppol_context[&amp;quot;environment&amp;quot;],\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n            dns_resolver=mock_dns_resolver,\n        )\nE       TypeError: &amp;#x27;PeppolContext&amp;#x27; object is not subscriptable\n\nsrc/pac_bdd/peppol.py:103: TypeError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL configur\u00e9 en mode &amp;quot;test&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL configur\u00e9 en mode &amp;quot;{mode}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_peppol_req&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_peppol_req&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_peppol_req&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_le service PEPPOL simul\u00e9 avec:&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_le service PEPPOL simul\u00e9 avec:&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector\nINFO     pac0.shared.test.service.base:base.py:135 Starting service peppol on port 8091 : uv run src/pac0/service/peppol_dns_fake/main.py\nDEBUG    pac0.shared.test.service.base:base.py:190 wait_for_ready peppol ...\nINFO     pac0.shared.test.service.base:base.py:161 Service  peppol started on localhost:8091\nINFO     pac0.shared.test.world:world.py:84 WorldContext: enter context ...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     pac0.shared.test.service.base:base.py:173 Stopping service...\nINFO     pac0.shared.test.world:world.py:92 WorldContext: exit context ...&#34;}], &#34;test_scenario.py::test_md5&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_md5&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_md5&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function check_result at 0x7d037ad10400&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_md5&amp;gt;&amp;gt;\nkwargs = {&amp;#x27;peppol_context&amp;#x27;: PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=&amp;#x27;b881aaeff8eeaed7190491ccdeaa42fc&amp;#x27;), &amp;#x27;result&amp;#x27;: &amp;#x27;6c2675d749449f2c8af1216fd866bb54&amp;#x27;}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npeppol_context = PeppolContext(sml_zone=&amp;#x27;acc.edelivery.tech.ec.europa.eu&amp;#x27;, enterprise_id=None, siren=None, siret=None, result=&amp;#x27;b881aaeff8eeaed7190491ccdeaa42fc&amp;#x27;), result = &amp;#x27;6c2675d749449f2c8af1216fd866bb54&amp;#x27;\n\n    @then(parsers.parse(&amp;#x27;&amp;#x27;&amp;#x27;j&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27;&amp;#x27;&amp;#x27;))\n    def check_result(\n        peppol_context: PeppolContext,\n        result: str,\n    ):\n        &amp;quot;&amp;quot;&amp;quot;\u00e9tape g\u00e9n\u00e9rique pour tester tout r\u00e9sultat&amp;quot;&amp;quot;&amp;quot;\n        if peppol_context.result != result:\n            print(f&amp;quot;result: {peppol_context.result}&amp;quot;)\n            print(f&amp;quot;expecting: {result}&amp;quot;)\n&amp;gt;       assert peppol_context.result == result\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE       AssertionError\n\nsrc/pac_bdd/peppol.py:128: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nresult: b881aaeff8eeaed7190491ccdeaa42fc\nexpecting: 6c2675d749449f2c8af1216fd866bb54\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;empreinte md5 de &amp;quot;bonjour!&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte md5 de &amp;quot;{msg}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;, &amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;6c2675d749449f2c8af1216fd866bb54&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_identification_france&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_identification_france&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_identification_france&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nxxxx 0002 0002\nxxxx 0009 0009\nxxxx 9957 9957\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_l\\&amp;#x27;identification par SIRET porte le code &amp;quot;0002&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_l\\&amp;#x27;identification par {facon} porte le code &amp;quot;{code}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_l\\&amp;#x27;identification par SIREN porte le code &amp;quot;0009&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_l\\&amp;#x27;identification par {facon} porte le code &amp;quot;{code}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_l\\&amp;#x27;identification par TVA_FR porte le code &amp;quot;9957&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_l\\&amp;#x27;identification par {facon} porte le code &amp;quot;{code}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_empreinte_participant&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_empreinte_participant&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_empreinte_participant&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;empreinte SIREN &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;3ddb2999105b666703fc700e14885016&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;empreinte SIRET &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;6dbdf4f29451b37456ca48b550bdbaee&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;empreinte TVA_FR &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;empreinte {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;d0d6bafc0317e3e8baa9504a9a022f9c&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_h\u00f4te_sml&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_h\u00f4te_sml&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_h\u00f4te_sml&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_la racine SML &amp;quot;ma.racine.local&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_la racine SML &amp;quot;{zone}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour SIREN &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-3ddb2999105b666703fc700e14885016.iso6523-actorid-upis.ma.racine.local&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour SIRET &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-6dbdf4f29451b37456ca48b550bdbaee.iso6523-actorid-upis.ma.racine.local&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour TVA_FR &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-d0d6bafc0317e3e8baa9504a9a022f9c.iso6523-actorid-upis.ma.racine.local&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_given_la racine SML &amp;quot;acc.edelivery.tech.ec.europa.eu&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_given_la racine SML &amp;quot;{zone}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour SIREN &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-3ddb2999105b666703fc700e14885016.iso6523-actorid-upis.acc.edelivery.tech.ec.europa.eu&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour SIRET &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-6dbdf4f29451b37456ca48b550bdbaee.iso6523-actorid-upis.acc.edelivery.tech.ec.europa.eu&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je calcule l\\&amp;#x27;h\u00f4te SML pour TVA_FR &amp;quot;222222222&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je calcule l\\&amp;#x27;h\u00f4te SML pour {facon} &amp;quot;{id}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_then_j\\&amp;#x27;obtiens &amp;quot;B-d0d6bafc0317e3e8baa9504a9a022f9c.iso6523-actorid-upis.acc.edelivery.tech.ec.europa.eu&amp;quot;&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_then_j\\&amp;#x27;obtiens &amp;quot;{result}&amp;quot;&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_rejet_dolibarr&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_rejet_dolibarr&#34;, &#34;duration&#34;: &#34;0 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_rejet_dolibarr&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;0 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function compliance_rule_set at 0x7d037ae71f80&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_rejet_dolibarr&amp;gt;&amp;gt;, kwargs = {}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\n    @when(&amp;quot;je d\u00e9finis un contr\u00f4le de conformit\u00e9 m\u00e9tier fournisseur&amp;quot;)\n    def compliance_rule_set():\n&amp;gt;       raise NotImplementedError()\nE       NotImplementedError\n\nsrc/pac_bdd/tobeimplemented.py:45: NotImplementedError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je d\u00e9finis un contr\u00f4le de conformit\u00e9 m\u00e9tier fournisseur&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je d\u00e9finis un contr\u00f4le de conformit\u00e9 m\u00e9tier fournisseur&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}], &#34;test_scenario.py::test_facture_rejet\u00e9e&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_scenario.py::test_facture_rejet\u00e9e&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_scenario.py::test_facture_rejet\u00e9e&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;fixturefunc = &amp;lt;function submit_invoice_simple at 0x7d037ae71620&amp;gt;, request = &amp;lt;FixtureRequest for &amp;lt;Function test_facture_rejet\u00e9e&amp;gt;&amp;gt;, kwargs = {}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -&amp;gt; FixtureValue:\n        if inspect.isgeneratorfunction(fixturefunc):\n            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f&amp;quot;{request.fixturename} did not yield a value&amp;quot;) from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n&amp;gt;           fixture_result = fixturefunc(**kwargs)\n                             ^^^^^^^^^^^^^^^^^^^^^\n\n.venv/lib/python3.13/site-packages/_pytest/fixtures.py:930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\n    @when(&amp;quot;je d\u00e9pose une facture&amp;quot;)\n    def submit_invoice_simple():\n        # POST /\n&amp;gt;       raise NotImplementedError()\nE       NotImplementedError\n\nsrc/pac_bdd/tobeimplemented.py:17: NotImplementedError\n\n------------------------------ Captured log call -------------------------------\nDEBUG    pytest_bdd.scenario:scenario.py:150 Adding providers for fixture &amp;#x27;pytestbdd_stepimpl_when_je d\u00e9pose une facture&amp;#x27;: [&amp;lt;FixtureDef argname=&amp;#x27;pytestbdd_stepdef_when_je d\u00e9pose une facture&amp;#x27; scope=&amp;#x27;function&amp;#x27; baseid=&amp;#x27;test_scenario.py&amp;#x27;&amp;gt;]\n\n&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;report.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>